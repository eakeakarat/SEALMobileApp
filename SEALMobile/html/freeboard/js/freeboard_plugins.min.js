function DialogBox(e,t,n,r,i){var s=$('<div id="modal_overlay" style="display:none;"></div>'),o=$('<div class="modal"></div>');function a(){s.fadeOut(200,function(){$(this).remove()})}o.append('<header><h2 class="title">'+t+"</h2></header>"),$("<section></section>").appendTo(o).append(e);t=$("<footer></footer>").appendTo(o);n&&$('<span id="dialog-ok" class="text-button">'+n+"</span>").appendTo(t).click(function(){var e=!1;(e=_.isFunction(i)?i():e)||a()}),r&&$('<span id="dialog-cancel" class="text-button">'+r+"</span>").appendTo(t).click(function(){a()}),s.append(o),$("body").append(s),s.fadeIn(200)}function FreeboardModel(i,s,o){var a=this;this.version=0,this.isEditing=ko.observable(!1),this.allow_edit=ko.observable(!1),this.allow_edit.subscribe(function(e){e?$("#main-header").show():$("#main-header").hide()}),this.header_image=ko.observable(),this.plugins=ko.observableArray(),this.datasources=ko.observableArray(),this.panes=ko.observableArray(),this.datasourceData={},this.processDatasourceUpdate=function(e,t){var n=e.name();a.datasourceData[n]=t,_.each(a.panes(),function(e){_.each(e.widgets(),function(e){e.processDatasourceUpdate(n)})})},this._datasourceTypes=ko.observable(),this.datasourceTypes=ko.computed({read:function(){a._datasourceTypes();var r=[];return _.each(i,function(e){var t=e.type_name,n=t;_.isUndefined(e.display_name)||(n=e.display_name),r.push({name:t,display_name:n})}),r}}),this._widgetTypes=ko.observable(),this.widgetTypes=ko.computed({read:function(){a._widgetTypes();var r=[];return _.each(s,function(e){var t=e.type_name,n=t;_.isUndefined(e.display_name)||(n=e.display_name),r.push({name:t,display_name:n})}),r}}),this.addPluginSource=function(e){e&&-1==a.plugins.indexOf(e)&&a.plugins.push(e)},this.serialize=function(){var t=[],n=(_.each(a.panes(),function(e){t.push(e.serialize())}),[]);return _.each(a.datasources(),function(e){n.push(e.serialize())}),{version:1,header_image:a.header_image(),allow_edit:a.allow_edit(),plugins:a.plugins(),panes:t,datasources:n,columns:o.getUserColumns()}},this.deserialize=function(t,n){function e(){o.setUserColumns(t.columns),_.isUndefined(t.allow_edit)?a.allow_edit(!0):a.allow_edit(t.allow_edit),a.version=t.version||0,a.header_image(t.header_image),_.each(t.datasources,function(e){var t=new DatasourceModel(a,i);t.deserialize(e),a.addDatasource(t)});var e=_.sortBy(t.panes,function(e){return o.getPositionForScreenSize(e).row});_.each(e,function(e){var t=new PaneModel(a,s);t.deserialize(e),a.panes.push(t)}),a.allow_edit()&&0==a.panes().length&&a.setEditing(!0),_.isFunction(n)&&n(),o.processResize(!0)}a.clearDashboard(),_.each(t.plugins,function(e){a.addPluginSource(e)}),_.isArray(t.plugins)&&0<t.plugins.length?head.js(t.plugins,function(){e()}):e()},this.clearDashboard=function(){o.removeAllPanes(),_.each(a.datasources(),function(e){e.dispose()}),_.each(a.panes(),function(e){e.dispose()}),a.plugins.removeAll(),a.datasources.removeAll(),a.panes.removeAll()},this.loadDashboard=function(e,t){o.showLoadingIndicator(!0),a.deserialize(e,function(){o.showLoadingIndicator(!1),_.isFunction(t)&&t(),freeboard.emit("dashboard_loaded")})},this.loadDashboardFromLocalFile=function(i){var e;window.File&&window.FileReader&&window.FileList&&window.Blob?((e=document.createElement("input")).type="file",$(e).on("change",function(e){var t,e=e.target.files;e&&0<e.length&&(e=e[0],(t=new FileReader).addEventListener("load",function(e){var e=e.target,t=JSON.parse(e.result),n=[];if(i&&i.deviceid&&i.devicetoken&&t){for(var r in t.datasources){r=t.datasources[r];"dashboard"!=r.name&&n.push(r)}n.push({name:"dashboard",settings:{name:"dashboard",deviceid:i.deviceid,devicetoken:i.devicetoken},type:"cyblion_datasource"}),t.datasources=n}a.loadDashboard(t),a.setEditing(!1)}),t.readAsText(e))}),$(e).trigger("click")):alert("Unable to load a file in this browser.")},this.saveDashboardClicked=function(){var e=$(event.currentTarget),t=e.data("siblings-shown")||!1;t?$(event.currentTarget).siblings("label").fadeOut("slow"):$(event.currentTarget).siblings("label").fadeIn("slow"),e.data("siblings-shown",!t)},this.saveDashboard=function(e,t){var t=$(t.currentTarget).data("pretty"),n="application/octet-stream",r=document.createElement("a");t=t?new Blob([JSON.stringify(a.serialize(),null,"\t")],{type:n}):new Blob([JSON.stringify(a.serialize())],{type:n}),document.body.appendChild(r),r.href=window.URL.createObjectURL(t),r.download="dashboard.json",r.target="_self",r.click()},this.addDatasource=function(e){a.datasources.push(e)},this.deleteDatasource=function(e){delete a.datasourceData[e.name()],e.dispose(),a.datasources.remove(e)},this.createPane=function(){var e=new PaneModel(a,s);a.addPane(e)},this.addGridColumnLeft=function(){o.addGridColumnLeft()},this.addGridColumnRight=function(){o.addGridColumnRight()},this.subGridColumnLeft=function(){o.subGridColumnLeft()},this.subGridColumnRight=function(){o.subGridColumnRight()},this.addPane=function(e){a.panes.push(e)},this.deletePane=function(e){e.dispose(),a.panes.remove(e)},this.deleteWidget=function(t){ko.utils.arrayForEach(a.panes(),function(e){e.widgets.remove(t)}),t.dispose()},this.setEditing=function(e,t){var n,r;!a.allow_edit()&&e||(a.isEditing(e),n=(t=_.isUndefined(t)?!0:t)?250:0,r=$("#admin-bar").outerHeight(),e?($("#toggle-header-icon").addClass("icon-chevron-up").removeClass("icon-wrench"),$(".gridster .gs_w").css({cursor:"pointer"}),$("#main-header").animate({top:"0px"},n),$("#board-content").animate({top:r+20+"px"},n),$("#main-header").data().shown=!0,o.attachWidgetEditIcons($(".sub-section")),o.enableGrid()):($("#toggle-header-icon").addClass("icon-wrench").removeClass("icon-chevron-up"),$(".gridster .gs_w").css({cursor:"default"}),$("#main-header").animate({top:"-"+r+"px"},n),$("#board-content").animate({top:"20"},n),$("#main-header").data().shown=!1,$(".sub-section").unbind(),o.disableGrid()),o.showPaneEditIcons(e,t))},this.toggleEditing=function(){var e=!a.isEditing();a.setEditing(e)}}function FreeboardUI(){var a,s=10,o=300,n=3,r=s+o+s,t=n,i=$('<div class="wrapperloading"><div class="loading up" ></div><div class="loading down"></div></div>');function l(e){var r=h(),e=e?function(e){var t=ko.dataFor(this),n=y(t);$(this).attr("data-sizex",Math.min(t.col_width(),r,a.cols)).attr("data-row",n.row).attr("data-col",n.col),t.processSizeChange()}:function(){};d(Math.min(r,t)),f(e),c()}function e(r){d(a.cols+1)&&f(function(){var e=ko.dataFor(this),t=1<a.cols?a.cols-1:1,n=e.col[t],t=e.row[t];t=r?(leftPreviewCol=!0,{row:t,col:n<a.cols?n+1:a.cols}):(rightPreviewCol=!0,{row:t,col:n}),$(this).attr("data-sizex",Math.min(e.col_width(),a.cols)).attr("data-row",t.row).attr("data-col",t.col)}),c(),t=a.cols}function u(r){d(a.cols-1)&&f(function(){var e=ko.dataFor(this),t=a.cols+1,n=e.col[t],t=e.row[t];t=r?{row:t,col:1<n?n-1:1}:{row:t,col:n<=a.cols?n:a.cols},$(this).attr("data-sizex",Math.min(e.col_width(),a.cols)).attr("data-row",t.row).attr("data-col",t.col)}),c(),t=a.cols}function c(){var e=$(".column-tool"),t=$("#board-content").width(),t=Math.floor(t/r);a.cols<=n?e.addClass("min"):e.removeClass("min"),a.cols>=t?e.addClass("max"):e.removeClass("max")}function h(){var e=$("#board-content").width();return Math.floor(e/r)}function d(e){(void 0===e||e<n)&&(e=n);var t=h(),t=r*(e=t<e?t:e)+e;return $(".responsive-column-width").css("max-width",t),e!==a.cols}function f(e){var t=a.$el;t.find("> li").unbind().removeData(),$(".responsive-column-width").css("width",""),a.generate_grid_and_stylesheet(),t.find("> li").each(e),a.init(),$(".responsive-column-width").css("width",a.cols*o+a.cols*s*2)}function p(e,t,n){var r=a.cols;_.isUndefined(t)||(e.row[r]=t),_.isUndefined(n)||(e.col[r]=n)}function g(e,t){t=(t=_.isUndefined(t)?!0:t)?250:0;e?($(".pane-tools").fadeIn(t),$("#column-tools").fadeIn(t)):($(".pane-tools").fadeOut(t),$("#column-tools").fadeOut(t))}function m(e,t){t?$(e).find(".sub-section-tools").fadeIn(250):$(e).find(".sub-section-tools").fadeOut(250)}function y(e){var t,n,r,i=a.cols,s=(_.isNumber(e.row)&&_.isNumber(e.col)&&((t={})[i]=e.row,e.row=t,(t={})[i]=e.col,e.col=t),1),o=1e3;for(n in e.col){if(n==i)return{row:e.row[n],col:e.col[n]};e.col[n]>i?s=i:(r=i-n)<o&&(s=n,o=r)}return s in e.col&&s in e.row?{row:e.row[s],col:e.col[s]}:{row:1,col:s}}return ko.bindingHandlers.grid={init:function(e,t,n,r,i){a=$(e).gridster({widget_margins:[s,s],widget_base_dimensions:[o,10],resize:{enabled:!1,axes:"x"}}).data("gridster"),l(!1),a.disable()}},{showLoadingIndicator:function(e){e?i.fadeOut(0).appendTo("body").fadeIn(500):i.fadeOut(500).remove()},showPaneEditIcons:function(e,t){g(e,t)},attachWidgetEditIcons:function(e){$(e).hover(function(){m(this,!0)},function(){m(this,!1)})},getPositionForScreenSize:y,processResize:function(e){l(e)},disableGrid:function(){a.disable()},enableGrid:function(){a.enable()},addPane:function(e,t,n){var r,i,s,o;e=e,n=n,i=(t=y(r=t)).col,t=t.row,s=Number(r.width()),o=Number(r.getCalculatedHeight()),a.add_widget(e,s,o,i,t),n&&g(!0),p(r,t,i),$(e).attrchange({trackValues:!0,callback:function(e){"data-row"==e.attributeName?p(r,Number(e.newValue),void 0):"data-col"==e.attributeName&&p(r,void 0,Number(e.newValue))}})},updatePane:function(e,t){var n,r,i;e=e,n=(t=t).getCalculatedHeight(),r=Number($(e).attr("data-sizey")),i=Number($(e).attr("data-sizex")),n==r&&t.col_width()==i||a.resize_widget($(e),t.col_width(),n,function(){a.set_dom_grid_height()})},removePane:function(e){a.remove_widget(e)},removeAllPanes:function(){a.remove_all_widgets()},addGridColumnLeft:function(){e(!0)},addGridColumnRight:function(){e(!1)},subGridColumnLeft:function(){u(!0)},subGridColumnRight:function(){u(!1)},getUserColumns:function(){return t},setUserColumns:function(e){t=Math.max(n,e)}}}function PaneModel(n,r){var i=this;this.title=ko.observable(),this.width=ko.observable(1),this.row={},this.col={},this.col_width=ko.observable(1),this.col_width.subscribe(function(e){i.processSizeChange()}),this.widgets=ko.observableArray(),this.addWidget=function(e){this.widgets.push(e)},this.widgetCanMoveUp=function(e){return 1<=i.widgets.indexOf(e)},this.widgetCanMoveDown=function(e){return i.widgets.indexOf(e)<i.widgets().length-1},this.moveWidgetUp=function(e){var t;i.widgetCanMoveUp(e)&&(e=i.widgets.indexOf(e),t=i.widgets(),i.widgets.splice(e-1,2,t[e],t[e-1]))},this.moveWidgetDown=function(e){var t;i.widgetCanMoveDown(e)&&(e=i.widgets.indexOf(e),t=i.widgets(),i.widgets.splice(e,2,t[e+1],t[e]))},this.processSizeChange=function(){setTimeout(function(){_.each(i.widgets(),function(e){e.processSizeChange()})},1e3)},this.getCalculatedHeight=function(){var e=_.reduce(i.widgets(),function(e,t){return e+t.height()},0),e=(e=((e*=6)+3)*10,Math.ceil((20+e)/30));return Math.max(4,e)},this.serialize=function(){var t=[];return _.each(i.widgets(),function(e){t.push(e.serialize())}),{title:i.title(),width:i.width(),row:i.row,col:i.col,col_width:Number(i.col_width()),widgets:t}},this.deserialize=function(e){i.title(e.title),i.width(e.width),i.row=e.row,i.col=e.col,i.col_width(e.col_width||1),_.each(e.widgets,function(e){var t=new WidgetModel(n,r);t.deserialize(e),i.widgets.push(t)})},this.dispose=function(){_.each(i.widgets(),function(e){e.dispose()})}}function WidgetModel(t,r){var l=this;this.datasourceRefreshNotifications={},this.calculatedSettingScripts={},this.title=ko.observable(),this.fillSize=ko.observable(!1),this.type=ko.observable(),this.type.subscribe(function(e){function t(){n.newInstance(l.settings(),function(e){l.fillSize(!0===n.fill_size),l.widgetInstance=e,l.shouldRender(!0),l._heightUpdate.valueHasMutated()})}var n;_.isUndefined(l.widgetInstance)||(_.isFunction(l.widgetInstance.onDispose)&&l.widgetInstance.onDispose(),l.widgetInstance=void 0),e in r&&_.isFunction(r[e].newInstance)&&((n=r[e]).external_scripts?head.js(n.external_scripts.slice(0),t):t())}),this.settings=ko.observable({}),this.settings.subscribe(function(e){!_.isUndefined(l.widgetInstance)&&_.isFunction(l.widgetInstance.onSettingsChanged)&&l.widgetInstance.onSettingsChanged(e),l.updateCalculatedSettings(),l._heightUpdate.valueHasMutated()}),this.processDatasourceUpdate=function(e){e=l.datasourceRefreshNotifications[e];_.isArray(e)&&_.each(e,function(e){l.processCalculatedSetting(e)})},this.callValueFunction=function(e){return e.call(void 0,t.datasourceData)},this.processSizeChange=function(){!_.isUndefined(l.widgetInstance)&&_.isFunction(l.widgetInstance.onSizeChanged)&&l.widgetInstance.onSizeChanged()},this.processCalculatedSetting=function(t){if(_.isFunction(l.calculatedSettingScripts[t])){var n=void 0;try{n=l.callValueFunction(l.calculatedSettingScripts[t])}catch(e){var r=l.settings()[t];e instanceof ReferenceError&&/^\w+$/.test(r)&&(n=r)}if(!_.isUndefined(l.widgetInstance)&&_.isFunction(l.widgetInstance.onCalculatedValueChanged)&&!_.isUndefined(n))try{l.widgetInstance.onCalculatedValueChanged(t,n)}catch(e){console.log(e.toString())}}},this.updateCalculatedSettings=function(){var e,o,a;l.datasourceRefreshNotifications={},l.calculatedSettingScripts={},_.isUndefined(l.type())||(e=r[l.type()].settings,o=new RegExp("datasources.([\\w_-]+)|datasources\\[['\"]([^'\"]+)","g"),a=l.settings(),_.each(e,function(t){if("calculated"==t.type){var e=a[t.name];if(!_.isUndefined(e)){((e=_.isArray(e)?"["+e.join(",")+"]":e).match(/;/g)||[]).length<=1&&-1==e.indexOf("return")&&(e="return "+e);try{r=new Function("datasources",e)}catch(e){var n=a[t.name].replace(/"/g,'\\"').replace(/[\r\n]/g," \\\n"),r=new Function("datasources",'return "'+n+'";')}for(l.calculatedSettingScripts[t.name]=r,l.processCalculatedSetting(t.name);i=o.exec(e);){var i=i[1]||i[2],s=l.datasourceRefreshNotifications[i];_.isUndefined(s)&&(l.datasourceRefreshNotifications[i]=s=[]),-1==_.indexOf(s,t.name)&&s.push(t.name)}}}}))},this._heightUpdate=ko.observable(),this.height=ko.computed({read:function(){return l._heightUpdate(),!_.isUndefined(l.widgetInstance)&&_.isFunction(l.widgetInstance.getHeight)?l.widgetInstance.getHeight():1}}),this.shouldRender=ko.observable(!1),this.render=function(e){l.shouldRender(!1),!_.isUndefined(l.widgetInstance)&&_.isFunction(l.widgetInstance.render)&&(l.widgetInstance.render(e),l.updateCalculatedSettings())},this.dispose=function(){},this.serialize=function(){return{title:l.title(),type:l.type(),settings:l.settings()}},this.deserialize=function(e){l.title(e.title),l.settings(e.settings),l.type(e.type)}}DatasourceModel=function(t,r){var i=this;function s(){_.isUndefined(i.datasourceInstance)||(_.isFunction(i.datasourceInstance.onDispose)&&i.datasourceInstance.onDispose(),i.datasourceInstance=void 0)}this.name=ko.observable(),this.latestData=ko.observable(),this.settings=ko.observable({}),this.settings.subscribe(function(e){!_.isUndefined(i.datasourceInstance)&&_.isFunction(i.datasourceInstance.onSettingsChanged)&&i.datasourceInstance.onSettingsChanged(e)}),this.updateCallback=function(e){t.processDatasourceUpdate(i,e),i.latestData(e);e=new Date;i.last_updated(e.toLocaleTimeString())},this.type=ko.observable(),this.type.subscribe(function(e){function t(){n.newInstance(i.settings(),function(e){(i.datasourceInstance=e).updateNow()},i.updateCallback)}var n;s(),e in r&&_.isFunction(r[e].newInstance)&&((n=r[e]).external_scripts?head.js(n.external_scripts.slice(0),t):t())}),this.last_updated=ko.observable("never"),this.last_error=ko.observable(),this.serialize=function(){return{name:i.name(),type:i.type(),settings:i.settings()}},this.deserialize=function(e){i.settings(e.settings),i.name(e.name),i.type(e.type)},this.getDataRepresentation=function(e){return new Function("data","return "+e+";").call(void 0,i.latestData())},this.updateNow=function(){!_.isUndefined(i.datasourceInstance)&&_.isFunction(i.datasourceInstance.updateNow)&&i.datasourceInstance.updateNow()},this.dispose=function(){s()}},DeveloperConsole=function(i){return{showDeveloperConsole:function(){function t(e){var t=$("<tr></tr>"),n=$('<ul class="board-toolbar"></ul>'),r=$('<input class="table-row-value" style="width:100%;" type="text">'),i=$('<li><i class="icon-trash icon-white"></i></li>').click(function(e){s=_.without(s,r),t.remove()});s.push(r),e&&r.val(e),n.append(i),o.append(t.append($("<td></td>").append(r)).append($('<td class="table-row-operation">').append(n)))}var s,e,n,r,o;s=[],e=$("<div></div>"),n=$('<div class="table-operation text-button">ADD</div>'),(r=$('<table class="table table-condensed sub-table"></table>')).append($('<thead style=""><tr><th>Plugin Script URL</th></tr></thead>')),o=$("<tbody></tbody>"),r.append(o),e.append($("<p>Here you can add references to other scripts to load datasource or widget plugins.</p>")).append(r).append(n).append('<p>To learn how to build plugins for freeboard, please visit <a target="_blank" href="http://freeboard.github.io/freeboard/docs/plugin_example.html">http://freeboard.github.io/freeboard/docs/plugin_example.html</a></p>'),_.each(i.plugins(),function(e){t(e)}),n.click(function(e){t()}),new DialogBox(e,"Developer Console","OK",null,function(){_.each(i.plugins(),function(e){$('script[src^="'+e+'"]').remove()}),i.plugins.removeAll(),_.each(s,function(e){e=e.val();e&&0<e.length&&(i.addPluginSource(e),head.js(e+"?"+Date.now()))})})}}},JSEditor=function(){return{displayJSEditor:function(e,t){var n,r,i,s,o,a;n=t,r='// Example: Convert temp from C to F and truncate to 2 decimal places.\n// return (datasources["MyDatasource"].sensor.tempInF * 1.8 + 32).toFixed(2);',t=(t=e)||r,i=$('<div class="code-window"></div>'),e=$('<div class="code-mirror-wrapper"></div>'),s=$('<div class="code-window-footer"></div>'),o=$('<div class="code-window-header cm-s-ambiance">This javascript will be re-evaluated any time a datasource referenced here is updated, and the value you <code><span class="cm-keyword">return</span></code> will be displayed in the widget. You can assume this javascript is wrapped in a function of the form <code><span class="cm-keyword">function</span>(<span class="cm-def">datasources</span>)</code> where datasources is a collection of javascript objects (keyed by their name) corresponding to the most current data in a datasource.</div>'),i.append([o,e,s]),$("body").append(i),a=CodeMirror(e.get(0),{value:t,mode:"javascript",theme:"ambiance",indentUnit:4,lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0}),o=$('<span id="dialog-cancel" class="text-button">Close</span>').click(function(){var e;n&&(e=a.getValue(),n(e=e===r?"":e),i.remove())}),s.append(o)},setAssetRoot:function(e){0}}},PluginEditor=function(l,u){function c(e,t){t=$('<div class="validation-error"></div>').html(t);$("#setting-value-container-"+e).append(t)}function S(n,e,r,t,i){var s=$("<textarea></textarea>"),t=(r.multi_input?s.change(function(){var t=[];$(n).find("textarea").each(function(){var e=$(this).val();e&&(t=t.concat(e))}),e.settings[r.name]=t}):s.change(function(){e.settings[r.name]=$(this).val()}),t&&s.val(t),u.createValueEditor(s),$('<ul class="board-toolbar datasource-input-suffix"></ul>')),o=$('<div class="calculated-setting-row"></div>'),a=(o.append(s).append(t),$('<li><i class="icon-plus icon-white"></i><label>DATASOURCE</label></li>').mousedown(function(e){e.preventDefault(),$(s).val("").focus().insertAtCaret('datasources["').trigger("freeboard-eval")})),a=(t.append(a),$('<li><i class="icon-fullscreen icon-white"></i><label>.JS EDITOR</label></li>').mousedown(function(e){e.preventDefault(),l.displayJSEditor(s.val(),function(e){s.val(e),s.change()})}));t.append(a),i&&(a=$('<li class="remove-setting-row"><i class="icon-minus icon-white"></i><label></label></li>').mousedown(function(e){e.preventDefault(),o.remove(),$(n).find("textarea:first").change()}),t.prepend(a)),$(n).append(o)}function o(e,t,n,b,r){var i,v={type:n,settings:{}};function w(e,t){var n=$('<div id="setting-row-'+e+'" class="form-row"></div>').appendTo(s);return n.append('<div class="form-label"><label class="control-label">'+t+"</label></div>"),$('<div id="setting-value-container-'+e+'" class="form-value"></div>').appendTo(n)}var s=$("<div></div>"),o=$('<div id="plugin-description"></div>').hide();function a(e,m,y){_.each(e,function(o){!_.isUndefined(o.default_value)&&_.isUndefined(b[o.name])&&(b[o.name]=o.default_value);var e=o.name,t=(_.isUndefined(o.display_name)||(e=o.display_name),w(o.name,e));switch(o.type){case"array":var n=$('<div class="form-table-value-subtable"></div>').appendTo(t),r=$('<table class="table table-condensed sub-table"></table>').appendTo(n),i=$("<thead></thead>").hide().appendTo(r),s=$("<tr></tr>").appendTo(i),a=$("<tbody></tbody>").appendTo(r),r=[];function l(){0<v.settings[o.name].length?i.show():i.hide()}function u(r){var i=$("<tr></tr>").appendTo(a),s={};_.isArray(v.settings[o.name])||(v.settings[o.name]=[]),v.settings[o.name].push(s),_.each(o.settings,function(e){var t=$("<td></td>").appendTo(i),n="";_.isUndefined(r[e.name])||(n=r[e.name]),s[e.name]=n,$('<input class="table-row-value" type="text">').appendTo(t).val(n).change(function(){s[e.name]=$(this).val()})}),i.append($('<td class="table-row-operation"></td>').append($('<ul class="board-toolbar"></ul>').append($("<li></li>").append($('<i class="icon-trash icon-white"></i>').click(function(){var e=v.settings[o.name].indexOf(s);-1!=e&&(v.settings[o.name].splice(e,1),i.remove(),l())}))))),n.scrollTop(n[0].scrollHeight),l()}_.each(o.settings,function(e){var t=e.name;_.isUndefined(e.display_name)||(t=e.display_name),$("<th>"+t+"</th>").appendTo(s)}),o.name in b&&(r=b[o.name]),$('<div class="table-operation text-button">ADD</div>').appendTo(t).click(function(){var t={};_.each(o.settings,function(e){t[e.name]=""}),u(t)}),_.each(r,function(e,t){u(e)});break;case"boolean":v.settings[o.name]=b[o.name];var r=$('<div class="onoffswitch"><label class="onoffswitch-label" for="'+o.name+'-onoff"><div class="onoffswitch-inner"><span class="on">YES</span><span class="off">NO</span></div><div class="onoffswitch-switch"></div></label></div>').appendTo(t),c=$('<input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="'+o.name+'-onoff">').prependTo(r).change(function(){v.settings[o.name]=this.checked});o.name in b&&c.prop("checked",b[o.name]);break;case"option":var h=b[o.name],c=$("<select></select>").appendTo($('<div class="styled-select"></div>').appendTo(t)).change(function(){v.settings[o.name]=$(this).val()});_.each(o.options,function(e){var t,n;_.isObject(e)?(t=e.name,n=e.value):t=e,_.isUndefined(n)&&(n=t),_.isUndefined(h)&&(h=n),$("<option></option>").text(t).attr("value",n).appendTo(c)}),v.settings[o.name]=h,o.name in b&&c.val(b[o.name]);break;default:if(v.settings[o.name]=b[o.name],"calculated"==o.type){if(o.name in b){var d=b[o.name];if(o.multi_input&&_.isArray(d))for(var f=!1,p=0;p<d.length;p++)S(t,v,o,d[p],f),f=!0;else S(t,v,o,d,!1)}else S(t,v,o,null,!1);o.multi_input&&(r=$('<ul class="board-toolbar"><li class="add-setting-row"><i class="icon-plus icon-white"></i><label>ADD</label></li></ul>').mousedown(function(e){e.preventDefault(),S(t,v,o,null,!0)}),$(t).siblings(".form-label").append(r))}else{var g,c=$('<input type="text">').appendTo(t).change(function(){"number"==o.type?v.settings[o.name]=Number($(this).val()):v.settings[o.name]=$(this).val()});o.name in b&&c.val(b[o.name]),m&&o.typeahead_data_field&&c.addClass("typeahead_data_field-"+o.typeahead_data_field),m&&o.typeahead_field&&(g=[],c.keyup(function(e){65<=e.which&&e.which<=91&&c.trigger("change")}),$(c).autocomplete({source:g,select:function(e,t){c.val(t.item.value),c.trigger("change")}}),c.change(function(e){var r=c.val(),t=_.template(m)({input:r});$.get(t,function(e){if(y&&(e=e[y]),e=_.select(e,function(e){return e[o.typeahead_field][0]==r[0]}),g=_.map(e,function(e){return e[o.typeahead_field]}),$(c).autocomplete("option","source",g),1==e.length)for(var t in e=e[0]){var n;e.hasOwnProperty(t)&&(n=$(_.template("input.typeahead_data_field-<%= field %>")({field:t})))&&(n.val(e[t]),n.val()!=c.val())&&n.trigger("change")}})}))}}_.isUndefined(o.suffix)||t.append($('<div class="input-suffix">'+o.suffix+"</div>")),_.isUndefined(o.description)||t.append($('<div class="setting-description">'+o.description+"</div>"))})}s.append(o),new DialogBox(s,e,"Save","Cancel",function(){$(".validation-error").remove();for(var e,t=0;t<i.settings.length;t++){var n=i.settings[t];if(n.required&&(_.isUndefined(v.settings[n.name])||""==v.settings[n.name]))return c(n.name,"This is required."),!0;if("integer"==n.type&&v.settings[n.name]%1!=0)return c(n.name,"Must be a whole number."),!0;if("number"==n.type&&(e=v.settings[n.name],isNaN(parseFloat(e))||!isFinite(e)))return c(n.name,"Must be a number."),!0}_.isFunction(r)&&r(v)});var l,u,e=_.keys(t);1<e.length?(l=w("plugin-types","Type"),(u=$("<select></select>").appendTo($('<div class="styled-select"></div>').appendTo(l))).append($("<option>Select a type...</option>").attr("value","undefined")),_.each(t,function(e){u.append($("<option></option>").text(e.display_name).attr("value",e.type_name))}),u.change(function(){v.type=$(this).val(),v.settings={},($("#setting-row-instance-name").length?$("#setting-row-instance-name"):$("#setting-row-plugin-types")).nextAll().remove(),i=t[u.val()],_.isUndefined(i)?($("#setting-row-instance-name").hide(),$("#dialog-ok").hide()):($("#setting-row-instance-name").show(),i.description&&0<i.description.length?o.html(i.description).show():o.hide(),$("#dialog-ok").show(),a(i.settings,i.typeahead_source,i.typeahead_data_segment))})):1==e.length&&(i=t[e[0]],v.type=i.type_name,v.settings={},a(i.settings)),u&&(_.isUndefined(n)?($("#setting-row-instance-name").hide(),$("#dialog-ok").hide()):($("#dialog-ok").show(),u.val(n).trigger("change")))}return{createPluginEditor:function(e,t,n,r,i,s){o(e,t,n,r,i)}}},ValueEditor=function(g){var m=new RegExp('.*datasources\\["([^"]*)("\\])?(.*)$'),y=null,b=0,v=[],w=null,n={ANY:"any",ARRAY:"array",OBJECT:"object",STRING:"string",NUMBER:"number",BOOLEAN:"boolean"};function S(e,t){return _.isArray(e)||_.isObject(e)||r(e,t)}function r(e,t){switch(t){case n.ANY:return!0;case n.ARRAY:return _.isArray(e);case n.OBJECT:return _.isObject(e);case n.STRING:return _.isString(e);case n.NUMBER:return _.isNumber(e);case n.BOOLEAN:return _.isBoolean(e)}}function k(e,t){$(e).parent().find(".validation-error").remove(),r(w,t)||$(e).parent().append("<div class='validation-error'>This field expects an expression that evaluates to type "+t+".</div>")}function i(n,e){var r,i=(i=$(n).val().substring(0,$(n).getCaretPosition())).replace(String.fromCharCode(160)," "),t=i,s=g.datasources(),o=e,a=m.exec(t),l=[];if(a)if(""==a[1])_.each(s,function(e){l.push({value:e.name(),entity:void 0,precede_char:"",follow_char:'"]'})});else if(""!=a[1]&&_.isUndefined(a[2])){var u=a[1];_.each(s,function(e){e=e.name();e!=u&&0==e.indexOf(u)&&l.push({value:e,entity:void 0,precede_char:"",follow_char:'"]'})})}else{t=_.find(s,function(e){return e.name()===a[1]});if(!_.isUndefined(t)){var c,s="data",h="",d=(_.isUndefined(a[2])||(c=a[3].lastIndexOf("]")+1,s+=a[3].substring(0,c),h=(h=(h=a[3].substring(c,a[3].length)).replace(/^[\[\"]*/,"")).replace(/[\"\]]*$/,"")),t.getDataRepresentation(s));if(w=d,_.isArray(d))for(var f,p=0;p<d.length;p++)0==p.toString().indexOf(h)&&S(f=d[p],o)&&l.push({value:p,entity:f,precede_char:"[",follow_char:"]",preview:f.toString()});else _.isObject(d)&&_.each(d,function(e,t){0==t.indexOf(h)&&S(e,o)&&l.push({value:t,entity:e,precede_char:'["',follow_char:'"]'})})}}0<(v=l).length?((y=y||$('<ul id="value-selector" class="value-dropdown"></ul>').insertAfter(n).width($(n).outerWidth()-2).css("left",$(n).position().left).css("top",$(n).position().top+$(n).outerHeight()-1)).empty(),y.scrollTop(0),r=!0,b=0,_.each(v,function(e,t){e=function(n,r,i,e){var t=i.value;i.preview&&(t=t+"<span class='preview'>"+i.preview+"</span>");return $("<li>"+t+"</li>").appendTo(y).mouseenter(function(){$(this).trigger("freeboard-select")}).mousedown(function(e){$(this).trigger("freeboard-insertValue"),e.preventDefault()}).data("freeboard-optionIndex",e).data("freeboard-optionValue",i.value).bind("freeboard-insertValue",function(){var e=i.value,e=i.precede_char+e+i.follow_char,t=r.lastIndexOf("]");-1!=t?$(n).replaceTextAt(t+1,$(n).val().length,e):$(n).insertAtCaret(e),w=i.entity,$(n).triggerHandler("mouseup")}).bind("freeboard-select",function(){$(this).parent().find("li.selected").removeClass("selected"),$(this).addClass("selected"),b=$(this).data("freeboard-optionIndex")})}(n,i,e,t);r&&($(e).addClass("selected"),r=!1)})):(k(n,e),$(n).next("ul#value-selector").remove(),y=null,b=-1)}function s(n,t){$(n).addClass("calculated-value-input").bind("keyup mouseup freeboard-eval",function(e){!y||"keyup"!=e.type||38!=e.keyCode&&40!=e.keyCode&&13!=e.keyCode?i(n,t):e.preventDefault()}).focus(function(){var e,t;$(n).css({"z-index":3001}),e=n,t=($(e).val().match(/\n/g)||[]).length,t=Math.min(200,20*(t+1)),$(e).css({height:t+"px"})}).focusout(function(){k(n,t),$(n).css({height:"","z-index":3e3}),$(n).next("ul#value-selector").remove(),y=null,b=-1}).bind("keydown",function(e){var t;y&&(38==e.keyCode||40==e.keyCode?(e.preventDefault(),t=$(y).find("li"),38==e.keyCode?b--:40==e.keyCode&&b++,b<0?b=t.size()-1:b>=t.size()&&(b=0),(t=$(t).eq(b)).trigger("freeboard-select"),$(y).scrollTop($(t).position().top)):13==e.keyCode&&(e.preventDefault(),-1!=b)&&$(y).find("li").eq(b).trigger("freeboard-insertValue"))})}return{createValueEditor:function(e,t){s(e,t||n.ANY)},EXPECTED_TYPE:n}},function(o){var i=window.MutationObserver||window.WebKitMutationObserver;o.fn.attrchange=function(e){var t,n,r={trackValues:!1,callback:o.noop};return"function"==typeof e?r.callback=e:o.extend(r,e),r.trackValues&&o(this).each(function(e,t){for(var n,r={},e=0,i=t.attributes,s=i.length;e<s;e++)r[(n=i.item(e)).nodeName]=n.value;o(this).data("attr-old-value",r)}),i?(t={subtree:!1,attributes:!0,attributeOldValue:r.trackValues},n=new i(function(e){e.forEach(function(e){var t=e.target;r.trackValues&&(e.newValue=o(t).attr(e.attributeName)),r.callback.call(t,e)})}),this.each(function(){n.observe(this,t)})):function(){var e=document.createElement("p"),t=!1;if(e.addEventListener)e.addEventListener("DOMAttrModified",function(){t=!0},!1);else{if(!e.attachEvent)return;e.attachEvent("onDOMAttrModified",function(){t=!0})}return e.setAttribute("id","target"),t}()?this.on("DOMAttrModified",function(e){(e=e.originalEvent?e.originalEvent:e).attributeName=e.attrName,e.oldValue=e.prevValue,r.callback.call(this,e)}):"onpropertychange"in document.body?this.on("propertychange",function(e){e.attributeName=window.event.propertyName,function(e,t){var n;e&&(e=this.data("attr-old-value"),0<=t.attributeName.indexOf("style")?(e.style||(e.style={}),n=t.attributeName.split("."),t.attributeName=n[0],t.oldValue=e.style[n[1]],t.newValue=n[1]+":"+this.prop("style")[o.camelCase(n[1])],e.style[n[1]]=t.newValue):(t.oldValue=e[t.attributeName],t.newValue=this.attr(t.attributeName),e[t.attributeName]=t.newValue),this.data("attr-old-value",e))}.call(o(this),r.trackValues,e),r.callback.call(this,e)}):this}}(jQuery),function(e){e.eventEmitter={_JQInit:function(){this._JQ=e(this)},emit:function(e,t){this._JQ||this._JQInit(),this._JQ.trigger(e,t)},once:function(e,t){this._JQ||this._JQInit(),this._JQ.one(e,t)},on:function(e,t){this._JQ||this._JQInit(),this._JQ.bind(e,t)},off:function(e,t){this._JQ||this._JQInit(),this._JQ.unbind(e,t)}}}(jQuery);var freeboard=function(){var u={},c={},h=new FreeboardUI,d=new FreeboardModel(u,c,h),t=new JSEditor,e=new ValueEditor(d),f=new PluginEditor(t,e),n=new DeveloperConsole(d),r={values:{"font-family":'"HelveticaNeue-UltraLight", "Helvetica Neue Ultra Light", "Helvetica Neue", sans-serif',color:"#d3d4d4","font-weight":100}};return ko.bindingHandlers.pluginEditor={init:function(n,e,t,r,i){var s=ko.unwrap(e()),o={},a=void 0,l="";"datasource"==s.type?(o=u,l="Datasource"):"widget"==s.type?(o=c,l="Widget"):"pane"==s.type&&(l="Pane"),$(n).click(function(e){var t;"delete"==s.operation?new DialogBox($("<p>Are you sure you want to delete this "+l+"?</p>"),"Confirm Delete","Yes","No",function(){"datasource"==s.type?d.deleteDatasource(r):"widget"==s.type?d.deleteWidget(r):"pane"==s.type&&d.deletePane(r)}):(t=void 0,"datasource"==s.type?"add"==s.operation?a={}:(t=r.type(),(a=r.settings()).name=r.name()):"widget"==s.type?a="add"==s.operation?{}:(t=r.type(),r.settings()):"pane"==s.type&&(a={},"edit"==s.operation&&(a.title=r.title(),a.col_width=r.col_width()),o={settings:{settings:[{name:"title",display_name:"Title",type:"text"},{name:"col_width",display_name:"Columns",type:"integer",default_value:1,required:!0}]}}),f.createPluginEditor(l,o,t,a,function(e){var t;"add"==s.operation?"datasource"==s.type?(t=new DatasourceModel(d,u),d.addDatasource(t),t.name(e.settings.name),delete e.settings.name,t.settings(e.settings),t.type(e.type)):"widget"==s.type&&((t=new WidgetModel(d,c)).settings(e.settings),t.type(e.type),r.widgets.push(t),h.attachWidgetEditIcons(n)):"edit"==s.operation&&("pane"==s.type?(r.title(e.settings.title),r.col_width(e.settings.col_width),h.processResize(!1)):("datasource"==s.type&&(r.name(e.settings.name),delete e.settings.name),r.type(e.type),r.settings(e.settings)))}))})}},ko.virtualElements.allowedBindings.datasourceTypeSettings=!0,ko.bindingHandlers.datasourceTypeSettings={update:function(e,t,n,r,i){processPluginSettings(e,t,n,r,i)}},ko.bindingHandlers.pane={init:function(e,t,n,r,i){d.isEditing()&&$(e).css({cursor:"pointer"}),h.addPane(e,r,i.$root.isEditing())},update:function(e,t,n,r,i){-1==d.panes.indexOf(r)&&h.removePane(e),h.updatePane(e,r)}},ko.bindingHandlers.widget={init:function(e,t,n,r,i){d.isEditing()&&h.attachWidgetEditIcons($(e).parent())},update:function(e,t,n,r,i){r.shouldRender()&&($(e).empty(),r.render(e))}},$(function(){var e;function t(){h.processResize(!0)}h.showLoadingIndicator(!0),$(window).resize(function(){clearTimeout(e),e=setTimeout(t,500)})}),{initialize:function(e,t){ko.applyBindings(d);n=(n="load").replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=null==(n=new RegExp("[\\?&]"+n+"=([^&#]*)").exec(location.search))?"":decodeURIComponent(n[1].replace(/\+/g," "));""!=n?$.ajax({url:n,success:function(e){d.loadDashboard(e),_.isFunction(t)&&t()}}):(d.allow_edit(e),d.setEditing(e),h.showLoadingIndicator(!1),_.isFunction(t)&&t(),freeboard.emit("initialized"))},newDashboard:function(){d.loadDashboard({allow_edit:!0})},loadDashboard:function(e,t){d.loadDashboard(e,t)},serialize:function(){return d.serialize()},setEditing:function(e,t){d.setEditing(e,t)},isEditing:function(){return d.isEditing()},loadDatasourcePlugin:function(e){_.isUndefined(e.display_name)&&(e.display_name=e.type_name),e.settings.unshift({name:"name",display_name:"Name",type:"text",required:!0}),d.addPluginSource(e.source),u[e.type_name]=e,d._datasourceTypes.valueHasMutated()},resize:function(){h.processResize(!0)},loadWidgetPlugin:function(e){_.isUndefined(e.display_name)&&(e.display_name=e.type_name),d.addPluginSource(e.source),c[e.type_name]=e,d._widgetTypes.valueHasMutated()},setAssetRoot:function(e){t.setAssetRoot(e)},addStyle:function(e,t){e=e+"{"+t+"}",t=$("style#fb-styles");0==t.length&&(t=$('<style id="fb-styles" type="text/css"></style>'),$("head").append(t)),t[0].styleSheet?t[0].styleSheet.cssText+=e:t.text(t.text()+e)},showLoadingIndicator:function(e){h.showLoadingIndicator(e)},showDialog:function(e,t,n,r,i){new DialogBox(e,t,n,r,i)},getDatasourceSettings:function(t){var e=d.datasources(),e=_.find(e,function(e){return e.name()===t});return e?e.settings():null},setDatasourceSettings:function(t,e){var n=d.datasources(),n=_.find(n,function(e){return e.name()===t});n?(e=_.defaults(e,n.settings()),n.settings(e)):console.log("Datasource not found")},getStyleString:function(e){var n="";return _.each(r[e],function(e,t){n=n+t+":"+e+";"}),n},getStyleObject:function(e){return r[e]},showDeveloperConsole:function(){n.showDeveloperConsole()},loadFromFile:function(e){d.loadDashboardFromLocalFile(e)}}}();function cyblion_decrypt(e){var t=parseFloat(e)+10.2;return console.log(typeof e),console.log("plaintext:  "+t),console.log("cipher:  "+e),t}$.extend(freeboard,jQuery.eventEmitter),function(){function r(e,n){var r=this,t=null,i=e,s=0,o=!1;function a(e){t&&clearInterval(t),t=setInterval(function(){r.updateNow()},e)}a(1e3*i.refresh),this.updateNow=function(){if(!(1<s&&!i.use_thingproxy||2<s)){var e=i.url,t=(2==s&&i.use_thingproxy&&(e=("https:"==location.protocol?"https:":"http:")+"//thingproxy.freeboard.io/fetch/"+encodeURI(i.url)),i.body);if(t)try{t=JSON.parse(t)}catch(e){}$.ajax({url:e,dataType:1==s?"JSONP":"JSON",type:i.method||"GET",data:t,beforeSend:function(n){try{_.each(i.headers,function(e){var t=e.name,e=e.value;_.isUndefined(t)||_.isUndefined(e)||n.setRequestHeader(t,e)})}catch(e){}},success:function(e){o=!0,n(e)},error:function(e,t,n){o||(s++,r.updateNow())}})}},this.onDispose=function(){clearInterval(t),t=null},this.onSettingsChanged=function(e){o=!1,s=0,a(1e3*(i=e).refresh),r.updateNow()}}function i(e,t){var n=this,r=null,i=e;function s(e){r&&clearInterval(r),r=setInterval(function(){n.updateNow()},e)}s(1e3*i.refresh),this.updateNow=function(){$.ajax({url:"http://api.openweathermap.org/data/2.5/weather?APPID="+i.api_key+"&q="+encodeURIComponent(i.location)+"&units="+i.units,dataType:"JSONP",success:function(e){e={place_name:e.name,sunrise:new Date(1e3*e.sys.sunrise).toLocaleTimeString(),sunset:new Date(1e3*e.sys.sunset).toLocaleTimeString(),conditions:e.weather[0].description.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}),current_temp:e.main.temp,high_temp:e.main.temp_max,low_temp:e.main.temp_min,pressure:e.main.pressure,humidity:e.main.humidity,wind_speed:e.wind.speed,wind_direction:e.wind.deg};t(e)},error:function(e,t,n){}})},this.onDispose=function(){clearInterval(r),r=null},this.onSettingsChanged=function(e){i=e,n.updateNow(),s(1e3*i.refresh)}}function s(e,t){var n=e;function r(e){t(e)}this.updateNow=function(){dweetio.get_latest_dweet_for(n.thing_id,function(e,t){e||r(t[0].content)})},this.onDispose=function(){},this.onSettingsChanged=function(e){dweetio.stop_listening_for(n.thing_id),n=e,dweetio.listen_for(n.thing_id,function(e){r(e.content)})},this.onSettingsChanged(e)}function o(e,t){var n,r=this,i=e,s=[],o=0;function a(){0<s.length?(o<s.length&&(t(s[o]),o++),(o=o>=s.length&&i.loop?0:o)<s.length&&(n=setTimeout(a,1e3*i.refresh))):t({})}function l(){s=[],o=0,n&&(clearTimeout(n),n=null)}this.updateNow=function(){l(),$.ajax({url:i.datafile,dataType:i.is_jsonp?"JSONP":"JSON",success:function(e){s=_.isArray(e)?e:[],o=0,a()},error:function(e,t,n){}})},this.onDispose=function(){l()},this.onSettingsChanged=function(e){i=e,r.updateNow()}}function a(e,t){var n,r=this,i=e;function s(){n&&(clearTimeout(n),n=null)}function o(){s(),n=setInterval(r.updateNow,1e3*i.refresh)}this.updateNow=function(){var e=new Date,e={numeric_value:e.getTime(),full_string_value:e.toLocaleString(),date_string_value:e.toLocaleDateString(),time_string_value:e.toLocaleTimeString(),date_object:e};t(e)},this.onDispose=function(){s()},this.onSettingsChanged=function(e){i=e,o()},o()}freeboard.loadDatasourcePlugin({type_name:"JSON",settings:[{name:"url",display_name:"URL",type:"text"},{name:"use_thingproxy",display_name:"Try thingproxy",description:'A direct JSON connection will be tried first, if that fails, a JSONP connection will be tried. If that fails, you can use thingproxy, which can solve many connection problems to APIs. <a href="https://github.com/Freeboard/thingproxy" target="_blank">More information</a>.',type:"boolean",default_value:!0},{name:"refresh",display_name:"Refresh Every",type:"number",suffix:"seconds",default_value:5},{name:"method",display_name:"Method",type:"option",options:[{name:"GET",value:"GET"},{name:"POST",value:"POST"},{name:"PUT",value:"PUT"},{name:"DELETE",value:"DELETE"}]},{name:"body",display_name:"Body",type:"text",description:"The body of the request. Normally only used if method is POST"},{name:"headers",display_name:"Headers",type:"array",settings:[{name:"name",display_name:"Name",type:"text"},{name:"value",display_name:"Value",type:"text"}]}],newInstance:function(e,t,n){t(new r(e,n))}}),freeboard.loadDatasourcePlugin({type_name:"openweathermap",display_name:"Open Weather Map API",settings:[{name:"api_key",display_name:"API Key",type:"text",description:"Your personal API Key from Open Weather Map"},{name:"location",display_name:"Location",type:"text",description:"Example: London, UK"},{name:"units",display_name:"Units",type:"option",default:"imperial",options:[{name:"Imperial",value:"imperial"},{name:"Metric",value:"metric"}]},{name:"refresh",display_name:"Refresh Every",type:"number",suffix:"seconds",default_value:5}],newInstance:function(e,t,n){t(new i(e,n))}}),freeboard.loadDatasourcePlugin({type_name:"dweet_io",display_name:"Dweet.io",external_scripts:["http://dweet.io/client/dweet.io.min.js"],settings:[{name:"thing_id",display_name:"Thing Name",description:"Example: salty-dog-1",type:"text"}],newInstance:function(e,t,n){t(new s(e,n))}}),freeboard.loadDatasourcePlugin({type_name:"playback",display_name:"Playback",settings:[{name:"datafile",display_name:"Data File URL",type:"text",description:"A link to a JSON array of data."},{name:"is_jsonp",display_name:"Is JSONP",type:"boolean"},{name:"loop",display_name:"Loop",type:"boolean",description:"Rewind and loop when finished"},{name:"refresh",display_name:"Refresh Every",type:"number",suffix:"seconds",default_value:5}],newInstance:function(e,t,n){t(new o(e,n))}});freeboard.loadDatasourcePlugin({type_name:"clock",display_name:"Clock",settings:[{name:"refresh",display_name:"Refresh Every",type:"number",suffix:"seconds",default_value:1}],newInstance:function(e,t,n){t(new a(e,n))}}),freeboard.loadDatasourcePlugin({type_name:"meshblu",display_name:"Octoblu",description:"app.octoblu.com",external_scripts:["http://meshblu.octoblu.com/js/meshblu.js"],settings:[{name:"uuid",display_name:"UUID",type:"text",default_value:"device uuid",description:"your device UUID",required:!0},{name:"token",display_name:"Token",type:"text",default_value:"device token",description:"your device TOKEN",required:!0},{name:"server",display_name:"Server",type:"text",default_value:"meshblu.octoblu.com",description:"your server",required:!0},{name:"port",display_name:"Port",type:"number",default_value:80,description:"server port",required:!0}],newInstance:function(e,t,n){t(new l(e,n))}});var l=function(e,n){var r=e;this.onSettingsChanged=function(e){r=e},this.updateNow=function(){var t;(t=skynet.createConnection({uuid:r.uuid,token:r.token,server:r.server,port:r.port})).on("ready",function(e){t.on("message",function(e){n(e)})})},this.onDispose=function(){}}}(),function(){var u=100,c=["#FF9900","#FFFFFF","#B3B4B4","#6B6B6B","#28DE28","#13F7F9","#E6EE18","#C41204","#CA3CB8","#0B1CFB"];function h(n,e,r){function t(e,t){i[t]||(i[t]=[]),i[t].length>=u&&i[t].shift(),i[t].push(Number(e)),(void 0===s||e<s)&&(s=e),(void 0===o||o<e)&&(o=e)}var i=$(n).data().values,s=$(n).data().valueMin,o=$(n).data().valueMax,a=(i||(i=[],o=s=void 0),_.isArray(e)?_.each(e,t):t(e,0),$(n).data().values=i,$(n).data().valueMin=s,$(n).data().valueMax=o,'<span style="color: {{color}}">&#9679;</span> {{y}}'),l=!1;_.each(i,function(e,t){$(n).sparkline(e,{type:"line",composite:l,height:"100%",width:"100%",fillColor:!1,lineColor:c[t%c.length],lineWidth:2,spotRadius:3,spotColor:!1,minSpotColor:"#78AB49",maxSpotColor:"#78AB49",highlightSpotColor:"#9D3926",highlightLineColor:"#9D3926",chartRangeMin:s,chartRangeMax:o,tooltipFormat:r&&r[t]?a+" ("+r[t]+")":a}),l=!0})}function n(e){var l=e,t=$('<div class="tw-display"></div>'),r=$('<h2 class="section-title tw-title tw-td"></h2>'),u=$('<div class="tw-value"></div>'),i=$('<div class="tw-unit"></div>'),c=$('<div class="tw-sparkline tw-td"></div>');function s(){_.isUndefined(l.units)||""==l.units?u.css("max-width","100%"):u.css("max-width",t.innerWidth()-i.outerWidth(!0)+"px")}this.render=function(e){$(e).empty(),$(t).append($('<div class="tw-tr"></div>').append(r)).append($('<div class="tw-tr"></div>').append($('<div class="tw-value-wrapper tw-td"></div>').append(u).append(i))).append($('<div class="tw-tr"></div>').append(c)),$(e).append(t),s()},this.onSettingsChanged=function(e){l=e;var t=!_.isUndefined(e.title)&&""!=e.title,n=!_.isUndefined(e.units)&&""!=e.units,t=(e.sparkline?c.attr("style",null):(delete c.data().values,c.empty(),c.hide()),t?(r.html(_.isUndefined(e.title)?"":e.title),r.attr("style",null)):(r.empty(),r.hide()),n?(i.html(_.isUndefined(e.units)?"":e.units),i.attr("style",null)):(i.empty(),i.hide()),30);"big"==e.size&&(t=75,e.sparkline)&&(t=60),u.css({"font-size":t+"px"}),s()},this.onSizeChanged=function(){s()},this.onCalculatedValueChanged=function(e,t){var n,r,i,s,o,a;"value"==e&&(l.animate?(n=t,r=u,e=500,(a=$(r).text())!=n&&($.isNumeric(n)&&$.isNumeric(a)?(s=0,1<(i=n.toString().split(".")).length&&(s=i[1].length),o=0,1<(i=a.toString().split(".")).length&&(o=i[1].length),jQuery({transitionValue:Number(a),precisionValue:o}).animate({transitionValue:Number(n),precisionValue:s},{duration:e,step:function(){$(r).text(this.transitionValue.toFixed(this.precisionValue))},done:function(){$(r).text(n)}})):$(r).text(n))):u.text(t),l.sparkline)&&h(c,t)},this.onDispose=function(){},this.getHeight=function(){return"big"==l.size||l.sparkline?2:1},this.onSettingsChanged(e)}function r(e){var n,t="gauge-"+f++,r=$('<h2 class="section-title"></h2>'),i=$('<div class="gauge-widget" id="'+t+'"></div>'),s=!1,o=e;function a(){s&&(i.empty(),n=new JustGage({id:t,value:_.isUndefined(o.min_value)?0:o.min_value,min:_.isUndefined(o.min_value)?0:o.min_value,max:_.isUndefined(o.max_value)?0:o.max_value,label:o.units,showInnerShadow:!1,valueFontColor:"#d3d4d4"}))}this.render=function(e){s=!0,$(e).append(r).append($('<div class="gauge-widget-wrapper"></div>').append(i)),a()},this.onSettingsChanged=function(e){e.min_value!=o.min_value||e.max_value!=o.max_value||e.units!=o.units?(o=e,a()):o=e,r.html(e.title)},this.onCalculatedValueChanged=function(e,t){_.isUndefined(n)||n.refresh(Number(t))},this.onDispose=function(){},this.getHeight=function(){return 3},this.onSettingsChanged(e)}function i(e){var a=$('<h2 class="section-title"></h2>'),n=$('<div class="sparkline"></div>'),l=$("<div></div>"),u=e;this.render=function(e){$(e).append(a).append(n).append(l)},this.onSettingsChanged=function(e){if(u=e,a.html(_.isUndefined(e.title)?"":e.title),e.include_legend){for(var t=l,n=e.legend.split(","),r=$("<div class='sparkline-legend'></div>"),i=0;i<n.length;i++){var s=c[i%c.length],o=n[i];r.append("<div class='sparkline-legend-value'><span style='color:"+s+"'>&#9679;</span>"+o+"</div>")}t.empty().append(r),freeboard.addStyle(".sparkline-legend","margin:5px;"),freeboard.addStyle(".sparkline-legend-value","color:white; font:10px arial,san serif; float:left; overflow:hidden; width:50%;"),freeboard.addStyle(".sparkline-legend-value span","font-weight:bold; padding-right:5px;")}},this.onCalculatedValueChanged=function(e,t){u.legend?h(n,t,u.legend.split(",")):h(n,t)},this.onDispose=function(){},this.getHeight=function(){var e,t=0;return u.include_legend&&u.legend&&(4<(e=u.legend.split(",").length)?t=.5*Math.floor((e-1)/4):e&&(t=.5)),2+t},this.onSettingsChanged(e)}function s(e){var r,i,s,o,a=$('<div class="widget-big-text"></div>'),l=$("<div></div>");this.render=function(e){s=$(e).width(),o=$(e).height();var t=Math.min(s,o)/2-6,n=(r=Raphael($(e).get()[0],s,o)).circle(s/2,o/2,t);n.attr("stroke","#FF9900"),n.attr("stroke-width",3),(i=r.path(function(e){if(!e||e.length<2)return[];var t=[];t.push(["m",e[0],e[1]]);for(var n=2;n<e.length;n+=2)t.push(["l",e[n],e[n+1]]);return t.push(["z"]),t}([s/2,o/2-t+3,15,20,-30,0]))).attr("stroke-width",0),i.attr("fill","#fff"),$(e).append($('<div class="pointer-value"></div>').append(a).append(l))},this.onSettingsChanged=function(e){l.html(e.units)},this.onCalculatedValueChanged=function(e,t){"direction"==e?(_.isUndefined(i)||i.animate({transform:"r"+t+","+s/2+","+o/2},250,"bounce"),0):"value_text"==e&&a.html(t)},this.onDispose=function(){},this.getHeight=function(){return 4},this.onSettingsChanged(e)}function o(e){var t,n,r;function i(){n&&(clearInterval(n),n=null)}function s(){var e;t&&r&&(e=r+(-1==r.indexOf("?")?"?":"&")+Date.now(),$(t).css({"background-image":"url("+e+")"}))}this.render=function(e){$(e).css({width:"100%",height:"100%","background-size":"cover","background-position":"center"}),t=e},this.onSettingsChanged=function(e){i(),e.refresh&&0<e.refresh&&(n=setInterval(s,1e3*Number(e.refresh)))},this.onCalculatedValueChanged=function(e,t){"src"==e&&(r=t),s()},this.onDispose=function(){i()},this.getHeight=function(){return 4},this.onSettingsChanged(e)}function a(e){var n,r,t=$('<h2 class="section-title"></h2>'),i=$('<div class="indicator-text"></div>'),s=$('<div class="indicator-light"></div>'),o=e,a=!1;function l(){s.toggleClass("on",a),a?i.text(_.isUndefined(n)?_.isUndefined(o.on_text)?"":o.on_text:n):i.text(_.isUndefined(r)?_.isUndefined(o.off_text)?"":o.off_text:r)}this.render=function(e){$(e).append(t).append(s).append(i)},this.onSettingsChanged=function(e){o=e,t.html(_.isUndefined(e.title)?"":e.title),l()},this.onCalculatedValueChanged=function(e,t){"value"==e&&(a=Boolean(t)),"on_text"==e&&(n=t),"off_text"==e&&(r=t),l()},this.onDispose=function(){},this.getHeight=function(){return 1},this.onSettingsChanged(e)}function l(e){var n,r,i={};function s(){var e;n&&r&&i.lat&&i.lon&&(e=new google.maps.LatLng(i.lat,i.lon),r.setPosition(e),n.panTo(e))}this.render=function(t){function e(){var e={zoom:13,center:new google.maps.LatLng(37.235,-115.811111),disableDefaultUI:!0,draggable:!1,styles:[{featureType:"water",elementType:"geometry",stylers:[{color:"#2a2a2a"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#000000"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"},{lightness:16}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#000000"},{lightness:21}]},{elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#000000"},{lightness:19}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:17},{weight:1.2}]}]};n=new google.maps.Map(t,e),google.maps.event.addDomListener(t,"mouseenter",function(e){e.cancelBubble=!0,n.hover||(n.hover=!0,n.setOptions({zoomControl:!0}))}),google.maps.event.addDomListener(t,"mouseleave",function(e){n.hover&&(n.setOptions({zoomControl:!1}),n.hover=!1)}),r=new google.maps.Marker({map:n}),s()}window.google&&window.google.maps?e():(window.gmap_initialize=e,head.js("https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&callback=gmap_initialize"))},this.onSettingsChanged=function(e){0},this.onCalculatedValueChanged=function(e,t){"lat"==e?i.lat=t:"lon"==e&&(i.lon=t),s()},this.onDispose=function(){},this.getHeight=function(){return 4},this.onSettingsChanged(e)}function d(e){var n=$('<div class="html-widget"></div>'),t=e;this.render=function(e){$(e).append(n)},this.onSettingsChanged=function(e){t=e},this.onCalculatedValueChanged=function(e,t){"html"==e&&n.html(t)},this.onDispose=function(){},this.getHeight=function(){return Number(t.height)},this.onSettingsChanged(e)}var e=freeboard.getStyleString("values"),f=(freeboard.addStyle(".widget-big-text",e+"font-size:75px;"),freeboard.addStyle(".tw-display","width: 100%; height:100%; display:table; table-layout:fixed;"),freeboard.addStyle(".tw-tr","display:table-row;"),freeboard.addStyle(".tw-tg","display:table-row-group;"),freeboard.addStyle(".tw-tc","display:table-caption;"),freeboard.addStyle(".tw-td","display:table-cell;"),freeboard.addStyle(".tw-value",e+"overflow: hidden;display: inline-block;text-overflow: ellipsis;"),freeboard.addStyle(".tw-unit","display: inline-block;padding-left: 10px;padding-bottom: 1.1em;vertical-align: bottom;"),freeboard.addStyle(".tw-value-wrapper","position: relative;vertical-align: middle;height:100%;"),freeboard.addStyle(".tw-sparkline","height:20px;"),freeboard.loadWidgetPlugin({type_name:"text_widget",display_name:"Text",external_scripts:["plugins/thirdparty/jquery.sparkline.min.js"],settings:[{name:"title",display_name:"Title",type:"text"},{name:"size",display_name:"Size",type:"option",options:[{name:"Regular",value:"regular"},{name:"Big",value:"big"}]},{name:"value",display_name:"Value",type:"calculated"},{name:"sparkline",display_name:"Include Sparkline",type:"boolean"},{name:"animate",display_name:"Animate Value Changes",type:"boolean",default_value:!0},{name:"units",display_name:"Units",type:"text"}],newInstance:function(e,t){t(new n(e))}}),0);freeboard.addStyle(".gauge-widget-wrapper","width: 100%;text-align: center;"),freeboard.addStyle(".gauge-widget","width:200px;height:160px;display:inline-block;"),freeboard.loadWidgetPlugin({type_name:"gauge",display_name:"Gauge",external_scripts:["plugins/thirdparty/raphael.2.1.0.min.js","plugins/thirdparty/justgage.1.0.1.js"],settings:[{name:"title",display_name:"Title",type:"text"},{name:"value",display_name:"Value",type:"calculated"},{name:"units",display_name:"Units",type:"text"},{name:"min_value",display_name:"Minimum",type:"text",default_value:0},{name:"max_value",display_name:"Maximum",type:"text",default_value:100}],newInstance:function(e,t){t(new r(e))}}),freeboard.addStyle(".sparkline","width:100%;height: 75px;"),freeboard.loadWidgetPlugin({type_name:"sparkline",display_name:"Sparkline",external_scripts:["plugins/thirdparty/jquery.sparkline.min.js"],settings:[{name:"title",display_name:"Title",type:"text"},{name:"value",display_name:"Value",type:"calculated",multi_input:"true"},{name:"include_legend",display_name:"Include Legend",type:"boolean"},{name:"legend",display_name:"Legend",type:"text",description:"Comma-separated for multiple sparklines"}],newInstance:function(e,t){t(new i(e))}}),freeboard.addStyle("div.pointer-value","position:absolute;height:95px;margin: auto;top: 0px;bottom: 0px;width: 100%;text-align:center;"),freeboard.loadWidgetPlugin({type_name:"pointer",display_name:"Pointer",external_scripts:["plugins/thirdparty/raphael.2.1.0.min.js"],settings:[{name:"direction",display_name:"Direction",type:"calculated",description:"In degrees"},{name:"value_text",display_name:"Value Text",type:"calculated"},{name:"units",display_name:"Units",type:"text"}],newInstance:function(e,t){t(new s(e))}}),freeboard.loadWidgetPlugin({type_name:"picture",display_name:"Picture",fill_size:!0,settings:[{name:"src",display_name:"Image URL",type:"calculated"},{type:"number",display_name:"Refresh every",name:"refresh",suffix:"seconds",description:"Leave blank if the image doesn't need to be refreshed"}],newInstance:function(e,t){t(new o(e))}}),freeboard.addStyle(".indicator-light","border-radius:50%;width:22px;height:22px;border:2px solid #3d3d3d;margin-top:5px;float:left;background-color:#222;margin-right:10px;"),freeboard.addStyle(".indicator-light.on","background-color:#FFC773;box-shadow: 0px 0px 15px #FF9900;border-color:#FDF1DF;"),freeboard.addStyle(".indicator-text","margin-top:10px;"),freeboard.loadWidgetPlugin({type_name:"indicator",display_name:"Indicator Light",settings:[{name:"title",display_name:"Title",type:"text"},{name:"value",display_name:"Value",type:"calculated"},{name:"on_text",display_name:"On Text",type:"calculated"},{name:"off_text",display_name:"Off Text",type:"calculated"}],newInstance:function(e,t){t(new a(e))}}),freeboard.addStyle(".gm-style-cc a","text-shadow:none;"),freeboard.loadWidgetPlugin({type_name:"google_map",display_name:"Google Map",fill_size:!0,settings:[{name:"lat",display_name:"Latitude",type:"calculated"},{name:"lon",display_name:"Longitude",type:"calculated"}],newInstance:function(e,t){t(new l(e))}}),freeboard.addStyle(".html-widget","white-space:normal;width:100%;height:100%");freeboard.loadWidgetPlugin({type_name:"html",display_name:"HTML",fill_size:!0,settings:[{name:"html",display_name:"HTML",type:"calculated",description:"Can be literal HTML, or javascript that outputs HTML."},{name:"height",display_name:"Height Blocks",type:"number",default_value:4,description:"A height block is around 60 pixels"}],newInstance:function(e,t){t(new d(e))}})}(),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).mqtt=e()}(function(){return function r(i,s,o){function a(t,e){if(!s[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=s[t]={exports:{}},i[t][0].call(n.exports,function(e){return a(i[t][1][e]||e)},n,n.exports,r,i,s,o)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<o.length;e++)a(o[e]);return a}({1:[function(x,C,e){!function(n,E){!function(){"use strict";const r=x("events").EventEmitter,s=x("./store"),o=x("./topic-alias-recv"),i=x("./topic-alias-send"),a=x("mqtt-packet"),l=x("./default-message-id-provider"),u=x("readable-stream").Writable;var e=x("inherits");const t=x("reinterval"),c=x("rfdc/default"),h=x("./validations"),d=x("xtend"),f=x("debug")("mqttjs:client"),p=n?n.nextTick:function(e){setTimeout(e,0)},g=E.setImmediate||function(e){p(e)},m={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0,resubscribe:!0},y=["ECONNREFUSED","EADDRINUSE","ECONNRESET","ENOTFOUND"],b={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};function v(e,t){let n;if(t.properties&&(n=t.properties.topicAlias),0===t.topic.toString().length){if(void 0===n)return new Error("Unregistered Topic Alias");if(void 0===(e=e.topicAliasSend.getTopicByAlias(n)))return new Error("Unregistered Topic Alias");t.topic=e}n&&delete t.properties.topicAlias}function _(e,t,n){f("sendPacket :: packet: %O",t),f("sendPacket :: emitting `packetsend`"),e.emit("packetsend",t),f("sendPacket :: writing to stream");t=a.writeToStream(t,e.stream,e.options);f("sendPacket :: writeToStream result %s",t),!t&&n&&n!==S?(f("sendPacket :: handle events on `drain` once through callback."),e.stream.once("drain",n)):n&&(f("sendPacket :: invoking cb"),n())}function w(t,n,r,i){f("storeAndSend :: store packet with cmd %s to outgoingStore",n.cmd);let e=n;var s;if("publish"===e.cmd&&(e=c(n),s=v(t,e)))return r&&r(s);t.outgoingStore.put(e,function(e){if(e)return r&&r(e);i(),_(t,n,r)})}function S(e){f("nop ::",e)}function k(e,t){let n;const i=this;if(!(this instanceof k))return new k(e,t);for(n in this.options=t||{},m)void 0===this.options[n]?this.options[n]=m[n]:this.options[n]=t[n];f("MqttClient :: options.protocol",t.protocol),f("MqttClient :: options.protocolVersion",t.protocolVersion),f("MqttClient :: options.username",t.username),f("MqttClient :: options.keepalive",t.keepalive),f("MqttClient :: options.reconnectPeriod",t.reconnectPeriod),f("MqttClient :: options.rejectUnauthorized",t.rejectUnauthorized),f("MqttClient :: options.topicAliasMaximum",t.topicAliasMaximum),this.options.clientId="string"==typeof t.clientId?t.clientId:"mqttjs_"+Math.random().toString(16).substr(2,8),f("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=5===t.protocolVersion&&t.customHandleAcks?t.customHandleAcks:function(){arguments[3](0)},this.streamBuilder=e,this.messageIdProvider=void 0===this.options.messageIdProvider?new l:this.options.messageIdProvider,this.outgoingStore=t.outgoingStore||new s,this.incomingStore=t.incomingStore||new s,this.queueQoSZero=void 0===t.queueQoSZero||t.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this._storeProcessingQueue=[],this.outgoing={},this._firstConnection=!0,0<t.topicAliasMaximum&&(65535<t.topicAliasMaximum?f("MqttClient :: options.topicAliasMaximum is out of range"):this.topicAliasRecv=new o(t.topicAliasMaximum)),this.on("connect",function(){const e=this.queue;f("connect :: sending queued packets"),function t(){const n=e.shift();f("deliver :: entry %o",n);var r;if(n){r=n.packet,f("deliver :: call _sendPacket for %o",r);let e=!0;(e=!(r.messageId&&0!==r.messageId&&!i.messageIdProvider.register(r.messageId))&&e)?i._sendPacket(r,function(e){n.cb&&n.cb(e),t()}):(f("messageId: %d has already used. The message is skipped and removed.",r.messageId),t())}else i._resubscribe()}()}),this.on("close",function(){f("close :: connected set to `false`"),this.connected=!1,f("close :: clearing connackTimer"),clearTimeout(this.connackTimer),f("close :: clearing ping timer"),null!==i.pingTimer&&(i.pingTimer.clear(),i.pingTimer=null),this.topicAliasRecv&&this.topicAliasRecv.clear(),f("close :: calling _setupReconnect"),this._setupReconnect()}),r.call(this),f("MqttClient :: setting up stream"),this._setupStream()}e(k,r),k.prototype._setupStream=function(){const n=this;var e=new u;const r=a.parser(this.options);let i=null;const t=[];function s(){var e;t.length?p(o):(e=i,i=null,e())}function o(){f("work :: getting next packet in queue");var e=t.shift();e?(f("work :: packet pulled from queue"),n._handlePacket(e,s)):(f("work :: no packets in queue"),e=i,i=null,f("work :: done flag is %s",!!e),e&&e())}f("_setupStream :: calling method to clear reconnect"),this._clearReconnect(),f("_setupStream :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),r.on("packet",function(e){f("parser :: on packet push to packets array."),t.push(e)}),e._write=function(e,t,n){i=n,f("writable stream :: parsing buffer"),r.parse(e),o()},f("_setupStream :: pipe stream to writable stream"),this.stream.pipe(e),this.stream.on("error",function(e){f("streamErrorHandler :: error",e.message),y.includes(e.code)?(f("streamErrorHandler :: emitting error"),n.emit("error",e)):S(e)}),this.stream.on("close",function(){var t;f("(%s)stream :: on close",n.options.clientId),(t=n.outgoing)&&(f("flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(t).forEach(function(e){t[e].volatile&&"function"==typeof t[e].cb&&(t[e].cb(new Error("Connection closed")),delete t[e])})),f("stream: emit close to MqttClient"),n.emit("close")}),f("_setupStream: sending packet `connect`");e=Object.create(this.options);if(e.cmd="connect",this.topicAliasRecv&&(e.properties||(e.properties={}),this.topicAliasRecv)&&(e.properties.topicAliasMaximum=this.topicAliasRecv.max),_(this,e),r.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return n.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;this.options.properties.authenticationMethod&&this.options.authPacket&&"object"==typeof this.options.authPacket&&_(this,d({cmd:"auth",reasonCode:0},this.options.authPacket))}this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(function(){f("!!connectTimeout hit!! Calling _cleanUp with force `true`"),n._cleanUp(!0)},this.options.connectTimeout)},k.prototype._handlePacket=function(e,t){var n=this.options;if(5===n.protocolVersion&&n.properties&&n.properties.maximumPacketSize&&n.properties.maximumPacketSize<e.length)return this.emit("error",new Error("exceeding packets size "+e.cmd)),this.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),this;switch(f("_handlePacket :: emitting packetreceive"),this.emit("packetreceive",e),e.cmd){case"publish":this._handlePublish(e,t);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":this._handleAck(e),t();break;case"pubrel":this._handlePubrel(e,t);break;case"connack":this._handleConnack(e),t();break;case"auth":this._handleAuth(e),t();break;case"pingresp":this._handlePingresp(e),t();break;case"disconnect":this._handleDisconnect(e),t()}},k.prototype._checkDisconnecting=function(e){return this.disconnecting&&(e&&e!==S?e(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting},k.prototype.publish=function(n,r,i,s){f("publish :: message `%s` to topic `%s`",r,n);const o=this.options;"function"==typeof i&&(s=i,i=null);if(i=d({qos:0,retain:!1,dup:!1},i),!this._checkDisconnecting(s)){const a=this;var e=function(){let e=0;if((1===i.qos||2===i.qos)&&null===(e=a._nextId()))return f("No messageId left"),!1;var t={cmd:"publish",topic:n,payload:r,qos:i.qos,retain:i.retain,messageId:e,dup:i.dup};switch(5===o.protocolVersion&&(t.properties=i.properties),f("publish :: qos",i.qos),i.qos){case 1:case 2:a.outgoing[t.messageId]={volatile:!1,cb:s||S},f("MqttClient:publish: packet cmd: %s",t.cmd),a._sendPacket(t,void 0,i.cbStorePut);break;default:f("MqttClient:publish: packet cmd: %s",t.cmd),a._sendPacket(t,s,i.cbStorePut)}return!0};(this._storeProcessing||0<this._storeProcessingQueue.length||!e())&&this._storeProcessingQueue.push({invoke:e,cbStorePut:i.cbStorePut,callback:s})}return this},k.prototype.subscribe=function(){const r=this;var t=new Array(arguments.length);for(let e=0;e<arguments.length;e++)t[e]=arguments[e];const i=[];let n=t.shift();const s=n.resubscribe;let o=t.pop()||S,a=t.pop();const l=this.options.protocolVersion;delete n.resubscribe,"string"==typeof n&&(n=[n]),"function"!=typeof o&&(a=o,o=S);var e=h.validateTopics(n);return null!==e?g(o,new Error("Invalid topic "+e)):this._checkDisconnecting(o)?f("subscribe: discconecting true"):(e={qos:0},5===l&&(e.nl=!1,e.rap=!1,e.rh=0),a=d(e,a),Array.isArray(n)?n.forEach(function(e){f("subscribe: array topic %s",e),(!Object.prototype.hasOwnProperty.call(r._resubscribeTopics,e)||r._resubscribeTopics[e].qos<a.qos||s)&&(e={topic:e,qos:a.qos},5===l&&(e.nl=a.nl,e.rap=a.rap,e.rh=a.rh,e.properties=a.properties),f("subscribe: pushing topic `%s` and qos `%s` to subs list",e.topic,e.qos),i.push(e))}):Object.keys(n).forEach(function(e){var t;f("subscribe: object topic %s",e),(!Object.prototype.hasOwnProperty.call(r._resubscribeTopics,e)||r._resubscribeTopics[e].qos<n[e].qos||s)&&(t={topic:e,qos:n[e].qos},5===l&&(t.nl=n[e].nl,t.rap=n[e].rap,t.rh=n[e].rh,t.properties=a.properties),f("subscribe: pushing `%s` to subs list",t),i.push(t))}),i.length?(e=function(){var e=r._nextId();if(null===e)return f("No messageId left"),!1;e={cmd:"subscribe",subscriptions:i,qos:1,retain:!1,dup:!1,messageId:e};if(a.properties&&(e.properties=a.properties),r.options.resubscribe){f("subscribe :: resubscribe true");const n=[];i.forEach(function(e){var t;0<r.options.reconnectPeriod&&(t={qos:e.qos},5===l&&(t.nl=e.nl||!1,t.rap=e.rap||!1,t.rh=e.rh||0,t.properties=e.properties),r._resubscribeTopics[e.topic]=t,n.push(e.topic))}),r.messageIdToTopic[e.messageId]=n}return r.outgoing[e.messageId]={volatile:!0,cb:function(e,t){if(!e){var n=t.granted;for(let e=0;e<n.length;e+=1)i[e].qos=n[e]}o(e,i)}},f("subscribe :: call _sendPacket"),r._sendPacket(e),!0},(this._storeProcessing||0<this._storeProcessingQueue.length||!e())&&this._storeProcessingQueue.push({invoke:e,callback:o})):o(null,[])),this},k.prototype.unsubscribe=function(){const t=this;var n=new Array(arguments.length);for(let e=0;e<arguments.length;e++)n[e]=arguments[e];let r=n.shift(),i=n.pop()||S,s=n.pop();"string"==typeof r&&(r=[r]),"function"!=typeof i&&(s=i,i=S);var e=h.validateTopics(r);return null!==e?g(i,new Error("Invalid topic "+e)):!t._checkDisconnecting(i)&&(e=function(){var e=t._nextId();return null===e?(f("No messageId left"),!1):(e={cmd:"unsubscribe",qos:1,messageId:e},"string"==typeof r?e.unsubscriptions=[r]:Array.isArray(r)&&(e.unsubscriptions=r),t.options.resubscribe&&e.unsubscriptions.forEach(function(e){delete t._resubscribeTopics[e]}),"object"==typeof s&&s.properties&&(e.properties=s.properties),t.outgoing[e.messageId]={volatile:!0,cb:i},f("unsubscribe: call _sendPacket"),t._sendPacket(e),!0)},this._storeProcessing||0<this._storeProcessingQueue.length||!e())&&this._storeProcessingQueue.push({invoke:e,callback:i}),this},k.prototype.end=function(e,t,n){const r=this;function i(){f("end :: (%s) :: finish :: calling _cleanUp with force %s",r.options.clientId,e),r._cleanUp(e,()=>{f("end :: finish :: calling process.nextTick on closeStores"),p(function(){f("end :: closeStores: closing incoming and outgoing stores"),r.disconnected=!0,r.incomingStore.close(function(t){r.outgoingStore.close(function(e){f("end :: closeStores: emitting end"),r.emit("end"),n&&(e=t||e,f("end :: closeStores: invoking callback with args"),n(e))})}),r._deferredReconnect&&r._deferredReconnect()}.bind(r))},t)}return f("end :: (%s)",this.options.clientId),null!=e&&"boolean"==typeof e||(n=t||S,t=e,e=!1,"object"!=typeof t&&(n=t,t=null,"function"!=typeof n)&&(n=S)),"object"!=typeof t&&(n=t,t=null),f("end :: cb? %s",!!n),n=n||S,this.disconnecting?n():(this._clearReconnect(),this.disconnecting=!0,!e&&0<Object.keys(this.outgoing).length?(f("end :: (%s) :: calling finish in 10ms once outgoing is empty",r.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,i,10))):(f("end :: (%s) :: immediately calling finish",r.options.clientId),i())),this},k.prototype.removeOutgoingMessage=function(e){const t=this.outgoing[e]?this.outgoing[e].cb:null;return delete this.outgoing[e],this.outgoingStore.del({messageId:e},function(){t(new Error("Message removed"))}),this},k.prototype.reconnect=function(e){f("client reconnect");const t=this;function n(){e?(t.options.incomingStore=e.incomingStore,t.options.outgoingStore=e.outgoingStore):(t.options.incomingStore=null,t.options.outgoingStore=null),t.incomingStore=t.options.incomingStore||new s,t.outgoingStore=t.options.outgoingStore||new s,t.disconnecting=!1,t.disconnected=!1,t._deferredReconnect=null,t._reconnect()}return this.disconnecting&&!this.disconnected?this._deferredReconnect=n:n(),this},k.prototype._reconnect=function(){f("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this._setupStream()}),f("client already connected. disconnecting first.")):(f("_reconnect: calling _setupStream"),this._setupStream())},k.prototype._setupReconnect=function(){const e=this;!e.disconnecting&&!e.reconnectTimer&&0<e.options.reconnectPeriod?(this.reconnecting||(f("_setupReconnect :: emit `offline` state"),this.emit("offline"),f("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),f("_setupReconnect :: setting reconnectTimer for %d ms",e.options.reconnectPeriod),e.reconnectTimer=setInterval(function(){f("reconnectTimer :: reconnect triggered!"),e._reconnect()},e.options.reconnectPeriod)):f("_setupReconnect :: doing nothing...")},k.prototype._clearReconnect=function(){f("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)},k.prototype._cleanUp=function(e,t){var n,r=arguments[2];t&&(f("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",t)),f("_cleanUp :: forced? %s",e),e?(0===this.options.reconnectPeriod&&this.options.clean&&(n=this.outgoing)&&(f("flush: queue exists? %b",!!n),Object.keys(n).forEach(function(e){"function"==typeof n[e].cb&&(n[e].cb(new Error("Connection closed")),delete n[e])})),f("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy()):(e=d({cmd:"disconnect"},r),f("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(e,g.bind(null,this.stream.end.bind(this.stream)))),this.disconnecting||(f("_cleanUp :: client not disconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),null!==this.pingTimer&&(f("_cleanUp :: clearing pingTimer"),this.pingTimer.clear(),this.pingTimer=null),t&&!this.connected&&(f("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",t),t())},k.prototype._sendPacket=function(e,t,n){f("_sendPacket :: (%s) ::  start",this.options.clientId),n=n||S,t=t||S;var r=function(e,t){let n;if(5===e.options.protocolVersion&&"publish"===t.cmd){t.properties&&(n=t.properties.topicAlias);var r=t.topic.toString();if(e.topicAliasSend)if(n){if(0!==r.length&&(f("applyTopicAlias :: register topic: %s - alias: %d",r,n),!e.topicAliasSend.put(r,n)))return f("applyTopicAlias :: error out of range. topic: %s - alias: %d",r,n),new Error("Sending Topic Alias out of range")}else 0!==r.length&&(e.options.autoAssignTopicAlias?(n=e.topicAliasSend.getAliasByTopic(r))?(t.topic="",t.properties={...t.properties,topicAlias:n},f("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",r,n)):(n=e.topicAliasSend.getLruAlias(),e.topicAliasSend.put(r,n),t.properties={...t.properties,topicAlias:n},f("applyTopicAlias :: auto assign topic: %s - alias: %d",r,n)):e.options.autoUseTopicAlias&&(n=e.topicAliasSend.getAliasByTopic(r))&&(t.topic="",t.properties={...t.properties,topicAlias:n},f("applyTopicAlias :: auto use topic: %s - alias: %d",r,n)));else if(n)return f("applyTopicAlias :: error out of range. topic: %s - alias: %d",r,n),new Error("Sending Topic Alias out of range")}}(this,e);if(r)t(r);else{if(!this.connected)return"auth"===e.cmd?(this._shiftPingInterval(),void _(this,e,t)):(f("_sendPacket :: client not connected. Storing packet offline."),void this._storePacket(e,t,n));switch(this._shiftPingInterval(),e.cmd){case"publish":break;case"pubrel":return void w(this,e,t,n);default:return void _(this,e,t)}switch(e.qos){case 2:case 1:w(this,e,t,n);break;default:_(this,e,t)}f("_sendPacket :: (%s) ::  end",this.options.clientId)}},k.prototype._storePacket=function(e,t,n){f("_storePacket :: packet: %o",e),f("_storePacket :: cb? %s",!!t),n=n||S;let r=e;if("publish"===r.cmd){e=v(this,r=c(e));if(e)return t&&t(e)}0===(r.qos||0)&&this.queueQoSZero||"publish"!==r.cmd?this.queue.push({packet:r,cb:t}):0<r.qos?(t=this.outgoing[r.messageId]?this.outgoing[r.messageId].cb:null,this.outgoingStore.put(r,function(e){if(e)return t&&t(e);n()})):t&&t(new Error("No connection to broker"))},k.prototype._setupPingTimer=function(){f("_setupPingTimer :: keepalive %d (seconds)",this.options.keepalive);const e=this;!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=t(function(){e._checkPing()},1e3*this.options.keepalive))},k.prototype._shiftPingInterval=function(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)},k.prototype._checkPing=function(){f("_checkPing :: checking ping..."),this.pingResp?(f("_checkPing :: ping response received. Clearing flag and sending `pingreq`"),this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):(f("_checkPing :: calling _cleanUp with force true"),this._cleanUp(!0))},k.prototype._handlePingresp=function(){this.pingResp=!0},k.prototype._handleConnack=function(e){f("_handleConnack");var t=this.options,n=5===t.protocolVersion?e.reasonCode:e.returnCode;if(clearTimeout(this.connackTimer),delete this.topicAliasSend,e.properties){if(e.properties.topicAliasMaximum){if(65535<e.properties.topicAliasMaximum)return void this.emit("error",new Error("topicAliasMaximum from broker is out of range"));0<e.properties.topicAliasMaximum&&(this.topicAliasSend=new i(e.properties.topicAliasMaximum))}e.properties.serverKeepAlive&&t.keepalive&&(t.keepalive=e.properties.serverKeepAlive,this._shiftPingInterval()),e.properties.maximumPacketSize&&(t.properties||(t.properties={}),t.properties.maximumPacketSize=e.properties.maximumPacketSize)}0===n?(this.reconnecting=!1,this._onConnect(e)):0<n&&((t=new Error("Connection refused: "+b[n])).code=n,this.emit("error",t))},k.prototype._handleAuth=function(e){var t=this.options.protocolVersion;const n=5===t?e.reasonCode:e.returnCode;if(5!==t)(t=new Error("Protocol error: Auth packets are only supported in MQTT 5. Your version:"+t)).code=n,this.emit("error",t);else{const r=this;this.handleAuth(e,function(e,t){e?r.emit("error",e):24===n?(r.reconnecting=!1,r._sendPacket(t)):(t=new Error("Connection refused: "+b[n]),e.code=n,r.emit("error",t))})}},k.prototype.handleAuth=function(e,t){t()},k.prototype._handlePublish=function(n,r){f("_handlePublish: packet %o",n),r=void 0!==r?r:S;let i=n.topic.toString();const s=n.payload;var e=n.qos;const o=n.messageId,a=this;var t=this.options;const l=[0,16,128,131,135,144,145,151,153];if(5===this.options.protocolVersion){let e;if(void 0!==(e=n.properties?n.properties.topicAlias:e))if(0===i.length){if(!(0<e&&e<=65535))return f("_handlePublish :: topic alias out of range. alias: %d",e),void this.emit("error",new Error("Received Topic Alias is out of range"));var u=this.topicAliasRecv.getTopicByAlias(e);if(!u)return f("_handlePublish :: unregistered topic alias. alias: %d",e),void this.emit("error",new Error("Received unregistered Topic Alias"));i=u,f("_handlePublish :: topic complemented by alias. topic: %s - alias: %d",i,e)}else{if(!this.topicAliasRecv.put(i,e))return f("_handlePublish :: topic alias out of range. alias: %d",e),void this.emit("error",new Error("Received Topic Alias is out of range"));f("_handlePublish :: registered topic: %s - alias: %d",i,e)}}switch(f("_handlePublish: qos %d",e),e){case 2:t.customHandleAcks(i,s,n,function(e,t){return e instanceof Error||(t=e,e=null),e?a.emit("error",e):-1===l.indexOf(t)?a.emit("error",new Error("Wrong reason code for pubrec")):void(t?a._sendPacket({cmd:"pubrec",messageId:o,reasonCode:t},r):a.incomingStore.put(n,function(){a._sendPacket({cmd:"pubrec",messageId:o},r)}))});break;case 1:t.customHandleAcks(i,s,n,function(e,t){return e instanceof Error||(t=e,e=null),e?a.emit("error",e):-1===l.indexOf(t)?a.emit("error",new Error("Wrong reason code for puback")):(t||a.emit("message",i,s,n),void a.handleMessage(n,function(e){if(e)return r&&r(e);a._sendPacket({cmd:"puback",messageId:o,reasonCode:t},r)}))});break;case 0:this.emit("message",i,s,n),this.handleMessage(n,r);break;default:f("_handlePublish: unknown QoS. Doing nothing.")}},k.prototype.handleMessage=function(e,t){t()},k.prototype._handleAck=function(t){var n,r=t.messageId,e=t.cmd,i=this.outgoing[r]?this.outgoing[r].cb:null;const s=this;let o;if(i){switch(f("_handleAck :: packet type",e),e){case"pubcomp":case"puback":var a=t.reasonCode;a&&0<a&&16!==a&&((o=new Error("Publish error: "+b[a])).code=a,i(o,t)),delete this.outgoing[r],this.outgoingStore.del(t,i),this.messageIdProvider.deallocate(r),this._invokeStoreProcessingQueue();break;case"pubrec":var a={cmd:"pubrel",qos:2,messageId:r},l=t.reasonCode;l&&0<l&&16!==l?((o=new Error("Publish error: "+b[l])).code=l,i(o,t)):this._sendPacket(a);break;case"suback":delete this.outgoing[r],this.messageIdProvider.deallocate(r);for(let e=0;e<t.granted.length;e++)0!=(128&t.granted[e])&&(n=this.messageIdToTopic[r])&&n.forEach(function(e){delete s._resubscribeTopics[e]});this._invokeStoreProcessingQueue(),i(null,t);break;case"unsuback":delete this.outgoing[r],this.messageIdProvider.deallocate(r),this._invokeStoreProcessingQueue(),i(null);break;default:s.emit("error",new Error("unrecognized packet type"))}this.disconnecting&&0===Object.keys(this.outgoing).length&&this.emit("outgoingEmpty")}else f("_handleAck :: Server sent an ack in error. Ignoring.")},k.prototype._handlePubrel=function(e,n){f("handling pubrel packet"),n=void 0!==n?n:S;var t=e.messageId;const r=this,i={cmd:"pubcomp",messageId:t};r.incomingStore.get(e,function(e,t){e?r._sendPacket(i,n):(r.emit("message",t.topic,t.payload,t),r.handleMessage(t,function(e){if(e)return n(e);r.incomingStore.del(t,S),r._sendPacket(i,n)}))})},k.prototype._handleDisconnect=function(e){this.emit("disconnect",e)},k.prototype._nextId=function(){return this.messageIdProvider.allocate()},k.prototype.getLastMessageId=function(){return this.messageIdProvider.getLastAllocated()},k.prototype._resubscribe=function(){f("_resubscribe");var t=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||5===this.options.protocolVersion&&!this.connackPacket.sessionPresent)&&0<t.length)if(this.options.resubscribe)if(5===this.options.protocolVersion){f("_resubscribe: protocolVersion 5");for(let e=0;e<t.length;e++){var n={};n[t[e]]=this._resubscribeTopics[t[e]],n.resubscribe=!0,this.subscribe(n,{properties:n[t[e]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1},k.prototype._onConnect=function(s){if(this.disconnected)this.emit("connect",s);else{const o=this;this.connackPacket=s,this.messageIdProvider.clear(),this._setupPingTimer(),this.connected=!0,!function n(){let t=o.outgoingStore.createStream();function r(){o._storeProcessing=!1,o._packetIdsDuringStoreProcessing={}}function i(){t.destroy(),t=null,o._flushStoreProcessingQueue(),r()}o.once("close",i),t.on("error",function(e){r(),o._flushStoreProcessingQueue(),o.removeListener("close",i),o.emit("error",e)}),t.on("end",function(){let e=!0;for(const t in o._packetIdsDuringStoreProcessing)if(!o._packetIdsDuringStoreProcessing[t]){e=!1;break}e?(r(),o.removeListener("close",i),o._invokeAllStoreProcessingQueue(),o.emit("connect",s)):n()}),function r(){if(t){o._storeProcessing=!0;var e=t.read(1);let n;e?o._packetIdsDuringStoreProcessing[e.messageId]?r():o.disconnecting||o.reconnectTimer?t.destroy&&t.destroy():(n=o.outgoing[e.messageId]?o.outgoing[e.messageId].cb:null,o.outgoing[e.messageId]={volatile:!1,cb:function(e,t){n&&n(e,t),r()}},o._packetIdsDuringStoreProcessing[e.messageId]=!0,o.messageIdProvider.register(e.messageId)?o._sendPacket(e):f("messageId: %d has already used.",e.messageId)):t.once("readable",r)}}()}()}},k.prototype._invokeStoreProcessingQueue=function(){if(0<this._storeProcessingQueue.length){var e=this._storeProcessingQueue[0];if(e&&e.invoke())return this._storeProcessingQueue.shift(),!0}return!1},k.prototype._invokeAllStoreProcessingQueue=function(){for(;this._invokeStoreProcessingQueue(););},k.prototype._flushStoreProcessingQueue=function(){for(const e of this._storeProcessingQueue)e.cbStorePut&&e.cbStorePut(new Error("Connection closed")),e.callback&&e.callback(new Error("Connection closed"));this._storeProcessingQueue.splice(0)},C.exports=k}.call(this)}.call(this,x("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./default-message-id-provider":7,"./store":8,"./topic-alias-recv":9,"./topic-alias-send":10,"./validations":11,_process:57,debug:18,events:22,inherits:24,"mqtt-packet":47,"readable-stream":76,reinterval:77,"rfdc/default":78,xtend:88}],2:[function(e,t,n){"use strict";const i=e("buffer")["Buffer"],s=e("readable-stream").Transform,o=e("duplexify");let a,l,u,c=!1;t.exports=function(e,t){var n,r;if(t.hostname=t.hostname||t.host,t.hostname)return n="MQIsdp"===t.protocolId&&3===t.protocolVersion?"mqttv3.1":"mqtt",(r=t).hostname||(r.hostname="localhost"),r.path||(r.path="/"),r.wsOptions||(r.wsOptions={}),r=function(e,t){var n="alis"===e.protocol?"wss":"ws";let r=n+"://"+e.hostname+e.path;return e.port&&80!==e.port&&443!==e.port&&(r=n+"://"+e.hostname+":"+e.port+e.path),r="function"==typeof e.transformWsUrl?e.transformWsUrl(r,e,t):r}(t,e),(a=t.my).connectSocket({url:r,protocols:n}),l=((e=new s)._write=function(e,t,n){a.sendSocketMessage({data:e.buffer,success:function(){n()},fail:function(){n(new Error)}})},e._flush=function(e){a.closeSocket({success:function(){e()}})},e),u=o.obj(),c||(c=!0,a.onSocketOpen(function(){u.setReadable(l),u.setWritable(l),u.emit("connect")}),a.onSocketMessage(function(e){if("string"==typeof e.data){var t=i.from(e.data,"base64");l.push(t)}else{const n=new FileReader;n.addEventListener("load",function(){let e=n.result;e=e instanceof ArrayBuffer?i.from(e):i.from(e,"utf8"),l.push(e)}),n.readAsArrayBuffer(e.data)}}),a.onSocketClose(function(){u.end(),u.destroy()}),a.onSocketError(function(e){u.destroy(e)})),u;throw new Error("Could not determine host. Specify host manually.")}},{buffer:17,duplexify:20,"readable-stream":76}],3:[function(e,t,n){"use strict";const r=e("net"),i=e("debug")("mqttjs:tcp");t.exports=function(e,t){t.port=t.port||1883,t.hostname=t.hostname||t.host||"localhost";var n=t.port,t=t.hostname;return i("port %d and host %s",n,t),r.createConnection(n,t)}},{debug:18,net:16}],4:[function(e,t,n){"use strict";const i=e("tls"),s=e("net"),o=e("debug")("mqttjs:tls");t.exports=function(t,n){n.port=n.port||8883,n.host=n.hostname||n.host||"localhost",0===s.isIP(n.host)&&(n.servername=n.host),n.rejectUnauthorized=!1!==n.rejectUnauthorized,delete n.path,o("port %d host %s rejectUnauthorized %b",n.port,n.host,n.rejectUnauthorized);const r=i.connect(n);function e(e){n.rejectUnauthorized&&t.emit("error",e),r.end()}return r.on("secureConnect",function(){n.rejectUnauthorized&&!r.authorized?r.emit("error",new Error("TLS not authorized")):r.removeListener("error",e)}),r.on("error",e),r}},{debug:18,net:16,tls:16}],5:[function(s,a,e){!function(i){!function(){"use strict";const g=s("buffer")["Buffer"],o=s("ws"),m=s("debug")("mqttjs:ws"),y=s("duplexify"),b=s("readable-stream").Transform,e=["rejectUnauthorized","ca","cert","key","pfx","passphrase"],r=void 0!==i&&"browser"===i.title||"function"==typeof __webpack_require__;function v(e,t){let n=e.protocol+"://"+e.hostname+":"+e.port+e.path;return n="function"==typeof e.transformWsUrl?e.transformWsUrl(n,e,t):n}function _(t){const n=t;return t.hostname||(n.hostname="localhost"),t.port||("wss"===t.protocol?n.port=443:n.port=80),t.path||(n.path="/"),t.wsOptions||(n.wsOptions={}),r||"wss"!==t.protocol||e.forEach(function(e){Object.prototype.hasOwnProperty.call(t,e)&&!Object.prototype.hasOwnProperty.call(t.wsOptions,e)&&(n.wsOptions[e]=t[e])}),n}function t(e,t){m("streamBuilder");var n,r,t=_(t),e=v(t,e),i=(n=e,r=t,m("createWebSocket"),m("protocol: "+r.protocolId+" "+r.protocolVersion),i="MQIsdp"===r.protocolId&&3===r.protocolVersion?"mqttv3.1":"mqtt",m("creating new Websocket for url: "+n+" and protocol: "+i),n=new o(n,[i],r.wsOptions));const s=o.createWebSocketStream(i,t.wsOptions);return s.url=e,i.on("close",()=>{s.destroy()}),s}function n(e,t){m("browserStreamBuilder");let n;var r;const i=function(e){if((e=_(e)).hostname||(e.hostname=e.host),!e.hostname){if("undefined"==typeof document)throw new Error("Could not determine host. Specify host manually.");var t=new URL(document.URL);e.hostname=t.hostname,e.port||(e.port=t.port)}return void 0===e.objectMode&&(e.objectMode=!(!0===e.binary||void 0===e.binary)),e}(t).browserBufferSize||524288,s=t.browserBufferTimeout||1e3,o=!t.objectMode,a=(e=e,r="MQIsdp"===(u=t).protocolId&&3===u.protocolVersion?"mqttv3.1":"mqtt",u=v(u,e),(e=new WebSocket(u,[r])).binaryType="arraybuffer",e),l=function(e,t,n){e=new b({objectModeMode:e.objectMode});return e._write=t,e._flush=n,e}(t,function e(t,n,r){a.bufferedAmount>i&&setTimeout(e,s,t,n,r);o&&"string"==typeof t&&(t=g.from(t,"utf8"));try{a.send(t)}catch(e){return r(e)}r()},function(e){a.close(),e()});t.objectMode||(l._writev=p),l.on("close",()=>{a.close()});var u=void 0!==a.addEventListener;function c(){n.setReadable(l),n.setWritable(l),n.emit("connect")}function h(){n.end(),n.destroy()}function d(e){n.destroy(e)}function f(e){let t=e.data;t=t instanceof ArrayBuffer?g.from(t):g.from(t,"utf8"),l.push(t)}function p(t,e){var n=new Array(t.length);for(let e=0;e<t.length;e++)"string"==typeof t[e].chunk?n[e]=g.from(t[e],"utf8"):n[e]=t[e].chunk;this._write(g.concat(n),"binary",e)}return a.readyState===a.OPEN?n=l:(n=n=y(void 0,void 0,t),t.objectMode||(n._writev=p),u?a.addEventListener("open",c):a.onopen=c),n.socket=a,u?(a.addEventListener("close",h),a.addEventListener("error",d),a.addEventListener("message",f)):(a.onclose=h,a.onerror=d,a.onmessage=f),n}r?a.exports=n:a.exports=t}.call(this)}.call(this,s("_process"))},{_process:57,buffer:17,debug:18,duplexify:20,"readable-stream":76,ws:87}],6:[function(e,t,n){"use strict";const s=e("buffer")["Buffer"],o=e("readable-stream").Transform,a=e("duplexify");let l,u,c;t.exports=function(e,t){if(t.hostname=t.hostname||t.host,!t.hostname)throw new Error("Could not determine host. Specify host manually.");var n="MQIsdp"===t.protocolId&&3===t.protocolVersion?"mqttv3.1":"mqtt",r=((r=t).hostname||(r.hostname="localhost"),r.path||(r.path="/"),r.wsOptions||(r.wsOptions={}),function(e,t){var n="wxs"===e.protocol?"wss":"ws";let r=n+"://"+e.hostname+e.path;return e.port&&80!==e.port&&443!==e.port&&(r=n+"://"+e.hostname+":"+e.port+e.path),r="function"==typeof e.transformWsUrl?e.transformWsUrl(r,e,t):r}(t,e));l=wx.connectSocket({url:r,protocols:[n]}),u=((t=new o)._write=function(e,t,n){l.send({data:e.buffer,success:function(){n()},fail:function(e){n(new Error(e))}})},t._flush=function(e){l.close({success:function(){e()}})},t),(c=a.obj())._destroy=function(e,t){l.close({success:function(){t&&t(e)}})};const i=c.destroy;return c.destroy=function(){c.destroy=i;const e=this;setTimeout(function(){l.close({fail:function(){e._destroy(new Error)}})},0)}.bind(c),l.onOpen(function(){c.setReadable(u),c.setWritable(u),c.emit("connect")}),l.onMessage(function(e){let t=e.data;t=t instanceof ArrayBuffer?s.from(t):s.from(t,"utf8"),u.push(t)}),l.onClose(function(){c.end(),c.destroy()}),l.onError(function(e){c.destroy(new Error(e.errMsg))}),c}},{buffer:17,duplexify:20,"readable-stream":76}],7:[function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;this.nextId=Math.max(1,Math.floor(65535*Math.random()))}r.prototype.allocate=function(){var e=this.nextId++;return 65536===this.nextId&&(this.nextId=1),e},r.prototype.getLastAllocated=function(){return 1===this.nextId?65535:this.nextId-1},r.prototype.register=function(e){return!0},r.prototype.deallocate=function(e){},r.prototype.clear=function(){},t.exports=r},{}],8:[function(e,t,n){"use strict";const r=e("xtend"),i=e("readable-stream").Readable,s={objectMode:!0},o={clean:!0};function a(e){if(!(this instanceof a))return new a(e);this.options=e||{},this.options=r(o,e),this._inflights=new Map}a.prototype.put=function(e,t){return this._inflights.set(e.messageId,e),t&&t(),this},a.prototype.createStream=function(){var e=new i(s);const n=[];let t=!1,r=0;return this._inflights.forEach(function(e,t){n.push(e)}),e._read=function(){!t&&r<n.length?this.push(n[r++]):this.push(null)},e.destroy=function(){if(!t){const e=this;t=!0,setTimeout(function(){e.emit("close")},0)}},e},a.prototype.del=function(e,t){return(e=this._inflights.get(e.messageId))?(this._inflights.delete(e.messageId),t(null,e)):t&&t(new Error("missing packet")),this},a.prototype.get=function(e,t){return(e=this._inflights.get(e.messageId))?t(null,e):t&&t(new Error("missing packet")),this},a.prototype.close=function(e){this.options.clean&&(this._inflights=null),e&&e()},t.exports=a},{"readable-stream":76,xtend:88}],9:[function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);this.aliasToTopic={},this.max=e}r.prototype.put=function(e,t){return!(0===t||t>this.max||(this.aliasToTopic[t]=e,this.length=Object.keys(this.aliasToTopic).length,0))},r.prototype.getTopicByAlias=function(e){return this.aliasToTopic[e]},r.prototype.clear=function(){this.aliasToTopic={}},t.exports=r},{}],10:[function(e,t,n){"use strict";const r=e("lru-cache"),i=e("number-allocator").NumberAllocator;function s(e){if(!(this instanceof s))return new s(e);0<e&&(this.aliasToTopic=new r({max:e}),this.topicToAlias={},this.numberAllocator=new i(1,e),this.max=e,this.length=0)}s.prototype.put=function(e,t){var n;return!(0===t||t>this.max||((n=this.aliasToTopic.get(t))&&delete this.topicToAlias[n],this.aliasToTopic.set(t,e),this.topicToAlias[e]=t,this.numberAllocator.use(t),this.length=this.aliasToTopic.length,0))},s.prototype.getTopicByAlias=function(e){return this.aliasToTopic.get(e)},s.prototype.getAliasByTopic=function(e){e=this.topicToAlias[e];return void 0!==e&&this.aliasToTopic.get(e),e},s.prototype.clear=function(){this.aliasToTopic.reset(),this.topicToAlias={},this.numberAllocator.clear(),this.length=0},s.prototype.getLruAlias=function(){var e=this.numberAllocator.firstVacant();return e||this.aliasToTopic.keys()[this.aliasToTopic.length-1]},t.exports=s},{"lru-cache":44,"number-allocator":53}],11:[function(e,t,n){"use strict";t.exports={validateTopics:function(t){if(0===t.length)return"empty_topic_list";for(let e=0;e<t.length;e++)if(!function(e){var t=e.split("/");for(let e=0;e<t.length;e++)if("+"!==t[e]){if("#"===t[e])return e===t.length-1;if(-1!==t[e].indexOf("+")||-1!==t[e].indexOf("#"))return}return 1}(t[e]))return t[e];return null}}},{}],12:[function(r,u,e){!function(n){!function(){"use strict";const i=r("../client");var e=r("../store");const s=r("url"),o=r("xtend"),a=r("debug")("mqttjs"),l={};function t(e,t){if(a("connecting to an MQTT broker..."),"object"!=typeof e||t||(t=e,e=null),t=t||{},e){e=s.parse(e,!0);if(null!=e.port&&(e.port=Number(e.port)),null===(t=o(e,t)).protocol)throw new Error("Missing protocol");t.protocol=t.protocol.replace(/:$/,"")}if((e=t).auth&&((n=e.auth.match(/^(.+):(.+)$/))?(e.username=n[1],e.password=n[2]):e.username=e.auth),t.query&&"string"==typeof t.query.clientId&&(t.clientId=t.query.clientId),t.cert&&t.key){if(!t.protocol)throw new Error("Missing secure protocol key");if(-1===["mqtts","wss","wxs","alis"].indexOf(t.protocol))switch(t.protocol){case"mqtt":t.protocol="mqtts";break;case"ws":t.protocol="wss";break;case"wx":t.protocol="wxs";break;case"ali":t.protocol="alis";break;default:throw new Error('Unknown protocol for secure connection: "'+t.protocol+'"!')}}if(!l[t.protocol]){const r=-1!==["mqtts","wss"].indexOf(t.protocol);t.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter(function(e,t){return(!r||t%2!=0)&&"function"==typeof l[e]})[0]}if(!1===t.clean&&!t.clientId)throw new Error("Missing clientId for unclean clients");t.protocol&&(t.defaultProtocol=t.protocol);var n=new i(function(e){return t.servers&&(e._reconnectCount&&e._reconnectCount!==t.servers.length||(e._reconnectCount=0),t.host=t.servers[e._reconnectCount].host,t.port=t.servers[e._reconnectCount].port,t.protocol=t.servers[e._reconnectCount].protocol||t.defaultProtocol,t.hostname=t.host,e._reconnectCount++),a("calling streambuilder for",t.protocol),l[t.protocol](e,t)},t);return n.on("error",function(){}),n}void 0!==n&&"browser"!==n.title||"function"!=typeof __webpack_require__?(l.mqtt=r("./tcp"),l.tcp=r("./tcp"),l.ssl=r("./tls"),l.tls=r("./tls"),l.mqtts=r("./tls")):(l.wx=r("./wx"),l.wxs=r("./wx"),l.ali=r("./ali"),l.alis=r("./ali")),l.ws=r("./ws"),l.wss=r("./ws"),u.exports=t,u.exports.connect=t,u.exports.MqttClient=i,u.exports.Store=e}.call(this)}.call(this,r("_process"))},{"../client":1,"../store":8,"./ali":2,"./tcp":3,"./tls":4,"./ws":5,"./wx":6,_process:57,debug:18,url:83,xtend:88}],13:[function(e,t,n){"use strict";n.byteLength=function(e){var e=c(e),t=e[0],e=e[1];return 3*(t+e)/4-e},n.toByteArray=function(e){var t,n,r=c(e),i=r[0],r=r[1],s=new u(function(e,t){return 3*(e+t)/4-t}(i,r)),o=0,a=0<r?i-4:i;for(n=0;n<a;n+=4)t=l[e.charCodeAt(n)]<<18|l[e.charCodeAt(n+1)]<<12|l[e.charCodeAt(n+2)]<<6|l[e.charCodeAt(n+3)],s[o++]=t>>16&255,s[o++]=t>>8&255,s[o++]=255&t;2===r&&(t=l[e.charCodeAt(n)]<<2|l[e.charCodeAt(n+1)]>>4,s[o++]=255&t);1===r&&(t=l[e.charCodeAt(n)]<<10|l[e.charCodeAt(n+1)]<<4|l[e.charCodeAt(n+2)]>>2,s[o++]=t>>8&255,s[o++]=255&t);return s},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,i=[],s=0,o=n-r;s<o;s+=16383)i.push(function(e,t,n){for(var r,i=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(function(e){return a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e]}(r));return i.join("")}(e,s,o<s+16383?o:s+16383));1==r?(t=e[n-1],i.push(a[t>>2]+a[t<<4&63]+"==")):2==r&&(t=(e[n-2]<<8)+e[n-1],i.push(a[t>>10]+a[t>>4&63]+a[t<<2&63]+"="));return i.join("")};for(var a=[],l=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,s=r.length;i<s;++i)a[i]=r[i],l[r.charCodeAt(i)]=i;function c(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("="),t=(e=-1===e?t:e)===t?0:4-e%4;return[e,t]}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},{}],14:[function(e,t,n){"use strict";const h=e("buffer")["Buffer"],r=Symbol.for("BufferList");function i(e){if(!(this instanceof i))return new i(e);i._init.call(this,e)}i._init=function(e){Object.defineProperty(this,r,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)},i.prototype._new=function(e){return new i(e)},i.prototype._offset=function(t){if(0===t)return[0,0];let n=0;for(let e=0;e<this._bufs.length;e++){var r=n+this._bufs[e].length;if(t<r||e===this._bufs.length-1)return[e,t-n];n=r}},i.prototype._reverseOffset=function(e){var t=e[0];let n=e[1];for(let e=0;e<t;e++)n+=this._bufs[e].length;return n},i.prototype.get=function(e){if(!(e>this.length||e<0))return e=this._offset(e),this._bufs[e[0]][e[1]]},i.prototype.slice=function(e,t){return"number"==typeof e&&e<0&&(e+=this.length),"number"==typeof t&&t<0&&(t+=this.length),this.copy(null,0,e,t)},i.prototype.copy=function(t,e,n,r){if(("number"!=typeof r||r>this.length)&&(r=this.length),(n="number"!=typeof n||n<0?0:n)>=this.length)return t||h.alloc(0);if(r<=0)return t||h.alloc(0);var i=!!t,s=this._offset(n),o=r-n;let a=o,l=i&&e||0,u=s[1];if(0===n&&r===this.length){if(!i)return 1===this._bufs.length?this._bufs[0]:h.concat(this._bufs,this.length);for(let e=0;e<this._bufs.length;e++)this._bufs[e].copy(t,l),l+=this._bufs[e].length;return t}if(a<=this._bufs[s[0]].length-u)return i?this._bufs[s[0]].copy(t,e,u,u+a):this._bufs[s[0]].slice(u,u+a);i||(t=h.allocUnsafe(o));for(let e=s[0];e<this._bufs.length;e++){var c=this._bufs[e].length-u;if(!(a>c)){this._bufs[e].copy(t,l,u,u+a),l+=c;break}this._bufs[e].copy(t,l,u),l+=c,a-=c,u=u&&0}return t.length>l?t.slice(0,l):t},i.prototype.shallowSlice=function(e,t){var n;return t="number"!=typeof t?this.length:t,(e=e||0)<0&&(e+=this.length),t<0&&(t+=this.length),e===t?this._new():(e=this._offset(e),t=this._offset(t),n=this._bufs.slice(e[0],t[0]+1),0===t[1]?n.pop():n[n.length-1]=n[n.length-1].slice(0,t[1]),0!==e[1]&&(n[0]=n[0].slice(e[1])),this._new(n))},i.prototype.toString=function(e,t,n){return this.slice(t,n).toString(e)},i.prototype.consume=function(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0))for(;this._bufs.length;){if(!(e>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},i.prototype.duplicate=function(){var t=this._new();for(let e=0;e<this._bufs.length;e++)t.append(this._bufs[e]);return t},i.prototype.append=function(t){if(null!=t)if(t.buffer)this._appendBuffer(h.from(t.buffer,t.byteOffset,t.byteLength));else if(Array.isArray(t))for(let e=0;e<t.length;e++)this.append(t[e]);else if(this._isBufferList(t))for(let e=0;e<t._bufs.length;e++)this.append(t._bufs[e]);else"number"==typeof t&&(t=t.toString()),this._appendBuffer(h.from(t));return this},i.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length},i.prototype.indexOf=function(e,t,n){if(void 0===n&&"string"==typeof t&&(n=t,t=void 0),"function"==typeof e||Array.isArray(e))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"==typeof e?e=h.from([e]):"string"==typeof e?e=h.from(e,n):this._isBufferList(e)?e=e.slice():Array.isArray(e.buffer)?e=h.from(e.buffer,e.byteOffset,e.byteLength):h.isBuffer(e)||(e=h.from(e)),t=Number(t||0),(t=(t=isNaN(t)?0:t)<0?this.length+t:t)<0&&(t=0),0===e.length)return t>this.length?this.length:t;n=this._offset(t);let r=n[0],i=n[1];for(;r<this._bufs.length;r++){for(var s=this._bufs[r];i<s.length;)if(s.length-i>=e.length){var o=s.indexOf(e,i);if(-1!==o)return this._reverseOffset([r,o]);i=s.length-e.length+1}else{o=this._reverseOffset([r,i]);if(this._match(o,e))return o;i++}i=0}return-1},i.prototype._match=function(t,n){if(this.length-t<n.length)return!1;for(let e=0;e<n.length;e++)if(this.get(t+e)!==n[e])return!1;return!0};{const s={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const o in s)!function(n){null===s[n]?i.prototype[n]=function(e,t){return this.slice(e,e+t)[n](0,t)}:i.prototype[n]=function(e=0){return this.slice(e,e+s[n])[n](0)}}(o)}i.prototype._isBufferList=function(e){return e instanceof i||i.isBufferList(e)},i.isBufferList=function(e){return null!=e&&e[r]},t.exports=i},{buffer:17}],15:[function(e,t,n){"use strict";const r=e("readable-stream").Duplex;var i=e("inherits");const s=e("./BufferList");function o(e){if(!(this instanceof o))return new o(e);if("function"==typeof e){this._callback=e;const t=function(e){this._callback&&(this._callback(e),this._callback=null)}.bind(this);this.on("pipe",function(e){e.on("error",t)}),this.on("unpipe",function(e){e.removeListener("error",t)}),e=null}s._init.call(this,e),r.call(this)}i(o,r),Object.assign(o.prototype,s.prototype),o.prototype._new=function(e){return new o(e)},o.prototype._write=function(e,t,n){this._appendBuffer(e),"function"==typeof n&&n()},o.prototype._read=function(e){if(!this.length)return this.push(null);e=Math.min(e,this.length),this.push(this.slice(0,e)),this.consume(e)},o.prototype.end=function(e){r.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},o.prototype._destroy=function(e,t){this._bufs.length=0,this.length=0,t(e)},o.prototype._isBufferList=function(e){return e instanceof o||e instanceof s||o.isBufferList(e)},o.isBufferList=s.isBufferList,t.exports=o,t.exports.BufferListStream=o,t.exports.BufferList=s},{"./BufferList":14,inherits:24,"readable-stream":76}],16:[function(e,t,n){},{}],17:[function(B,e,O){!function(e){!function(){"use strict";var E=B("base64-js"),s=B("ieee754"),t=(O.Buffer=h,O.SlowBuffer=function(e){+e!=e&&(e=0);return h.alloc(+e)},O.INSPECT_MAX_BYTES=50,2147483647);function l(e){if(t<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return e.__proto__=h.prototype,e}function h(e,t,n){if("number"!=typeof e)return r(e,t,n);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return o(e)}function r(e,t,n){if("string"==typeof e){var r=e,i=t;if(h.isEncoding(i="string"==typeof i&&""!==i?i:"utf8"))return s=0|d(r,i),o=l(s),o=(r=o.write(r,i))!==s?o.slice(0,r):o;throw new TypeError("Unknown encoding: "+i)}if(ArrayBuffer.isView(e))return u(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(A(e,ArrayBuffer)||e&&A(e.buffer,ArrayBuffer)){var s=e,r=t,o=n;if(r<0||s.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(s.byteLength<r+(o||0))throw new RangeError('"length" is outside of buffer bounds');return(s=void 0===r&&void 0===o?new Uint8Array(s):void 0===o?new Uint8Array(s,r):new Uint8Array(s,r,o)).__proto__=h.prototype,s}if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return h.from(i,t,n);var a=function(e){{var t,n;if(h.isBuffer(e))return t=0|c(e.length),0!==(n=l(t)).length&&e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||P(e.length)?l(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return h.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function i(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function o(e){return i(e),l(e<0?0:0|c(e))}function u(e){for(var t=e.length<0?0:0|c(e.length),n=l(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function c(e){if(t<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+t.toString(16)+" bytes");return 0|e}function d(e,t){if(h.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||A(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return C(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return I(e).length;default:if(i)return r?-1:C(e).length;t=(""+t).toLowerCase(),i=!0}}function n(e,t,n){var r,i=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":var s=this,o=t,a=n,l=s.length;(!a||a<0||l<a)&&(a=l);for(var u="",c=o=!o||o<0?0:o;c<a;++c)u+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(s[c]);return u;case"utf8":case"utf-8":return x(this,t,n);case"ascii":var h=this,l=t,d=n,f="";d=Math.min(h.length,d);for(var p=l;p<d;++p)f+=String.fromCharCode(127&h[p]);return f;case"latin1":case"binary":var g=this,o=t,m=n,y="";m=Math.min(g.length,m);for(var b=o;b<m;++b)y+=String.fromCharCode(g[b]);return y;case"base64":return v=this,r=n,0===(_=t)&&r===v.length?E.fromByteArray(v):E.fromByteArray(v.slice(_,r));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var v=t,_=n,w=this.slice(v,_),S="",k=0;k<w.length;k+=2)S+=String.fromCharCode(w[k]+256*w[k+1]);return S;default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function a(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function f(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),(n=(n=P(n=+n)?i?0:e.length-1:n)<0?e.length+n:n)>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=h.from(t,r)),h.isBuffer(t))return 0===t.length?-1:p(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,n):p(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function p(e,t,n,r,i){var s=1,o=e.length,a=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o/=s=2,a/=2,n/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i)for(var u=-1,c=n;c<o;c++)if(l(e,c)===l(t,-1===u?0:c-u)){if(c-(u=-1===u?c:u)+1===a)return u*s}else-1!==u&&(c-=c-u),u=-1;else for(c=n=o<n+a?o-a:n;0<=c;c--){for(var h=!0,d=0;d<a;d++)if(l(e,c+d)!==l(t,d)){h=!1;break}if(h)return c}return-1}function m(e,t,n,r){return T(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function y(e,t,n,r){return T(function(e,t){for(var n,r,i=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i.push(n%256),i.push(r);return i}(t,e.length-n),e,n,r)}function x(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var s,o,a,l,u=e[i],c=null,h=239<u?4:223<u?3:191<u?2:1;if(i+h<=n)switch(h){case 1:u<128&&(c=u);break;case 2:128==(192&(s=e[i+1]))&&127<(l=(31&u)<<6|63&s)&&(c=l);break;case 3:s=e[i+1],o=e[i+2],128==(192&s)&&128==(192&o)&&2047<(l=(15&u)<<12|(63&s)<<6|63&o)&&(l<55296||57343<l)&&(c=l);break;case 4:s=e[i+1],o=e[i+2],a=e[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&65535<(l=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)&&l<1114112&&(c=l)}null===c?(c=65533,h=1):65535<c&&(r.push((c-=65536)>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=h}var d=r,f=d.length;if(f<=b)return String.fromCharCode.apply(String,d);for(var p="",g=0;g<f;)p+=String.fromCharCode.apply(String,d.slice(g,g+=b));return p}O.kMaxLength=t,(h.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),h.poolSize=8192,h.from=r,h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,h.alloc=function(e,t,n){return t=t,n=n,i(e=e),!(e<=0)&&void 0!==t?"string"==typeof n?l(e).fill(t,n):l(e).fill(t):l(e)},h.allocUnsafe=o,h.allocUnsafeSlow=o,h.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==h.prototype},h.compare=function(e,t){if(A(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),A(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),!h.isBuffer(e)||!h.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return h.alloc(0);if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;for(var n=h.allocUnsafe(t),r=0,i=0;i<e.length;++i){var s=e[i];if(A(s,Uint8Array)&&(s=h.from(s)),!h.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r),r+=s.length}return n},h.byteLength=d,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)a(this,t,t+1);return this},h.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)a(this,t,t+3),a(this,t+1,t+2);return this},h.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)a(this,t,t+7),a(this,t+1,t+6),a(this,t+2,t+5),a(this,t+3,t+4);return this},h.prototype.toLocaleString=h.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?x(this,0,e):n.apply(this,arguments)},h.prototype.equals=function(e){if(h.isBuffer(e))return this===e||0===h.compare(this,e);throw new TypeError("Argument must be a Buffer")},h.prototype.inspect=function(){var e="",t=O.INSPECT_MAX_BYTES,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},h.prototype.compare=function(e,t,n,r,i){if(A(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),!h.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),(t=void 0===t?0:t)<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=t)return 0;if(i<=r)return-1;if(n<=t)return 1;if(this===e)return 0;for(var s=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),a=Math.min(s,o),l=this.slice(r,i),u=e.slice(t,n),c=0;c<a;++c)if(l[c]!==u[c]){s=l[c],o=u[c];break}return s<o?-1:o<s?1:0},h.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},h.prototype.indexOf=function(e,t,n){return f(this,e,t,n,!0)},h.prototype.lastIndexOf=function(e,t,n){return f(this,e,t,n,!1)},h.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||i<n)&&(n=i),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var s,o,a,l=!1;;)switch(r){case"hex":var u=this,c=e,h=t,d=n,f=(h=Number(h)||0,u.length-h);(!d||f<(d=Number(d)))&&(d=f),(f=c.length)/2<d&&(d=f/2);for(var p=0;p<d;++p){var g=parseInt(c.substr(2*p,2),16);if(P(g))return p;u[h+p]=g}return p;case"utf8":case"utf-8":return f=t,a=n,T(C(e,(o=this).length-f),o,f,a);case"ascii":return m(this,e,t,n);case"latin1":case"binary":return m(this,e,t,n);case"base64":return o=this,a=t,s=n,T(I(e),o,a,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,e,t,n);default:if(l)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),l=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var b=4096;function g(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function v(e,t,n,r,i,s){if(!h.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<s)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function _(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function w(e,t,n,r,i){return t=+t,n>>>=0,i||_(e,0,n,4),s.write(e,t,n,r,23,4),n+4}function S(e,t,n,r,i){return t=+t,n>>>=0,i||_(e,0,n,8),s.write(e,t,n,r,52,8),n+8}h.prototype.slice=function(e,t){var n=this.length,n=((e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e),this.subarray(e,t));return n.__proto__=h.prototype,n},h.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||g(e,t,this.length);for(var r=this[e],i=1,s=0;++s<t&&(i*=256);)r+=this[e+s]*i;return r},h.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||g(e,t,this.length);for(var r=this[e+--t],i=1;0<t&&(i*=256);)r+=this[e+--t]*i;return r},h.prototype.readUInt8=function(e,t){return e>>>=0,t||g(e,1,this.length),this[e]},h.prototype.readUInt16LE=function(e,t){return e>>>=0,t||g(e,2,this.length),this[e]|this[e+1]<<8},h.prototype.readUInt16BE=function(e,t){return e>>>=0,t||g(e,2,this.length),this[e]<<8|this[e+1]},h.prototype.readUInt32LE=function(e,t){return e>>>=0,t||g(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},h.prototype.readUInt32BE=function(e,t){return e>>>=0,t||g(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},h.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||g(e,t,this.length);for(var r=this[e],i=1,s=0;++s<t&&(i*=256);)r+=this[e+s]*i;return(i*=128)<=r&&(r-=Math.pow(2,8*t)),r},h.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||g(e,t,this.length);for(var r=t,i=1,s=this[e+--r];0<r&&(i*=256);)s+=this[e+--r]*i;return(i*=128)<=s&&(s-=Math.pow(2,8*t)),s},h.prototype.readInt8=function(e,t){return e>>>=0,t||g(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},h.prototype.readInt16LE=function(e,t){e>>>=0,t||g(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},h.prototype.readInt16BE=function(e,t){e>>>=0,t||g(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},h.prototype.readInt32LE=function(e,t){return e>>>=0,t||g(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},h.prototype.readInt32BE=function(e,t){return e>>>=0,t||g(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},h.prototype.readFloatLE=function(e,t){return e>>>=0,t||g(e,4,this.length),s.read(this,e,!0,23,4)},h.prototype.readFloatBE=function(e,t){return e>>>=0,t||g(e,4,this.length),s.read(this,e,!1,23,4)},h.prototype.readDoubleLE=function(e,t){return e>>>=0,t||g(e,8,this.length),s.read(this,e,!0,52,8)},h.prototype.readDoubleBE=function(e,t){return e>>>=0,t||g(e,8,this.length),s.read(this,e,!1,52,8)},h.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||v(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},h.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||v(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,s=1;for(this[t+i]=255&e;0<=--i&&(s*=256);)this[t+i]=e/s&255;return t+n},h.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,1,255,0),this[t]=255&e,t+1},h.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},h.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeIntLE=function(e,t,n,r){e=+e,t>>>=0,r||v(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var i=0,s=1,o=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+n},h.prototype.writeIntBE=function(e,t,n,r){e=+e,t>>>=0,r||v(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var i=n-1,s=1,o=0;for(this[t+i]=255&e;0<=--i&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+n},h.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},h.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},h.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeFloatLE=function(e,t,n){return w(this,e,t,!0,n)},h.prototype.writeFloatBE=function(e,t,n){return w(this,e,t,!1,n)},h.prototype.writeDoubleLE=function(e,t,n){return S(this,e,t,!0,n)},h.prototype.writeDoubleBE=function(e,t,n){return S(this,e,t,!1,n)},h.prototype.copy=function(e,t,n,r){if(!h.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),(r=0<r&&r<n?n:r)===n)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length);var i=(r=e.length-t<r-n?e.length-t+n:r)-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var s=i-1;0<=s;--s)e[s+t]=this[s+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return i},h.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!h.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var i;1===e.length&&(i=e.charCodeAt(0),"utf8"===r&&i<128||"latin1"===r)&&(e=i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");var s;if(!(n<=t))if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(s=t;s<n;++s)this[s]=e;else{var o=h.isBuffer(e)?e:h.from(e,r),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=o[s%a]}return this};var k=/[^+/0-9A-Za-z-_]/g;function C(e,t){t=t||1/0;for(var n,r=e.length,i=null,s=[],o=0;o<r;++o){if(55295<(n=e.charCodeAt(o))&&n<57344){if(!i){if(56319<n){-1<(t-=3)&&s.push(239,191,189);continue}if(o+1===r){-1<(t-=3)&&s.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(t-=3)&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(t-=3)&&s.push(239,191,189);if(i=null,n<128){if(--t<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function I(e){return E.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(k,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function T(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function A(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function P(e){return e!=e}}.call(this)}.call(this,B("buffer").Buffer)},{"base64-js":13,buffer:17,ieee754:23}],18:[function(n,i,r){!function(t){!function(){r.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),this.useColors){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");let t=0,n=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(t++,"%c"===e)&&(n=t)}),e.splice(n,0,r)}},r.save=function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(e){}},r.load=function(){let e;try{e=r.storage.getItem("debug")}catch(e){}!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG);return e},r.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},r.storage=function(){try{return localStorage}catch(e){}}(),r.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.log=console.debug||console.log||(()=>{}),i.exports=n("./common")(r);var e=i.exports["formatters"];e.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}.call(this)}.call(this,n("_process"))},{"./common":19,_process:57}],19:[function(e,t,n){t.exports=function(t){function a(e){let n,t=null,r,i;function o(...i){if(o.enabled){const s=o;var e=Number(new Date),t=e-(n||e);s.diff=t,s.prev=n,s.curr=e,n=e,i[0]=a.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");let r=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(e,t)=>{if("%%"===e)return"%";r++;var n,t=a.formatters[t];return"function"==typeof t&&(n=i[r],e=t.call(s,n),i.splice(r,1),r--),e}),a.formatArgs.call(s,i),(s.log||a.log).apply(s,i)}}return o.namespace=e,o.useColors=a.useColors(),o.color=a.selectColor(e),o.extend=s,o.destroy=a.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==t?t:(r!==a.namespaces&&(r=a.namespaces,i=a.enabled(e)),i),set:e=>{t=e}}),"function"==typeof a.init&&a.init(o),o}function s(e,t){t=a(this.namespace+(void 0===t?":":t)+e);return t.log=this.log,t}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return((a.debug=a).default=a).coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},a.disable=function(){var e=[...a.names.map(n),...a.skips.map(n).map(e=>"-"+e)].join(",");return a.enable(""),e},a.enable=function(e){a.save(e),a.namespaces=e,a.names=[],a.skips=[];let t;var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?a.skips.push(new RegExp("^"+e.slice(1)+"$")):a.names.push(new RegExp("^"+e+"$")))},a.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=a.skips.length;t<n;t++)if(a.skips[t].test(e))return!1;for(t=0,n=a.names.length;t<n;t++)if(a.names[t].test(e))return!0;return!1},a.humanize=e("ms"),a.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(e=>{a[e]=t[e]}),a.names=[],a.skips=[],a.formatters={},a.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return a.colors[Math.abs(n)%a.colors.length]},a.enable(a.load()),a}},{ms:52}],20:[function(h,d,e){!function(c,n){!function(){function i(e,t){e._corked?e.once("uncork",t):t()}function s(n,r){return function(e){var t;e?(t=n,e="premature close"===e.message?null:e,t._autoDestroy&&t.destroy(e)):r&&!n._ended&&n.end()}}function r(){}function o(e,t,n){if(!(this instanceof o))return new o(e,t,n);a.Duplex.call(this,n),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!n||!1!==n.autoDestroy,this._forwardDestroy=!n||!1!==n.destroy,this._forwardEnd=!n||!1!==n.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,e&&this.setWritable(e),t&&this.setReadable(t)}var a=h("readable-stream"),l=h("end-of-stream"),e=h("inherits"),t=h("stream-shift"),u=n.from&&n.from!==Uint8Array.from?n.from([0]):new n([0]);e(o,a.Duplex),o.obj=function(e,t,n){return(n=n||{}).objectMode=!0,n.highWaterMark=16,new o(e,t,n)},o.prototype.cork=function(){1==++this._corked&&this.emit("cork")},o.prototype.uncork=function(){this._corked&&0==--this._corked&&this.emit("uncork")},o.prototype.setWritable=function(e){var t,n,r;this._unwrite&&this._unwrite(),this.destroyed?e&&e.destroy&&e.destroy():null===e||!1===e?this.end():(n=l(e,{writable:!0,readable:!1},s(t=this,this._forwardEnd)),r=function(){var e=t._ondrain;t._ondrain=null,e&&e()},this._unwrite&&c.nextTick(r),this._writable=e,this._writable.on("drain",r),this._unwrite=function(){t._writable.removeListener("drain",r),n()},this.uncork())},o.prototype.setReadable=function(e){var t,n,r,i;this._unread&&this._unread(),this.destroyed?e&&e.destroy&&e.destroy():null===e||!1===e?(this.push(null),this.resume()):(n=l(e,{writable:!1,readable:!0},s(t=this)),r=function(){t._forward()},i=function(){t.push(null)},this._drained=!0,this._readable=e,this._readable2=e._readableState?e:(e=e,new a.Readable({objectMode:!0,highWaterMark:16}).wrap(e)),this._readable2.on("readable",r),this._readable2.on("end",i),this._unread=function(){t._readable2.removeListener("readable",r),t._readable2.removeListener("end",i),n()},this._forward())},o.prototype._read=function(){this._drained=!0,this._forward()},o.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var e;for(this._forwarding=!0;this._drained&&null!==(e=t(this._readable2));)this.destroyed||(this._drained=this.push(e));this._forwarding=!1}},o.prototype.destroy=function(e,t){if(t=t||r,this.destroyed)return t(null);this.destroyed=!0;var n=this;c.nextTick(function(){n._destroy(e),t(null)})},o.prototype._destroy=function(e){var t;e&&(t=this._ondrain,this._ondrain=null,t?t(e):this.emit("error",e)),this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable)&&this._writable.destroy&&this._writable.destroy(),this.emit("close")},o.prototype._write=function(e,t,n){if(!this.destroyed)return this._corked?i(this,this._write.bind(this,e,t,n)):e===u?this._finish(n):this._writable?void(!1===this._writable.write(e)?this._ondrain=n:this.destroyed||n()):n()},o.prototype._finish=function(n){var r=this;this.emit("preend"),i(this,function(){var e,t;e=r._forwardEnd&&r._writable,t=function(){!1===r._writableState.prefinished&&(r._writableState.prefinished=!0),r.emit("prefinish"),i(r,n)},!e||e._writableState&&e._writableState.finished?t():e._writableState?e.end(t):(e.end(),t())})},o.prototype.end=function(e,t,n){return"function"==typeof e?this.end(null,null,e):"function"==typeof t?this.end(e,null,t):(this._ended=!0,e&&this.write(e),this._writableState.ending||this._writableState.destroyed||this.write(u),a.Writable.prototype.end.call(this,n))},d.exports=o}.call(this)}.call(this,h("_process"),h("buffer").Buffer)},{_process:57,buffer:17,"end-of-stream":21,inherits:24,"readable-stream":76,"stream-shift":81}],21:[function(e,t,n){!function(_){!function(){function y(){}function b(t,e,n){if("function"==typeof e)return b(t,null,e);function r(){t.writable||i()}function i(){g=!1,p||n.call(t)}function s(){p=!1,g||n.call(t)}function o(e){n.call(t,e?new Error("exited with error code: "+e):null)}function a(e){n.call(t,e)}function l(){_.nextTick(u)}function u(){return m||(!p||f&&f.ended&&!f.destroyed)&&(!g||d&&d.ended&&!d.destroyed)?void 0:n.call(t,new Error("premature close"))}function c(){t.req.on("finish",i)}e=e||{},n=v(n||y);var h,d=t._writableState,f=t._readableState,p=e.readable||!1!==e.readable&&t.readable,g=e.writable||!1!==e.writable&&t.writable,m=!1;return(h=t).setHeader&&"function"==typeof h.abort?(t.on("complete",i),t.on("abort",l),t.req?c():t.on("request",c)):g&&!d&&(t.on("end",r),t.on("close",r)),(h=t).stdio&&Array.isArray(h.stdio)&&3===h.stdio.length&&t.on("exit",o),t.on("end",s),t.on("finish",i),!1!==e.error&&t.on("error",a),t.on("close",l),function(){m=!0,t.removeListener("complete",i),t.removeListener("abort",l),t.removeListener("request",c),t.req&&t.req.removeListener("finish",i),t.removeListener("end",r),t.removeListener("close",r),t.removeListener("finish",i),t.removeListener("exit",o),t.removeListener("end",s),t.removeListener("error",a),t.removeListener("close",l)}}var v=e("once");t.exports=b}.call(this)}.call(this,e("_process"))},{_process:57,once:55}],22:[function(e,t,n){var h=Object.create||function(e){function t(){}return t.prototype=e,new t},o=Object.keys||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return t},r=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function i(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=h(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}((t.exports=i).EventEmitter=i).prototype._events=void 0,i.prototype._maxListeners=void 0;var s,a=10;try{var l={};Object.defineProperty&&Object.defineProperty(l,"x",{value:0}),s=0===l.x}catch(e){s=!1}function u(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function c(e,t,n,r){var i,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');return(i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener||n),i=e._events),s=i[t]):(i=e._events=h(null),e._eventsCount=0),s?("function"==typeof s?s=i[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),s.warned||(r=u(e))&&0<r&&s.length>r&&(s.warned=!0,(r=new Error("Possible EventEmitter memory leak detected. "+s.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.')).name="MaxListenersExceededWarning",r.emitter=e,r.type=t,r.count=s.length,"object"==typeof console)&&console.warn&&console.warn("%s: %s",r.name,r.message)):(s=i[t]=n,++e._eventsCount),e}function d(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function f(e,t,n){e={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},t=r.call(d,e);return t.listener=n,e.wrapFn=t}function p(e,t,n){e=e._events;if(!e)return[];e=e[t];if(!e)return[];if("function"==typeof e)return n?[e.listener||e]:[e];if(n){for(var r=e,i=new Array(r.length),s=0;s<i.length;++s)i[s]=r[s].listener||r[s];return i}return $(e,e.length)}function g(e){var t=this._events;if(t){t=t[e];if("function"==typeof t)return 1;if(t)return t.length}return 0}function $(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}s?Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');a=e}}):i.defaultMaxListeners=a,i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return u(this)},i.prototype.emit=function(e){var t,n,r,i,s="error"===e,o=this._events;if(o)s=s&&null==o.error;else if(!s)return!1;if(s)throw(t=1<arguments.length?arguments[1]:t)instanceof Error?t:((s=new Error('Unhandled "error" event. ('+t+")")).context=t,s);if(!(n=o[e]))return!1;var a,l="function"==typeof n;switch(a=arguments.length){case 1:var u=n,c=l,h=this;if(c)u.call(h);else for(var d=u.length,N=$(u,d),f=0;f<d;++f)N[f].call(h);break;case 2:var c=n,u=l,p=this,g=arguments[1];if(u)c.call(p,g);else for(var m=c.length,L=$(c,m),y=0;y<m;++y)L[y].call(p,g);break;case 3:var b=n,v=l,_=this,w=arguments[1],S=arguments[2];if(v)b.call(_,w,S);else for(var k=b.length,j=$(b,k),E=0;E<k;++E)j[E].call(_,w,S);break;case 4:var v=n,b=l,x=this,C=arguments[1],I=arguments[2],T=arguments[3];if(b)v.call(x,C,I,T);else for(var A=v.length,D=$(v,A),P=0;P<A;++P)D[P].call(x,C,I,T);break;default:for(r=new Array(a-1),i=1;i<a;i++)r[i-1]=arguments[i];var B=n,U=l,O=this,R=r;if(U)B.apply(O,R);else for(var q=B.length,F=$(B,q),M=0;M<q;++M)F[M].apply(O,R)}return!0},i.prototype.on=i.prototype.addListener=function(e,t){return c(this,e,t,!1)},i.prototype.prependListener=function(e,t){return c(this,e,t,!0)},i.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,f(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,f(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,r,i,s,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if((r=this._events)&&(n=r[e]))if(n===t||n.listener===t)0==--this._eventsCount?this._events=h(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;0<=s;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;if(0===i)n.shift();else{for(var a=n,l=i,u=l+1,c=a.length;u<c;l+=1,u+=1)a[l]=a[u];a.pop()}1===n.length&&(r[e]=n[0]),r.removeListener&&this.emit("removeListener",e,o||t)}return this},i.prototype.removeAllListeners=function(e){var t,n=this._events;if(n)if(n.removeListener){if(0===arguments.length){for(var r,i=o(n),s=0;s<i.length;++s)"removeListener"!==(r=i[s])&&this.removeAllListeners(r);this.removeAllListeners("removeListener"),this._events=h(null),this._eventsCount=0}else if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(s=t.length-1;0<=s;s--)this.removeListener(e,t[s])}else 0===arguments.length?(this._events=h(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=h(null):delete n[e]);return this},i.prototype.listeners=function(e){return p(this,e,!0)},i.prototype.rawListeners=function(e){return p(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},i.prototype.listenerCount=g,i.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],23:[function(e,t,n){n.read=function(e,t,n,r,i){var s,o,a=8*i-r-1,l=(1<<a)-1,u=l>>1,c=-7,h=n?i-1:0,d=n?-1:1,i=e[t+h];for(h+=d,s=i&(1<<-c)-1,i>>=-c,c+=a;0<c;s=256*s+e[t+h],h+=d,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=r;0<c;o=256*o+e[t+h],h+=d,c-=8);if(0===s)s=1-u;else{if(s===l)return o?NaN:1/0*(i?-1:1);o+=Math.pow(2,r),s-=u}return(i?-1:1)*o*Math.pow(2,s-r)},n.write=function(e,t,n,r,i,s){var o,a,l=8*s-i-1,u=(1<<l)-1,c=u>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:s-1,f=r?1:-1,s=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-o))<1&&(o--,r*=2),2<=(t+=1<=o+c?h/r:h*Math.pow(2,1-c))*r&&(o++,r/=2),u<=o+c?(a=0,o=u):1<=o+c?(a=(t*r-1)*Math.pow(2,i),o+=c):(a=t*Math.pow(2,c-1)*Math.pow(2,i),o=0));8<=i;e[n+d]=255&a,d+=f,a/=256,i-=8);for(o=o<<i|a,l+=i;0<l;e[n+d]=255&o,d+=f,o/=256,l-=8);e[n+d-f]|=128*s}},{}],24:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){var n;t&&(e.super_=t,(n=function(){}).prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e)}},{}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Container=n.Base=n.ContainerIterator=void 0;class r{constructor(e=r.NORMAL){this.iteratorType=e}}(n.ContainerIterator=r).NORMAL=!1,r.REVERSE=!0;class i{constructor(){this.length=0}size(){return this.length}empty(){return 0===this.length}}n.Base=i;n.Container=class extends i{}},{}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends e("../../ContainerBase/index").Base{constructor(e=16,t=e=>{let t,n=0;var r=(t="string"!=typeof e?JSON.stringify(e):e).length;for(let e=0;e<r;e++){var i=t.charCodeAt(e);n=(n<<5)-n+i,n|=0}return n>>>0}){if(super(),e<16||0!=(e&e-1))throw new RangeError("InitBucketNum range error");this.bucketNum=this.initBucketNum=e,this.hashFunc=t}clear(){this.length=0,this.bucketNum=this.initBucketNum,this.hashTable=[]}}r.sigma=.75,r.treeifyThreshold=8,r.untreeifyThreshold=6,r.minTreeifySize=64,r.maxBucketNum=1<<30,n.default=r},{"../../ContainerBase/index":25}],27:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const c=r(e("./Base/index")),h=r(e("../SequentialContainer/Vector")),d=r(e("../TreeContainer/OrderedMap"));class o extends c.default{constructor(e=[],t,n){super(t,n),this.hashTable=[],e.forEach(e=>this.setElement(e[0],e[1]))}reAllocate(){if(!(this.bucketNum>=c.default.maxBucketNum)){var t=[];const a=this.bucketNum;this.bucketNum<<=1;var n=Object.keys(this.hashTable),r=n.length;for(let e=0;e<r;++e){var i=parseInt(n[e]),s=this.hashTable[i],o=s.size();if(0!==o)if(1===o){o=s.front();t[this.hashFunc(o[0])&this.bucketNum-1]=new h.default([o],!1)}else{const l=[],u=[];s.forEach(e=>{(0==(this.hashFunc(e[0])&a)?l:u).push(e)}),s instanceof d.default?(l.length>c.default.untreeifyThreshold?t[i]=new d.default(l):l.length&&(t[i]=new h.default(l,!1)),u.length>c.default.untreeifyThreshold?t[i+a]=new d.default(u):u.length&&(t[i+a]=new h.default(u,!1))):(l.length>=c.default.treeifyThreshold?t[i]=new d.default(l):l.length&&(t[i]=new h.default(l,!1)),u.length>=c.default.treeifyThreshold?t[i+a]=new d.default(u):u.length&&(t[i+a]=new h.default(u,!1)))}}this.hashTable=t}}forEach(t){var n=Object.values(this.hashTable),r=n.length;let i=0;for(let e=0;e<r;++e)n[e].forEach(e=>t(e,i++))}setElement(e,t){var n=this.hashFunc(e)&this.bucketNum-1,r=this.hashTable[n];if(r){var i=r.size();if(r instanceof h.default){for(const s of r)if(s[0]===e)return void(s[1]=t);if(r.pushBack([e,t]),i+1>=o.treeifyThreshold){if(this.bucketNum<=o.minTreeifySize)return this.length+=1,void this.reAllocate();this.hashTable[n]=new d.default(this.hashTable[n])}this.length+=1}else{r.setElement(e,t);r=r.size();this.length+=r-i}}else this.length+=1,this.hashTable[n]=new h.default([[e,t]],!1);this.length>this.bucketNum*o.sigma&&this.reAllocate()}getElementByKey(e){var t=this.hashFunc(e)&this.bucketNum-1,t=this.hashTable[t];if(t){if(t instanceof d.default)return t.getElementByKey(e);for(const n of t)if(n[0]===e)return n[1]}}eraseElementByKey(t){var e=this.hashFunc(t)&this.bucketNum-1,n=this.hashTable[e];if(n)if(n instanceof h.default){let e=0;for(const s of n){if(s[0]===t)return n.eraseElementByPos(e),void--this.length;e+=1}}else{var r=n.size(),i=(n.eraseElementByKey(t),n.size());this.length+=i-r,i<=c.default.untreeifyThreshold&&(this.hashTable[e]=new h.default(n))}}find(e){var t=this.hashFunc(e)&this.bucketNum-1,t=this.hashTable[t];if(t){if(t instanceof d.default)return!t.find(e).equals(t.end());for(const n of t)if(n[0]===e)return!0}return!1}[Symbol.iterator](){return function*(){var t=Object.values(this.hashTable),n=t.length;for(let e=0;e<n;++e)for(const r of t[e])yield r}.bind(this)()}}n.default=o},{"../SequentialContainer/Vector":36,"../TreeContainer/OrderedMap":40,"./Base/index":26}],28:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const c=r(e("./Base/index")),h=r(e("../SequentialContainer/Vector")),d=r(e("../TreeContainer/OrderedSet"));class i extends c.default{constructor(e=[],t,n){super(t,n),this.hashTable=[],e.forEach(e=>this.insert(e))}reAllocate(){if(!(this.bucketNum>=c.default.maxBucketNum)){var t=[];const a=this.bucketNum;this.bucketNum<<=1;var n=Object.keys(this.hashTable),r=n.length;for(let e=0;e<r;++e){var i=parseInt(n[e]),s=this.hashTable[i],o=s.size();if(0!==o)if(1===o){o=s.front();t[this.hashFunc(o)&this.bucketNum-1]=new h.default([o],!1)}else{const l=[],u=[];s.forEach(e=>{(0==(this.hashFunc(e)&a)?l:u).push(e)}),s instanceof d.default?(l.length>c.default.untreeifyThreshold?t[i]=new d.default(l):l.length&&(t[i]=new h.default(l,!1)),u.length>c.default.untreeifyThreshold?t[i+a]=new d.default(u):u.length&&(t[i+a]=new h.default(u,!1))):(l.length>=c.default.treeifyThreshold?t[i]=new d.default(l):l.length&&(t[i]=new h.default(l,!1)),u.length>=c.default.treeifyThreshold?t[i+a]=new d.default(u):u.length&&(t[i+a]=new h.default(u,!1)))}}this.hashTable=t}}forEach(t){var n=Object.values(this.hashTable),r=n.length;let i=0;for(let e=0;e<r;++e)n[e].forEach(e=>t(e,i++))}insert(e){var t=this.hashFunc(e)&this.bucketNum-1,n=this.hashTable[t];if(n){var r=n.size();if(n instanceof h.default){if(!n.find(e).equals(n.end()))return;if(n.pushBack(e),r+1>=c.default.treeifyThreshold){if(this.bucketNum<=c.default.minTreeifySize)return this.length+=1,void this.reAllocate();this.hashTable[t]=new d.default(n)}this.length+=1}else{n.insert(e);n=n.size();this.length+=n-r}}else this.hashTable[t]=new h.default([e],!1),this.length+=1;this.length>this.bucketNum*c.default.sigma&&this.reAllocate()}eraseElementByKey(e){var t,n,r=this.hashFunc(e)&this.bucketNum-1,i=this.hashTable[r];i&&0!==(t=i.size())&&(i instanceof h.default?(i.eraseElementByValue(e),n=i.size(),this.length+=n-t):(i.eraseElementByKey(e),n=i.size(),this.length+=n-t,n<=c.default.untreeifyThreshold&&(this.hashTable[r]=new h.default(i))))}find(e){var t=this.hashFunc(e)&this.bucketNum-1,t=this.hashTable[t];return!!t&&!t.find(e).equals(t.end())}[Symbol.iterator](){return function*(){var t=Object.values(this.hashTable),n=t.length;for(let e=0;e<n;++e)for(const r of t[e])yield r}.bind(this)()}}n.default=i},{"../SequentialContainer/Vector":36,"../TreeContainer/OrderedSet":41,"./Base/index":26}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends e("../ContainerBase/index").Base{constructor(e=[],t=(e,t)=>t<e?-1:e<t?1:0,n=!0){super(),this.cmp=t,Array.isArray(e)?this.priorityQueue=n?[...e]:e:(this.priorityQueue=[],e.forEach(e=>this.priorityQueue.push(e))),this.length=this.priorityQueue.length;for(let e=this.length-1>>1;0<=e;--e){let t=e,n=t<<1|1;for(;n<this.length;){var r=n,i=r+1;let e=r;if(i<this.length&&0<this.cmp(this.priorityQueue[r],this.priorityQueue[i])&&(e=i),this.cmp(this.priorityQueue[t],this.priorityQueue[e])<=0)break;[this.priorityQueue[t],this.priorityQueue[e]]=[this.priorityQueue[e],this.priorityQueue[t]],t=e,n=t<<1|1}}}adjust(e){var t=e<<1|1,n=2+(e<<1);t<this.length&&0<this.cmp(this.priorityQueue[e],this.priorityQueue[t])&&([this.priorityQueue[e],this.priorityQueue[t]]=[this.priorityQueue[t],this.priorityQueue[e]]),n<this.length&&0<this.cmp(this.priorityQueue[e],this.priorityQueue[n])&&([this.priorityQueue[e],this.priorityQueue[n]]=[this.priorityQueue[n],this.priorityQueue[e]])}clear(){this.length=0,this.priorityQueue.length=0}push(t){if(this.priorityQueue.push(t),this.length+=1,1!==this.length){let e=this.length-1;for(;0<e;){var n=e-1>>1;if(this.cmp(this.priorityQueue[n],t)<=0)break;this.adjust(n),e=n}}}pop(){if(this.length){var n=this.priorityQueue[this.length-1];--this.length;let t=0;for(;t<this.length;){var r=t<<1|1,i=2+(t<<1);if(r>=this.length)break;let e=r;if(i<this.length&&0<this.cmp(this.priorityQueue[r],this.priorityQueue[i])&&(e=i),0<=this.cmp(this.priorityQueue[e],n))break;this.priorityQueue[t]=this.priorityQueue[e],t=e}this.priorityQueue[t]=n,this.priorityQueue.pop()}}top(){return this.priorityQueue[0]}}n.default=r},{"../ContainerBase/index":25}],30:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=r(e("../SequentialContainer/Deque"));class s extends e("../ContainerBase/index").Base{constructor(e=[]){super(),this.queue=new i.default(e),this.length=this.queue.size()}clear(){this.queue.clear(),this.length=0}push(e){this.queue.pushBack(e),this.length+=1}pop(){this.queue.popFront(),this.length&&--this.length}front(){return this.queue.front()}}n.default=s},{"../ContainerBase/index":25,"../SequentialContainer/Deque":34}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends e("../ContainerBase/index").Base{constructor(e=[]){super(),this.stack=[],e.forEach(e=>this.push(e))}clear(){this.length=0,this.stack.length=0}push(e){this.stack.push(e),this.length+=1}pop(){this.stack.pop(),0<this.length&&--this.length}top(){return this.stack[this.length-1]}}n.default=r},{"../ContainerBase/index":25}],32:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.RandomIterator=void 0;const r=e("../../../utils/checkParams"),s=e("../../ContainerBase/index");class i extends s.ContainerIterator{constructor(e,t,n,r,i){super(i),this.node=e,this.size=t,this.getElementByPos=n,this.setElementByPos=r,this.iteratorType===s.ContainerIterator.NORMAL?(this.pre=function(){if(0===this.node)throw new RangeError("Deque iterator access denied!");return--this.node,this},this.next=function(){if(this.node===this.size())throw new RangeError("Deque Iterator access denied!");return this.node+=1,this}):(this.pre=function(){if(this.node===this.size()-1)throw new RangeError("Deque iterator access denied!");return this.node+=1,this},this.next=function(){if(-1===this.node)throw new RangeError("Deque iterator access denied!");return--this.node,this})}get pointer(){return(0,r.checkWithinAccessParams)(this.node,0,this.size()-1),this.getElementByPos(this.node)}set pointer(e){(0,r.checkWithinAccessParams)(this.node,0,this.size()-1),this.setElementByPos(this.node,e)}equals(e){return this.node===e.node}}n.RandomIterator=i},{"../../../utils/checkParams":43,"../../ContainerBase/index":25}],33:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends e("../../ContainerBase/index").Container{}n.default=r},{"../../ContainerBase/index":25}],34:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=(Object.defineProperty(n,"__esModule",{value:!0}),n.DequeIterator=void 0,r(e("./Base/index")));const s=e("../../utils/checkParams"),i=e("../ContainerBase/index");class o extends e("./Base/RandomIterator").RandomIterator{copy(){return new o(this.node,this.size,this.getElementByPos,this.setElementByPos,this.iteratorType)}}n.DequeIterator=o;class a extends r.default{constructor(e=[],t=4096){super(),this.first=0,this.curFirst=0,this.last=0,this.curLast=0,this.bucketNum=0,this.map=[];let n;if("size"in e)n="number"==typeof e.size?e.size:e.size();else{if(!("length"in e))throw new RangeError("Can't get container's size!");n=e.length}this.bucketSize=t,this.bucketNum=Math.max(Math.ceil(n/this.bucketSize),1);for(let e=0;e<this.bucketNum;++e)this.map.push(new Array(this.bucketSize));t=Math.ceil(n/this.bucketSize);this.first=this.last=(this.bucketNum>>1)-(t>>1),this.curFirst=this.curLast=this.bucketSize-n%this.bucketSize>>1,e.forEach(e=>this.pushBack(e)),this.size=this.size.bind(this),this.getElementByPos=this.getElementByPos.bind(this),this.setElementByPos=this.setElementByPos.bind(this)}reAllocate(){var t=[],n=Math.max(this.bucketNum>>1,1);for(let e=0;e<n;++e)t[e]=new Array(this.bucketSize);for(let e=this.first;e<this.bucketNum;++e)t[t.length]=this.map[e];for(let e=0;e<this.last;++e)t[t.length]=this.map[e];t[t.length]=[...this.map[this.last]],this.first=n,this.last=t.length-1;for(let e=0;e<n;++e)t[t.length]=new Array(this.bucketSize);this.map=t,this.bucketNum=t.length}getElementIndex(e){var e=this.curFirst+e+1,t=e%this.bucketSize;let n=t-1,r=this.first+(e-t)/this.bucketSize;return 0==t&&--r,r%=this.bucketNum,n<0&&(n+=this.bucketSize),{curNodeBucketIndex:r,curNodePointerIndex:n}}clear(){this.map=[[]],this.bucketNum=1,this.first=this.last=this.length=0,this.curFirst=this.curLast=this.bucketSize>>1}front(){return this.map[this.first][this.curFirst]}back(){return this.map[this.last][this.curLast]}begin(){return new o(0,this.size,this.getElementByPos,this.setElementByPos)}end(){return new o(this.length,this.size,this.getElementByPos,this.setElementByPos)}rBegin(){return new o(this.length-1,this.size,this.getElementByPos,this.setElementByPos,i.ContainerIterator.REVERSE)}rEnd(){return new o(-1,this.size,this.getElementByPos,this.setElementByPos,i.ContainerIterator.REVERSE)}pushBack(e){this.length&&(this.curLast<this.bucketSize-1?this.curLast+=1:(this.last<this.bucketNum-1?this.last+=1:this.last=0,this.curLast=0),this.last===this.first)&&this.curLast===this.curFirst&&this.reAllocate(),this.length+=1,this.map[this.last][this.curLast]=e}popBack(){this.length&&(this.map[this.last][this.curLast]=void 0,1!==this.length&&(0<this.curLast?--this.curLast:(0<this.last?--this.last:this.last=this.bucketNum-1,this.curLast=this.bucketSize-1)),--this.length)}pushFront(e){this.length&&(0<this.curFirst?--this.curFirst:(0<this.first?--this.first:this.first=this.bucketNum-1,this.curFirst=this.bucketSize-1),this.first===this.last)&&this.curFirst===this.curLast&&this.reAllocate(),this.length+=1,this.map[this.first][this.curFirst]=e}popFront(){this.length&&(this.map[this.first][this.curFirst]=void 0,1!==this.length&&(this.curFirst<this.bucketSize-1?this.curFirst+=1:(this.first<this.bucketNum-1?this.first+=1:this.first=0,this.curFirst=0)),--this.length)}forEach(t){for(let e=0;e<this.length;++e)t(this.getElementByPos(e),e)}getElementByPos(e){(0,s.checkWithinAccessParams)(e,0,this.length-1);var{curNodeBucketIndex:e,curNodePointerIndex:t}=this.getElementIndex(e);return this.map[e][t]}setElementByPos(e,t){(0,s.checkWithinAccessParams)(e,0,this.length-1);var{curNodeBucketIndex:e,curNodePointerIndex:n}=this.getElementIndex(e);this.map[e][n]=t}insert(t,n,r=1){if((0,s.checkWithinAccessParams)(t,0,this.length),0===t)for(;r--;)this.pushFront(n);else if(t===this.length)for(;r--;)this.pushBack(n);else{var i=[];for(let e=t;e<this.length;++e)i.push(this.getElementByPos(e));this.cut(t-1);for(let e=0;e<r;++e)this.pushBack(n);for(let e=0;e<i.length;++e)this.pushBack(i[e])}}cut(e){var t,n;e<0?this.clear():({curNodeBucketIndex:t,curNodePointerIndex:n}=this.getElementIndex(e),this.last=t,this.curLast=n,this.length=e+1)}eraseElementByPos(t){if((0,s.checkWithinAccessParams)(t,0,this.length-1),0===t)this.popFront();else if(t===this.length-1)this.popBack();else{var n=[];for(let e=t+1;e<this.length;++e)n.push(this.getElementByPos(e));this.cut(t),this.popBack(),n.forEach(e=>this.pushBack(e))}}eraseElementByValue(t){if(this.length){var n=[];for(let e=0;e<this.length;++e){var r=this.getElementByPos(e);r!==t&&n.push(r)}var i=n.length;for(let e=0;e<i;++e)this.setElementByPos(e,n[e]);this.cut(i-1)}}eraseElementByIterator(e){var t=e.node;return this.eraseElementByPos(t),e=e.next()}find(t){for(let e=0;e<this.length;++e)if(this.getElementByPos(e)===t)return new o(e,this.size,this.getElementByPos,this.setElementByPos);return this.end()}reverse(){let e=0,t=this.length-1;for(;e<t;){var n=this.getElementByPos(e);this.setElementByPos(e,this.getElementByPos(t)),this.setElementByPos(t,n),e+=1,--t}}unique(){if(!(this.length<=1)){let t=1,n=this.getElementByPos(0);for(let e=1;e<this.length;++e){var r=this.getElementByPos(e);r!==n&&(n=r,this.setElementByPos(t++,r))}for(;this.length>t;)this.popBack()}}sort(e){var t=[];for(let e=0;e<this.length;++e)t.push(this.getElementByPos(e));t.sort(e);for(let e=0;e<this.length;++e)this.setElementByPos(e,t[e])}shrinkToFit(){if(this.length){const t=[];this.forEach(e=>t.push(e)),this.bucketNum=Math.max(Math.ceil(this.length/this.bucketSize),1),this.length=this.first=this.last=this.curFirst=this.curLast=0,this.map=[];for(let e=0;e<this.bucketNum;++e)this.map.push(new Array(this.bucketSize));for(let e=0;e<t.length;++e)this.pushBack(t[e])}}[Symbol.iterator](){return function*(){for(let e=0;e<this.length;++e)yield this.getElementByPos(e)}.bind(this)()}}n.default=a},{"../../utils/checkParams":43,"../ContainerBase/index":25,"./Base/RandomIterator":32,"./Base/index":33}],35:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=(Object.defineProperty(n,"__esModule",{value:!0}),n.LinkListIterator=n.LinkNode=void 0,r(e("./Base/index")));const s=e("../../utils/checkParams"),i=e("../ContainerBase/index");class o{constructor(e){this.value=void 0,this.pre=void 0,this.next=void 0,this.value=e}}n.LinkNode=o;class a extends i.ContainerIterator{constructor(e,t,n){super(n),this.node=e,this.header=t,this.iteratorType===i.ContainerIterator.NORMAL?(this.pre=function(){if(this.node.pre===this.header)throw new RangeError("LinkList iterator access denied!");return this.node=this.node.pre,this},this.next=function(){if(this.node===this.header)throw new RangeError("LinkList iterator access denied!");return this.node=this.node.next,this}):(this.pre=function(){if(this.node.next===this.header)throw new RangeError("LinkList iterator access denied!");return this.node=this.node.next,this},this.next=function(){if(this.node===this.header)throw new RangeError("LinkList iterator access denied!");return this.node=this.node.pre,this})}get pointer(){if(this.node===this.header)throw new RangeError("LinkList iterator access denied!");return this.node.value}set pointer(e){if(this.node===this.header)throw new RangeError("LinkList iterator access denied!");this.node.value=e}equals(e){return this.node===e.node}copy(){return new a(this.node,this.header,this.iteratorType)}}n.LinkListIterator=a;class l extends r.default{constructor(e=[]){super(),this.header=new o,this.head=void 0,this.tail=void 0,e.forEach(e=>this.pushBack(e))}clear(){this.length=0,this.head=this.tail=void 0,this.header.pre=this.header.next=void 0}begin(){return new a(this.head||this.header,this.header)}end(){return new a(this.header,this.header)}rBegin(){return new a(this.tail||this.header,this.header,i.ContainerIterator.REVERSE)}rEnd(){return new a(this.header,this.header,i.ContainerIterator.REVERSE)}front(){return this.head?this.head.value:void 0}back(){return this.tail?this.tail.value:void 0}forEach(n){if(this.length){let e=this.head,t=0;for(;e!==this.header;)n(e.value,t++),e=e.next}}getElementByPos(e){(0,s.checkWithinAccessParams)(e,0,this.length-1);let t=this.head;for(;e--;)t=t.next;return t.value}eraseElementByPos(t){if((0,s.checkWithinAccessParams)(t,0,this.length-1),0===t)this.popFront();else if(t===this.length-1)this.popBack();else{let e=this.head;for(;t--;)e=e.next;var n=(e=e).pre,r=e.next;(r.pre=n).next=r,--this.length}}eraseElementByValue(t){for(;this.head&&this.head.value===t;)this.popFront();for(;this.tail&&this.tail.value===t;)this.popBack();if(this.head){let e=this.head;for(;e!==this.header;){var n,r;e.value===t&&(n=e.pre,(r=e.next)&&(r.pre=n),n&&(n.next=r),--this.length),e=e.next}}}eraseElementByIterator(e){var t,n=e.node;if(n===this.header)throw new RangeError("Invalid iterator");return e=e.next(),this.head===n?this.popFront():this.tail===n?this.popBack():(t=n.pre,(n=n.next)&&(n.pre=t),t&&(t.next=n),--this.length),e}pushBack(e){this.length+=1;e=new o(e);this.tail?((this.tail.next=e).pre=this.tail,this.tail=e):(this.head=this.tail=e,this.header.next=this.head,this.head.pre=this.header),this.tail.next=this.header,this.header.pre=this.tail}popBack(){this.tail&&(--this.length,this.head===this.tail?(this.head=this.tail=void 0,this.header.next=void 0):(this.tail=this.tail.pre,this.tail&&(this.tail.next=void 0)),this.header.pre=this.tail,this.tail)&&(this.tail.next=this.header)}setElementByPos(e,t){(0,s.checkWithinAccessParams)(e,0,this.length-1);let n=this.head;for(;e--;)n=n.next;n.value=t}insert(n,e,r=1){if((0,s.checkWithinAccessParams)(n,0,this.length),!(r<=0))if(0===n)for(;r--;)this.pushFront(e);else if(n===this.length)for(;r--;)this.pushBack(e);else{let t=this.head;for(let e=1;e<n;++e)t=t.next;var i=t.next;for(this.length+=r;r--;)t.next=new o(e),t=(t.next.pre=t).next;(t.next=i)&&(i.pre=t)}}find(t){if(this.head){let e=this.head;for(;e!==this.header;){if(e.value===t)return new a(e,this.header);e=e.next}}return this.end()}reverse(){if(!(this.length<=1)){let e=this.head,t=this.tail,n=0;for(;n<<1<this.length;){var r=e.value;e.value=t.value,t.value=r,e=e.next,t=t.pre,n+=1}}}unique(){if(!(this.length<=1)){let t=this.head;for(;t!==this.header;){let e=t;for(;e.next&&e.value===e.next.value;)e=e.next,--this.length;t.next=e.next,t.next&&(t.next.pre=t),t=t.next}}}sort(e){if(!(this.length<=1)){const n=[];this.forEach(e=>n.push(e)),n.sort(e);let t=this.head;n.forEach(e=>{t.value=e,t=t.next})}}pushFront(e){this.length+=1;e=new o(e);this.head?(e.next=this.head,this.head.pre=e,this.head=e):(this.head=this.tail=e,this.tail.next=this.header,this.header.pre=this.tail),this.header.next=this.head,this.head.pre=this.header}popFront(){this.head&&(--this.length,this.head===this.tail?(this.head=this.tail=void 0,this.header.pre=this.tail):(this.head=this.head.next,this.head&&(this.head.pre=this.header)),this.header.next=this.head)}merge(e){if(this.head){let n=this.head;e.forEach(e=>{for(;n&&n!==this.header&&n.value<=e;)n=n.next;var t;n===this.header?(this.pushBack(e),n=this.tail):n===this.head?(this.pushFront(e),n=this.head):(this.length+=1,(t=n.pre).next=new o(e),((t.next.pre=t).next.next=n).pre=t.next)})}else e.forEach(e=>this.pushBack(e))}[Symbol.iterator](){return function*(){if(this.head){let e=this.head;for(;e!==this.header;)yield e.value,e=e.next}}.bind(this)()}}n.default=l},{"../../utils/checkParams":43,"../ContainerBase/index":25,"./Base/index":33}],36:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=(Object.defineProperty(n,"__esModule",{value:!0}),n.VectorIterator=void 0,r(e("./Base/index")));const i=e("../../utils/checkParams"),s=e("../ContainerBase/index");class o extends e("./Base/RandomIterator").RandomIterator{copy(){return new o(this.node,this.size,this.getElementByPos,this.setElementByPos,this.iteratorType)}}n.VectorIterator=o;class a extends r.default{constructor(e=[],t=!0){super(),Array.isArray(e)?(this.vector=t?[...e]:e,this.length=e.length):(this.vector=[],e.forEach(e=>this.pushBack(e))),this.size=this.size.bind(this),this.getElementByPos=this.getElementByPos.bind(this),this.setElementByPos=this.setElementByPos.bind(this)}clear(){this.length=0,this.vector.length=0}begin(){return new o(0,this.size,this.getElementByPos,this.setElementByPos)}end(){return new o(this.length,this.size,this.getElementByPos,this.setElementByPos)}rBegin(){return new o(this.length-1,this.size,this.getElementByPos,this.setElementByPos,s.ContainerIterator.REVERSE)}rEnd(){return new o(-1,this.size,this.getElementByPos,this.setElementByPos,s.ContainerIterator.REVERSE)}front(){return this.vector[0]}back(){return this.vector[this.length-1]}forEach(t){for(let e=0;e<this.length;++e)t(this.vector[e],e)}getElementByPos(e){return(0,i.checkWithinAccessParams)(e,0,this.length-1),this.vector[e]}eraseElementByPos(e){(0,i.checkWithinAccessParams)(e,0,this.length-1),this.vector.splice(e,1),--this.length}eraseElementByValue(t){let n=0;for(let e=0;e<this.length;++e)this.vector[e]!==t&&(this.vector[n++]=this.vector[e]);this.length=this.vector.length=n}eraseElementByIterator(e){var t=e.node;return e=e.next(),this.eraseElementByPos(t),e}pushBack(e){this.vector.push(e),this.length+=1}popBack(){this.length&&(this.vector.pop(),--this.length)}setElementByPos(e,t){(0,i.checkWithinAccessParams)(e,0,this.length-1),this.vector[e]=t}insert(e,t,n=1){(0,i.checkWithinAccessParams)(e,0,this.length),this.vector.splice(e,0,...new Array(n).fill(t)),this.length+=n}find(t){for(let e=0;e<this.length;++e)if(this.vector[e]===t)return new o(e,this.size,this.getElementByPos,this.getElementByPos);return this.end()}reverse(){this.vector.reverse()}unique(){let t=1;for(let e=1;e<this.length;++e)this.vector[e]!==this.vector[e-1]&&(this.vector[t++]=this.vector[e]);this.length=this.vector.length=t}sort(e){this.vector.sort(e)}[Symbol.iterator](){return function*(){return yield*this.vector}.bind(this)()}}n.default=a},{"../../utils/checkParams":43,"../ContainerBase/index":25,"./Base/RandomIterator":32,"./Base/index":33}],37:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=e("../../ContainerBase/index");class i extends r.ContainerIterator{constructor(e,t,n){super(n),this.node=e,this.header=t,this.iteratorType===r.ContainerIterator.NORMAL?(this.pre=function(){if(this.node===this.header.left)throw new RangeError("LinkList iterator access denied!");return this.node=this.node.pre(),this},this.next=function(){if(this.node===this.header)throw new RangeError("LinkList iterator access denied!");return this.node=this.node.next(),this}):(this.pre=function(){if(this.node===this.header.right)throw new RangeError("LinkList iterator access denied!");return this.node=this.node.next(),this},this.next=function(){if(this.node===this.header)throw new RangeError("LinkList iterator access denied!");return this.node=this.node.pre(),this})}equals(e){return this.node===e.node}}n.default=i},{"../../ContainerBase/index":25}],38:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r{constructor(e,t){this.color=!0,this.key=void 0,this.value=void 0,this.left=void 0,this.right=void 0,this.parent=void 0,this.key=e,this.value=t}pre(){let t=this;if(t.color===r.RED&&t.parent.parent===t)t=t.right;else if(t.left)for(t=t.left;t.right;)t=t.right;else{let e=t.parent;for(;e.left===t;)e=(t=e).parent;t=e}return t}next(){let t=this;if(t.right)for(t=t.right;t.left;)t=t.left;else{let e=t.parent;for(;e.right===t;)e=(t=e).parent;t.right!==e&&(t=e)}return t}rotateLeft(){var e=this.parent,t=this.right,n=t.left;return e.parent===this?e.parent=t:e.left===this?e.left=t:e.right=t,t.parent=e,(t.left=this).parent=t,(this.right=n)&&(n.parent=this),t}rotateRight(){var e=this.parent,t=this.left,n=t.right;return e.parent===this?e.parent=t:e.left===this?e.left=t:e.right=t,t.parent=e,(t.right=this).parent=t,(this.left=n)&&(n.parent=this),t}remove(){var e=this.parent;this===e.left?e.left=void 0:e.right=void 0}}r.RED=!0,r.BLACK=!1,n.default=r},{}],39:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const a=r(e("./TreeNode"));r=e("../../ContainerBase/index");const i=e("../../../utils/checkParams");class s extends r.Container{constructor(e=(e,t)=>e<t?-1:t<e?1:0){super(),this.root=void 0,this.header=new a.default,this.inOrderTraversal=(e,t)=>{return void 0!==e&&(!!this.inOrderTraversal(e.left,t)||!!t(e)||this.inOrderTraversal(e.right,t))},this.cmp=e}_lowerBound(e,t){let n;for(;e;){var r=this.cmp(e.key,t);if(r<0)e=e.right;else{if(!(0<r))return e;e=(n=e).left}}return void 0===n?this.header:n}_upperBound(e,t){let n;for(;e;){var r=this.cmp(e.key,t);r<=0?e=e.right:0<r&&(e=(n=e).left)}return void 0===n?this.header:n}_reverseLowerBound(e,t){let n;for(;e;){var r=this.cmp(e.key,t);if(r<0)e=(n=e).right;else{if(!(0<r))return e;e=e.left}}return void 0===n?this.header:n}_reverseUpperBound(e,t){let n;for(;e;){var r=this.cmp(e.key,t);r<0?e=(n=e).right:0<=r&&(e=e.left)}return void 0===n?this.header:n}eraseNodeSelfBalance(e){for(;;){var t=e.parent;if(t===this.header)return;if(e.color===a.default.RED)return void(e.color=a.default.BLACK);if(e===t.left){var n=t.right;if(n.color===a.default.RED)n.color=a.default.BLACK,t.color=a.default.RED,t===this.root?this.root=t.rotateLeft():t.rotateLeft();else if(n.color===a.default.BLACK){if(n.right&&n.right.color===a.default.RED)return n.color=t.color,t.color=a.default.BLACK,n.right.color=a.default.BLACK,void(t===this.root?this.root=t.rotateLeft():t.rotateLeft());n.left&&n.left.color===a.default.RED?(n.color=a.default.RED,n.left.color=a.default.BLACK,n.rotateRight()):(n.color=a.default.RED,e=t)}}else{n=t.left;if(n.color===a.default.RED)n.color=a.default.BLACK,t.color=a.default.RED,t===this.root?this.root=t.rotateRight():t.rotateRight();else{if(n.left&&n.left.color===a.default.RED)return n.color=t.color,t.color=a.default.BLACK,n.left.color=a.default.BLACK,void(t===this.root?this.root=t.rotateRight():t.rotateRight());n.right&&n.right.color===a.default.RED?(n.color=a.default.RED,n.right.color=a.default.BLACK,n.rotateLeft()):(n.color=a.default.RED,e=t)}}}}eraseNode(t){if(1===this.length)this.clear();else{let e=t;for(;e.left||e.right;){if(e.right)for(e=e.right;e.left;)e=e.left;else e.left&&(e=e.left);[t.key,e.key]=[e.key,t.key],[t.value,e.value]=[e.value,t.value],t=e}this.header.left===e?this.header.left=e.parent:this.header.right===e&&(this.header.right=e.parent),this.eraseNodeSelfBalance(e),e.remove(),--this.length,this.root.color=a.default.BLACK}}insertNodeSelfBalance(e){for(;;){var t=e.parent;if(t.color===a.default.BLACK)return;var n=t.parent;if(t===n.left){var r=n.right;if(r&&r.color===a.default.RED){if(r.color=t.color=a.default.BLACK,n===this.root)return;n.color=a.default.RED,e=n;continue}e===t.right?(e.color=a.default.BLACK,e.left&&(e.left.parent=t),e.right&&(e.right.parent=n),t.right=e.left,n.left=e.right,e.left=t,(e.right=n)===this.root?(this.root=e,this.header.parent=e):(r=n.parent).left===n?r.left=e:r.right=e,e.parent=n.parent,t.parent=e,n.parent=e):(t.color=a.default.BLACK,n===this.root?this.root=n.rotateRight():n.rotateRight())}else{var i,r=n.left;if(r&&r.color===a.default.RED){if(r.color=t.color=a.default.BLACK,n===this.root)return;n.color=a.default.RED,e=n;continue}e===t.left?(e.color=a.default.BLACK,e.left&&(e.left.parent=n),e.right&&(e.right.parent=t),n.right=e.left,t.left=e.right,e.left=n,e.right=t,n===this.root?(this.root=e,this.header.parent=e):(i=n.parent).left===n?i.left=e:i.right=e,e.parent=n.parent,t.parent=e,n.parent=e):(t.color=a.default.BLACK,n===this.root?this.root=n.rotateLeft():n.rotateLeft())}return void(n.color=a.default.RED)}}findElementNode(e,t){for(;e;){var n=this.cmp(e.key,t);if(n<0)e=e.right;else{if(!(0<n))return e;e=e.left}}return e}set(t,n,r){if(void 0===this.root)this.length+=1,this.root=new a.default(t,n),this.root.color=a.default.BLACK,this.root.parent=this.header,this.header.parent=this.root,this.header.left=this.root,this.header.right=this.root;else{let e;var i=this.header.left,s=this.cmp(i.key,t);if(0===s)i.value=n;else{if(0<s)i.left=new a.default(t,n),i.left.parent=i,e=i.left,this.header.left=e;else{s=this.header.right,i=this.cmp(s.key,t);if(0===i)return void(s.value=n);if(i<0)s.right=new a.default(t,n),s.right.parent=s,e=s.right,this.header.right=e;else{if(void 0!==r){i=r.node;if(i!==this.header){s=this.cmp(i.key,t);if(0===s)return void(i.value=n);if(0<s){r=i.pre(),s=this.cmp(r.key,t);if(0===s)return void(r.value=n);s<0&&(e=new a.default(t,n),void 0===r.right?(r.right=e).parent=r:(i.left=e).parent=i)}}}if(void 0===e)for(e=this.root;;){var o=this.cmp(e.key,t);if(0<o){if(void 0===e.left){e.left=new a.default(t,n),e=(e.left.parent=e).left;break}e=e.left}else{if(!(o<0))return void(e.value=n);if(void 0===e.right){e.right=new a.default(t,n),e=(e.right.parent=e).right;break}e=e.right}}}}this.length+=1,this.insertNodeSelfBalance(e)}}}clear(){this.length=0,this.root=void 0,this.header.parent=void 0,this.header.left=this.header.right=void 0}updateKeyByIterator(e,t){e=e.node;if(e===this.header)throw new TypeError("Invalid iterator!");if(1!==this.length){if(e===this.header.left)return 0<this.cmp(e.next().key,t)&&(e.key=t,!0);if(e===this.header.right)return this.cmp(e.pre().key,t)<0&&(e.key=t,!0);var n=e.pre().key;if(0<=this.cmp(n,t))return!1;if(n=e.next().key,this.cmp(n,t)<=0)return!1}return e.key=t,!0}eraseElementByPos(t){(0,i.checkWithinAccessParams)(t,0,this.length-1);let n=0;this.inOrderTraversal(this.root,e=>t===n?(this.eraseNode(e),!0):(n+=1,!1))}eraseElementByKey(e){this.length&&void 0!==(e=this.findElementNode(this.root,e))&&this.eraseNode(e)}eraseElementByIterator(e){var t=e.node;if(t===this.header)throw new RangeError("Invalid iterator");return void 0===t.right&&(e=e.next()),this.eraseNode(t),e}getHeight(){if(!this.length)return 0;const t=e=>e?Math.max(t(e.left),t(e.right))+1:0;return t(this.root)}}n.default=s},{"../../../utils/checkParams":43,"../../ContainerBase/index":25,"./TreeNode":38}],40:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.OrderedMapIterator=void 0;const i=e("../ContainerBase/index"),s=e("../../utils/checkParams");var o=r(e("./Base/index"));class a extends r(e("./Base/TreeIterator")).default{get pointer(){if(this.node===this.header)throw new RangeError("OrderedMap iterator access denied");return new Proxy([],{get:(e,t)=>"0"===t?this.node.key:"1"===t?this.node.value:void 0,set:(e,t,n)=>{if("1"!==t)throw new TypeError("props must be 1");return this.node.value=n,!0}})}copy(){return new a(this.node,this.header,this.iteratorType)}}n.OrderedMapIterator=a;class l extends o.default{constructor(e=[],t){super(t),this.iterationFunc=function*(e){void 0!==e&&(yield*this.iterationFunc(e.left),yield[e.key,e.value],yield*this.iterationFunc(e.right))},this.iterationFunc=this.iterationFunc.bind(this),e.forEach(([e,t])=>this.setElement(e,t))}begin(){return new a(this.header.left||this.header,this.header)}end(){return new a(this.header,this.header)}rBegin(){return new a(this.header.right||this.header,this.header,i.ContainerIterator.REVERSE)}rEnd(){return new a(this.header,this.header,i.ContainerIterator.REVERSE)}front(){var e;if(this.length)return[(e=this.header.left).key,e.value]}back(){var e;if(this.length)return[(e=this.header.right).key,e.value]}forEach(e){let t=0;for(const n of this)e(n,t++)}lowerBound(e){e=this._lowerBound(this.root,e);return new a(e,this.header)}upperBound(e){e=this._upperBound(this.root,e);return new a(e,this.header)}reverseLowerBound(e){e=this._reverseLowerBound(this.root,e);return new a(e,this.header)}reverseUpperBound(e){e=this._reverseUpperBound(this.root,e);return new a(e,this.header)}setElement(e,t,n){this.set(e,t,n)}find(e){e=this.findElementNode(this.root,e);return void 0!==e?new a(e,this.header):this.end()}getElementByKey(e){e=this.findElementNode(this.root,e);return e?e.value:void 0}getElementByPos(e){(0,s.checkWithinAccessParams)(e,0,this.length-1);let t,n=0;for(const r of this){if(n===e){t=r;break}n+=1}return t}union(e){e.forEach(([e,t])=>this.setElement(e,t))}[Symbol.iterator](){return this.iterationFunc(this.root)}}n.default=l},{"../../utils/checkParams":43,"../ContainerBase/index":25,"./Base/TreeIterator":37,"./Base/index":39}],41:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(n,"__esModule",{value:!0}),n.OrderedSetIterator=void 0,r(e("./Base/index")));const s=e("../ContainerBase/index"),o=e("../../utils/checkParams");class a extends r(e("./Base/TreeIterator")).default{get pointer(){if(this.node===this.header)throw new RangeError("OrderedSet iterator access denied!");return this.node.key}copy(){return new a(this.node,this.header,this.iteratorType)}}n.OrderedSetIterator=a;class l extends i.default{constructor(e=[],t){super(t),this.iterationFunc=function*(e){void 0!==e&&(yield*this.iterationFunc(e.left),yield e.key,yield*this.iterationFunc(e.right))},e.forEach(e=>this.insert(e)),this.iterationFunc=this.iterationFunc.bind(this)}begin(){return new a(this.header.left||this.header,this.header)}end(){return new a(this.header,this.header)}rBegin(){return new a(this.header.right||this.header,this.header,s.ContainerIterator.REVERSE)}rEnd(){return new a(this.header,this.header,s.ContainerIterator.REVERSE)}front(){return this.header.left?this.header.left.key:void 0}back(){return this.header.right?this.header.right.key:void 0}forEach(e){let t=0;for(const n of this)e(n,t++)}getElementByPos(e){(0,o.checkWithinAccessParams)(e,0,this.length-1);let t,n=0;for(const r of this)n===e&&(t=r),n+=1;return t}insert(e,t){this.set(e,void 0,t)}find(e){e=this.findElementNode(this.root,e);return void 0!==e?new a(e,this.header):this.end()}lowerBound(e){e=this._lowerBound(this.root,e);return new a(e,this.header)}upperBound(e){e=this._upperBound(this.root,e);return new a(e,this.header)}reverseLowerBound(e){e=this._reverseLowerBound(this.root,e);return new a(e,this.header)}reverseUpperBound(e){e=this._reverseUpperBound(this.root,e);return new a(e,this.header)}union(e){e.forEach(e=>this.insert(e))}[Symbol.iterator](){return this.iterationFunc(this.root)}}n.default=l},{"../../utils/checkParams":43,"../ContainerBase/index":25,"./Base/TreeIterator":37,"./Base/index":39}],42:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(n,"__esModule",{value:!0}),n.HashContainer=n.TreeContainer=n.SequentialContainer=n.ContainerIterator=n.Container=n.HashMap=n.HashSet=n.OrderedMapIterator=n.OrderedMap=n.OrderedSetIterator=n.OrderedSet=n.DequeIterator=n.Deque=n.LinkListIterator=n.LinkList=n.VectorIterator=n.Vector=n.PriorityQueue=n.Queue=n.Stack=void 0,e("./container/OtherContainer/Stack")),s=(Object.defineProperty(n,"Stack",{enumerable:!0,get:function(){return r(i).default}}),e("./container/OtherContainer/Queue")),o=(Object.defineProperty(n,"Queue",{enumerable:!0,get:function(){return r(s).default}}),e("./container/OtherContainer/PriorityQueue")),a=(Object.defineProperty(n,"PriorityQueue",{enumerable:!0,get:function(){return r(o).default}}),e("./container/SequentialContainer/Vector")),l=(Object.defineProperty(n,"Vector",{enumerable:!0,get:function(){return r(a).default}}),Object.defineProperty(n,"VectorIterator",{enumerable:!0,get:function(){return a.VectorIterator}}),e("./container/SequentialContainer/LinkList")),u=(Object.defineProperty(n,"LinkList",{enumerable:!0,get:function(){return r(l).default}}),Object.defineProperty(n,"LinkListIterator",{enumerable:!0,get:function(){return l.LinkListIterator}}),e("./container/SequentialContainer/Deque")),c=(Object.defineProperty(n,"Deque",{enumerable:!0,get:function(){return r(u).default}}),Object.defineProperty(n,"DequeIterator",{enumerable:!0,get:function(){return u.DequeIterator}}),e("./container/TreeContainer/OrderedSet")),h=(Object.defineProperty(n,"OrderedSet",{enumerable:!0,get:function(){return r(c).default}}),Object.defineProperty(n,"OrderedSetIterator",{enumerable:!0,get:function(){return c.OrderedSetIterator}}),e("./container/TreeContainer/OrderedMap")),d=(Object.defineProperty(n,"OrderedMap",{enumerable:!0,get:function(){return r(h).default}}),Object.defineProperty(n,"OrderedMapIterator",{enumerable:!0,get:function(){return h.OrderedMapIterator}}),e("./container/HashContainer/HashSet")),f=(Object.defineProperty(n,"HashSet",{enumerable:!0,get:function(){return r(d).default}}),e("./container/HashContainer/HashMap")),p=(Object.defineProperty(n,"HashMap",{enumerable:!0,get:function(){return r(f).default}}),e("./container/ContainerBase/index")),g=(Object.defineProperty(n,"Container",{enumerable:!0,get:function(){return p.Container}}),Object.defineProperty(n,"ContainerIterator",{enumerable:!0,get:function(){return p.ContainerIterator}}),e("./container/SequentialContainer/Base/index")),m=(Object.defineProperty(n,"SequentialContainer",{enumerable:!0,get:function(){return r(g).default}}),e("./container/TreeContainer/Base/index")),y=(Object.defineProperty(n,"TreeContainer",{enumerable:!0,get:function(){return r(m).default}}),e("./container/HashContainer/Base/index"));Object.defineProperty(n,"HashContainer",{enumerable:!0,get:function(){return r(y).default}})},{"./container/ContainerBase/index":25,"./container/HashContainer/Base/index":26,"./container/HashContainer/HashMap":27,"./container/HashContainer/HashSet":28,"./container/OtherContainer/PriorityQueue":29,"./container/OtherContainer/Queue":30,"./container/OtherContainer/Stack":31,"./container/SequentialContainer/Base/index":33,"./container/SequentialContainer/Deque":34,"./container/SequentialContainer/LinkList":35,"./container/SequentialContainer/Vector":36,"./container/TreeContainer/Base/index":39,"./container/TreeContainer/OrderedMap":40,"./container/TreeContainer/OrderedSet":41}],43:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.checkWithinAccessParams=void 0,n.checkWithinAccessParams=function(e,t,n){if(e<t||n<e)throw new RangeError}},{}],44:[function(e,t,n){"use strict";const r=e("yallist"),o=Symbol("max"),a=Symbol("length"),l=Symbol("lengthCalculator"),s=Symbol("allowStale"),u=Symbol("maxAge"),c=Symbol("dispose"),h=Symbol("noDisposeOnSet"),d=Symbol("lruList"),f=Symbol("cache"),i=Symbol("updateAgeOnGet"),p=()=>1;const g=(e,t,n)=>{t=e[f].get(t);if(t){var r=t.value;if(m(e,r)){if(b(e,t),!e[s])return}else n&&(e[i]&&(t.value.now=Date.now()),e[d].unshiftNode(t));return r.value}},m=(e,t)=>{var n;return!(!t||!t.maxAge&&!e[u])&&(n=Date.now()-t.now,t.maxAge?n>t.maxAge:e[u]&&n>e[u])},y=t=>{if(t[a]>t[o])for(let e=t[d].tail;t[a]>t[o]&&null!==e;){var n=e.prev;b(t,e),e=n}},b=(e,t)=>{var n;t&&(n=t.value,e[c]&&e[c](n.key,n.value),e[a]-=n.length,e[f].delete(n.key),e[d].removeNode(t))};class v{constructor(e,t,n,r,i){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=i||0}}const _=(e,t,n,r)=>{let i=n.value;m(e,i)&&(b(e,n),e[s]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};t.exports=class{constructor(e){if((e=(e="number"==typeof e?{max:e}:e)||{}).max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[o]=e.max||1/0;var t=e.length||p;if(this[l]="function"!=typeof t?p:t,this[s]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[u]=e.maxAge||0,this[c]=e.dispose,this[h]=e.noDisposeOnSet||!1,this[i]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[o]=e||1/0,y(this)}get max(){return this[o]}set allowStale(e){this[s]=!!e}get allowStale(){return this[s]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[u]=e,y(this)}get maxAge(){return this[u]}set lengthCalculator(e){(e="function"!=typeof e?p:e)!==this[l]&&(this[l]=e,this[a]=0,this[d].forEach(e=>{e.length=this[l](e.value,e.key),this[a]+=e.length})),y(this)}get lengthCalculator(){return this[l]}get length(){return this[a]}get itemCount(){return this[d].length}rforEach(t,n){n=n||this;for(let e=this[d].tail;null!==e;){var r=e.prev;_(this,t,e,n),e=r}}forEach(t,n){n=n||this;for(let e=this[d].head;null!==e;){var r=e.next;_(this,t,e,n),e=r}}keys(){return this[d].toArray().map(e=>e.key)}values(){return this[d].toArray().map(e=>e.value)}reset(){this[c]&&this[d]&&this[d].length&&this[d].forEach(e=>this[c](e.key,e.value)),this[f]=new Map,this[d]=new r,this[a]=0}dump(){return this[d].map(e=>!m(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[d]}set(e,t,n){if((n=n||this[u])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");var r,i=n?Date.now():0,s=this[l](t,e);return this[f].has(e)?s>this[o]?(b(this,this[f].get(e)),!1):(r=this[f].get(e).value,this[c]&&!this[h]&&this[c](e,r.value),r.now=i,r.maxAge=n,r.value=t,this[a]+=s-r.length,r.length=s,this.get(e),y(this),!0):(r=new v(e,t,s,i,n)).length>this[o]?(this[c]&&this[c](e,t),!1):(this[a]+=r.length,this[d].unshift(r),this[f].set(e,this[d].head),y(this),!0)}has(e){return!!this[f].has(e)&&(e=this[f].get(e).value,!m(this,e))}get(e){return g(this,e,!0)}peek(e){return g(this,e,!1)}pop(){var e=this[d].tail;return e?(b(this,e),e.value):null}del(e){b(this,this[f].get(e))}load(t){this.reset();var n=Date.now();for(let e=t.length-1;0<=e;e--){var r=t[e],i=r.e||0;0===i?this.set(r.k,r.v):0<(i=i-n)&&this.set(r.k,r.v,i)}}prune(){this[f].forEach((e,t)=>g(this,t,!1))}}},{yallist:90}],45:[function(e,a,t){!function(o){!function(){const s=a.exports;s.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},s.codes={};for(const r in s.types){var e=s.types[r];s.codes[e]=r}s.CMD_SHIFT=4,s.CMD_MASK=240,s.DUP_MASK=8,s.QOS_MASK=3,s.QOS_SHIFT=1,s.RETAIN_MASK=1,s.VARBYTEINT_MASK=127,s.VARBYTEINT_FIN_MASK=128,s.VARBYTEINT_MAX=268435455,s.SESSIONPRESENT_MASK=1,s.SESSIONPRESENT_HEADER=o.from([s.SESSIONPRESENT_MASK]),s.CONNACK_HEADER=o.from([s.codes.connack<<s.CMD_SHIFT]),s.USERNAME_MASK=128,s.PASSWORD_MASK=64,s.WILL_RETAIN_MASK=32,s.WILL_QOS_MASK=24,s.WILL_QOS_SHIFT=3,s.WILL_FLAG_MASK=4,s.CLEAN_SESSION_MASK=2,s.CONNECT_HEADER=o.from([s.codes.connect<<s.CMD_SHIFT]),s.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},s.propertiesCodes={};for(const i in s.properties){var t=s.properties[i];s.propertiesCodes[t]=i}function n(i){return[0,1,2].map(r=>[0,1].map(n=>[0,1].map(e=>{var t=o.alloc(1);return t.writeUInt8(s.codes[i]<<s.CMD_SHIFT|(n?s.DUP_MASK:0)|r<<s.QOS_SHIFT|e,0,!0),t})))}s.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"},s.PUBLISH_HEADER=n("publish"),s.SUBSCRIBE_HEADER=n("subscribe"),s.SUBSCRIBE_OPTIONS_QOS_MASK=3,s.SUBSCRIBE_OPTIONS_NL_MASK=1,s.SUBSCRIBE_OPTIONS_NL_SHIFT=2,s.SUBSCRIBE_OPTIONS_RAP_MASK=1,s.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,s.SUBSCRIBE_OPTIONS_RH_MASK=3,s.SUBSCRIBE_OPTIONS_RH_SHIFT=4,s.SUBSCRIBE_OPTIONS_RH=[0,16,32],s.SUBSCRIBE_OPTIONS_NL=4,s.SUBSCRIBE_OPTIONS_RAP=8,s.SUBSCRIBE_OPTIONS_QOS=[0,1,2],s.UNSUBSCRIBE_HEADER=n("unsubscribe"),s.ACKS={unsuback:n("unsuback"),puback:n("puback"),pubcomp:n("pubcomp"),pubrel:n("pubrel"),pubrec:n("pubrec")},s.SUBACK_HEADER=o.from([s.codes.suback<<s.CMD_SHIFT]),s.VERSION3=o.from([3]),s.VERSION4=o.from([4]),s.VERSION5=o.from([5]),s.VERSION131=o.from([131]),s.VERSION132=o.from([132]),s.QOS=[0,1,2].map(e=>o.from([e])),s.EMPTY={pingreq:o.from([s.codes.pingreq<<4,0]),pingresp:o.from([s.codes.pingresp<<4,0]),disconnect:o.from([s.codes.disconnect<<4,0])}}.call(this)}.call(this,e("buffer").Buffer)},{buffer:17}],46:[function(t,n,e){!function(o){!function(){const r=t("./writeToStream");var e=t("events");class i extends e{constructor(){super(),this._array=new Array(20),this._i=0}write(e){return this._array[this._i++]=e,!0}concat(){let e=0;var t=new Array(this._array.length),n=this._array;let r=0,i;for(i=0;i<n.length&&void 0!==n[i];i++)"string"!=typeof n[i]?t[i]=n[i].length:t[i]=o.byteLength(n[i]),e+=t[i];var s=o.allocUnsafe(e);for(i=0;i<n.length&&void 0!==n[i];i++)"string"!=typeof n[i]?n[i].copy(s,r):s.write(n[i],r),r+=t[i];return s}}n.exports=function(e,t){var n=new i;return r(e,n,t),n.concat()}}.call(this)}.call(this,t("buffer").Buffer)},{"./writeToStream":51,buffer:17,events:22}],47:[function(e,t,n){n.parser=e("./parser").parser,n.generate=e("./generate"),n.writeToStream=e("./writeToStream")},{"./generate":46,"./parser":50,"./writeToStream":51}],48:[function(e,r,t){!function(s){!function(){const t={},i=s.isBuffer(s.from([1,2]).subarray(0,1));function n(e){var t=s.allocUnsafe(2);return t.writeUInt8(e>>8,0),t.writeUInt8(255&e,1),t}r.exports={cache:t,generateCache:function(){for(let e=0;e<65536;e++)t[e]=n(e)},generateNumber:n,genBufVariableByteInt:function(e){let t=0,n=0;for(var r=s.allocUnsafe(4);t=e%128|0,0<(e=e/128|0)&&(t|=128),r.writeUInt8(t,n++),0<e&&n<4;);return 0<e&&(n=0),i?r.subarray(0,n):r.slice(0,n)},generate4ByteBuffer:function(e){var t=s.allocUnsafe(4);return t.writeUInt32BE(e,0),t}}}.call(this)}.call(this,e("buffer").Buffer)},{buffer:17}],49:[function(e,t,n){t.exports=class{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}}},{}],50:[function(e,t,n){const r=e("bl");var i=e("events");const s=e("./packet"),a=e("./constants"),l=e("debug")("mqtt-packet:parser");class o extends i{constructor(){super(),this.parser=this.constructor.parser}static parser(e){return this instanceof o?(this.settings=e||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):(new o).parser(e)}_resetState(){l("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new s,this.error=null,this._list=r(),this._stateCounter=0}parse(e){for(this.error&&this._resetState(),this._list.append(e),l("parse: current state: %s",this._states[this._stateCounter]);(-1!==this.packet.length||0<this._list.length)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,l("parse: state complete. _stateCounter is now: %d",this._stateCounter),l("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return l("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){var e=this._list.readUInt8(0);return this.packet.cmd=a.types[e>>a.CMD_SHIFT],this.packet.retain=0!=(e&a.RETAIN_MASK),this.packet.qos=e>>a.QOS_SHIFT&a.QOS_MASK,this.packet.dup=0!=(e&a.DUP_MASK),l("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0}_parseLength(){var e=this._parseVarByteNum(!0);return e&&(this.packet.length=e.value,this._list.consume(e.bytes)),l("_parseLength %d",e.value),!!e}_parsePayload(){l("_parsePayload: payload %O",this._list);let e=!1;if(0===this.packet.length||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}e=!0}return l("_parsePayload complete result: %s",e),e}_parseConnect(){l("_parseConnect");var e={},t=this.packet,n=this._parseString();if(null===n)return this._emitError(new Error("Cannot parse protocolId"));if("MQTT"!==n&&"MQIsdp"!==n)return this._emitError(new Error("Invalid protocolId"));if(t.protocolId=n,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(t.protocolVersion=this._list.readUInt8(this._pos),128<=t.protocolVersion&&(t.bridgeMode=!0,t.protocolVersion=t.protocolVersion-128),3!==t.protocolVersion&&4!==t.protocolVersion&&5!==t.protocolVersion)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(e.username=this._list.readUInt8(this._pos)&a.USERNAME_MASK,e.password=this._list.readUInt8(this._pos)&a.PASSWORD_MASK,e.will=this._list.readUInt8(this._pos)&a.WILL_FLAG_MASK,e.will&&(t.will={},t.will.retain=0!=(this._list.readUInt8(this._pos)&a.WILL_RETAIN_MASK),t.will.qos=(this._list.readUInt8(this._pos)&a.WILL_QOS_MASK)>>a.WILL_QOS_SHIFT),t.clean=0!=(this._list.readUInt8(this._pos)&a.CLEAN_SESSION_MASK),this._pos++,t.keepalive=this._parseNum(),-1===t.keepalive)return this._emitError(new Error("Packet too short"));5===t.protocolVersion&&(n=this._parseProperties(),Object.getOwnPropertyNames(n).length)&&(t.properties=n);var n=this._parseString();if(null===n)return this._emitError(new Error("Packet too short"));if(t.clientId=n,l("_parseConnect: packet.clientId: %s",t.clientId),e.will){if(5===t.protocolVersion&&(n=this._parseProperties(),Object.getOwnPropertyNames(n).length)&&(t.will.properties=n),null===(n=this._parseString()))return this._emitError(new Error("Cannot parse will topic"));if(t.will.topic=n,l("_parseConnect: packet.will.topic: %s",t.will.topic),null===(n=this._parseBuffer()))return this._emitError(new Error("Cannot parse will payload"));t.will.payload=n,l("_parseConnect: packet.will.paylaod: %s",t.will.payload)}if(e.username){if(null===(n=this._parseString()))return this._emitError(new Error("Cannot parse username"));t.username=n,l("_parseConnect: packet.username: %s",t.username)}if(e.password){if(null===(n=this._parseBuffer()))return this._emitError(new Error("Cannot parse password"));t.password=n}return this.settings=t,l("_parseConnect: complete"),t}_parseConnack(){l("_parseConnack");var e,t=this.packet;if(this._list.length<1)return null;if(t.sessionPresent=!!(this._list.readUInt8(this._pos++)&a.SESSIONPRESENT_MASK),5===this.settings.protocolVersion)2<=this._list.length?t.reasonCode=this._list.readUInt8(this._pos++):t.reasonCode=0;else{if(this._list.length<2)return null;t.returnCode=this._list.readUInt8(this._pos++)}if(-1===t.returnCode||-1===t.reasonCode)return this._emitError(new Error("Cannot parse return code"));5===this.settings.protocolVersion&&(e=this._parseProperties(),Object.getOwnPropertyNames(e).length)&&(t.properties=e),l("_parseConnack: complete")}_parsePublish(){l("_parsePublish");var e,t=this.packet;if(t.topic=this._parseString(),null===t.topic)return this._emitError(new Error("Cannot parse topic"));0<t.qos&&!this._parseMessageId()||(5===this.settings.protocolVersion&&(e=this._parseProperties(),Object.getOwnPropertyNames(e).length)&&(t.properties=e),t.payload=this._list.slice(this._pos,t.length),l("_parsePublish: payload from buffer list: %o",t.payload))}_parseSubscribe(){l("_parseSubscribe");var e,t,n,r,i,s,o=this.packet;if(1!==o.qos)return this._emitError(new Error("Wrong subscribe header"));if(o.subscriptions=[],this._parseMessageId())for(5===this.settings.protocolVersion&&(s=this._parseProperties(),Object.getOwnPropertyNames(s).length)&&(o.properties=s);this._pos<o.length;){if(null===(i=this._parseString()))return this._emitError(new Error("Cannot parse topic"));if(this._pos>=o.length)return this._emitError(new Error("Malformed Subscribe Payload"));e=(t=this._parseByte())&a.SUBSCRIBE_OPTIONS_QOS_MASK,r=0!=(t>>a.SUBSCRIBE_OPTIONS_NL_SHIFT&a.SUBSCRIBE_OPTIONS_NL_MASK),n=0!=(t>>a.SUBSCRIBE_OPTIONS_RAP_SHIFT&a.SUBSCRIBE_OPTIONS_RAP_MASK),t=t>>a.SUBSCRIBE_OPTIONS_RH_SHIFT&a.SUBSCRIBE_OPTIONS_RH_MASK,i={topic:i,qos:e},5===this.settings.protocolVersion?(i.nl=r,i.rap=n,i.rh=t):this.settings.bridgeMode&&(i.rh=0,i.rap=!0,i.nl=!0),l("_parseSubscribe: push subscription `%s` to subscription",i),o.subscriptions.push(i)}}_parseSuback(){l("_parseSuback");var e,t=this.packet;if(this.packet.granted=[],this._parseMessageId())for(5===this.settings.protocolVersion&&(e=this._parseProperties(),Object.getOwnPropertyNames(e).length)&&(t.properties=e);this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))}_parseUnsubscribe(){l("_parseUnsubscribe");var e,t=this.packet;if(t.unsubscriptions=[],this._parseMessageId())for(5===this.settings.protocolVersion&&(e=this._parseProperties(),Object.getOwnPropertyNames(e).length)&&(t.properties=e);this._pos<t.length;){var n=this._parseString();if(null===n)return this._emitError(new Error("Cannot parse topic"));l("_parseUnsubscribe: push topic `%s` to unsubscriptions",n),t.unsubscriptions.push(n)}}_parseUnsuback(){l("_parseUnsuback");var e=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if(5===this.settings.protocolVersion){var t=this._parseProperties();for(Object.getOwnPropertyNames(t).length&&(e.properties=t),e.granted=[];this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))}}_parseConfirmation(){l("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);var e,t=this.packet;return this._parseMessageId(),5===this.settings.protocolVersion&&(2<t.length?(t.reasonCode=this._parseByte(),l("_parseConfirmation: packet.reasonCode `%d`",t.reasonCode)):t.reasonCode=0,3<t.length)&&(e=this._parseProperties(),Object.getOwnPropertyNames(e).length)&&(t.properties=e),!0}_parseDisconnect(){var e,t=this.packet;return l("_parseDisconnect"),5===this.settings.protocolVersion&&(0<this._list.length?t.reasonCode=this._parseByte():t.reasonCode=0,e=this._parseProperties(),Object.getOwnPropertyNames(e).length)&&(t.properties=e),l("_parseDisconnect result: true"),!0}_parseAuth(){l("_parseAuth");var e=this.packet;if(5!==this.settings.protocolVersion)return this._emitError(new Error("Not supported auth packet for this version MQTT"));e.reasonCode=this._parseByte();var t=this._parseProperties();return Object.getOwnPropertyNames(t).length&&(e.properties=t),l("_parseAuth: result: true"),!0}_parseMessageId(){var e=this.packet;return e.messageId=this._parseNum(),null===e.messageId?(this._emitError(new Error("Cannot parse messageId")),!1):(l("_parseMessageId: packet.messageId %d",e.messageId),!0)}_parseString(e){var t=this._parseNum(),n=t+this._pos;return-1===t||n>this._list.length||n>this.packet.length?null:(n=this._list.toString("utf8",this._pos,n),this._pos+=t,l("_parseString: result: %s",n),n)}_parseStringPair(){return l("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){var e=this._parseNum(),t=e+this._pos;return-1===e||t>this._list.length||t>this.packet.length?null:(t=this._list.slice(this._pos,t),this._pos+=e,l("_parseBuffer: result: %o",t),t)}_parseNum(){var e;return this._list.length-this._pos<2?-1:(e=this._list.readUInt16BE(this._pos),this._pos+=2,l("_parseNum: result: %s",e),e)}_parse4ByteNum(){var e;return this._list.length-this._pos<4?-1:(e=this._list.readUInt32BE(this._pos),this._pos+=4,l("_parse4ByteNum: result: %s",e),e)}_parseVarByteNum(e){l("_parseVarByteNum");var t;let n=0,r=1,i=0,s=!1;for(var o=this._pos||0;n<4&&o+n<this._list.length;){if(t=this._list.readUInt8(o+n++),i+=r*(t&a.VARBYTEINT_MASK),r*=128,0==(t&a.VARBYTEINT_FIN_MASK)){s=!0;break}if(this._list.length<=n)break}return!s&&4===n&&this._list.length>=n&&this._emitError(new Error("Invalid variable byte integer")),o&&(this._pos+=n),s=!!s&&(e?{bytes:n,value:i}:i),l("_parseVarByteNum: result: %o",s),s}_parseByte(){let e;return this._pos<this._list.length&&(e=this._list.readUInt8(this._pos),this._pos++),l("_parseByte: result: %o",e),e}_parseByType(e){switch(l("_parseByType: type: %s",e),e){case"byte":return 0!==this._parseByte();case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){l("_parseProperties");for(var e=this._parseVarByteNum(),t=this._pos+e,n={};this._pos<t;){var r=this._parseByte();if(!r)return this._emitError(new Error("Cannot parse property code type")),!1;var i,s,r=a.propertiesCodes[r];if(!r)return this._emitError(new Error("Unknown property")),!1;"userProperties"===r?(n[r]||(n[r]=Object.create(null)),i=this._parseByType(a.propertiesTypes[r]),n[r][i.name]?(Array.isArray(n[r][i.name])||(s=n[r][i.name],n[r][i.name]=[s]),n[r][i.name].push(i.value)):n[r][i.name]=i.value):n[r]?(Array.isArray(n[r])||(n[r]=[n[r]]),n[r].push(this._parseByType(a.propertiesTypes[r]))):n[r]=this._parseByType(a.propertiesTypes[r])}return n}_newPacket(){return l("_newPacket"),this.packet&&(this._list.consume(this.packet.length),l("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),l("_newPacket: new packet"),this.packet=new s,!(this._pos=0)}_emitError(e){l("_emitError"),this.error=e,this.emit("error",e)}}t.exports=o},{"./constants":45,"./packet":49,bl:15,debug:18,events:22}],51:[function(d,f,e){!function(ge){!function(){const X=d("./constants"),ee=ge.allocUnsafe(0),te=ge.from([0]);var e=d("./numbers");const ne=d("process-nextick-args").nextTick,re=d("debug")("mqtt-packet:writeToStream"),n=e.cache,r=e.generateNumber,ie=e.generateCache,a=e.genBufVariableByteInt,s=e.generate4ByteBuffer;let se=l,oe=!0;function t(i,s,r){switch(re("generate called"),s.cork&&(s.cork(),ne(ae,s)),oe&&(oe=!1,ie()),re("generate: packet.cmd: %s",i.cmd),i.cmd){case"connect":{var o=i;var a=s;var o=o||{},l=o.protocolId||"MQTT";let e=o.protocolVersion||4;var u=o.will;let t=o.clean;var c=o.keepalive||0,h=o.clientId||"",d=o.username,f=o.password,p=o.properties;void 0===t&&(t=!0);let n=0;{if(!l||"string"!=typeof l&&!ge.isBuffer(l))return a.emit("error",new Error("Invalid protocolId")),!1;n+=l.length+2}{if(3!==e&&4!==e&&5!==e)return a.emit("error",new Error("Invalid protocol version")),!1;n+=1}if(("string"==typeof h||ge.isBuffer(h))&&(h||4<=e)&&(h||t))n+=ge.byteLength(h)+2;else{if(e<4)return a.emit("error",new Error("clientId must be supplied before 3.1.1")),!1;if(0==+t)return a.emit("error",new Error("clientId must be given if cleanSession set to 0")),!1}{if("number"!=typeof c||c<0||65535<c||c%1!=0)return a.emit("error",new Error("Invalid keepalive")),!1;n+=2}if(n+=1,5===e){var j=he(a,p);if(!j)return!1;n+=j.length}if(u){if("object"!=typeof u)return a.emit("error",new Error("Invalid will")),!1;if(!u.topic||"string"!=typeof u.topic)return a.emit("error",new Error("Invalid will topic")),!1;if(n=n+(ge.byteLength(u.topic)+2)+2,u.payload){if(!(0<=u.payload.length))return a.emit("error",new Error("Invalid will payload")),!1;"string"==typeof u.payload?n+=ge.byteLength(u.payload):n+=u.payload.length}var g={};if(5===e){if(!(g=he(a,u.properties)))return!1;n+=g.length}}let r=!1;if(null!=d){if(!pe(d))return a.emit("error",new Error("Invalid username")),!1;r=!0,n+=ge.byteLength(d)+2}if(null!=f){if(!r)return a.emit("error",new Error("Username is required to use password")),!1;if(!pe(f))return a.emit("error",new Error("Invalid password")),!1;n+=fe(f)+2}a.write(X.CONNECT_HEADER),le(a,n),ce(a,l),o.bridgeMode&&(e+=128);a.write(131===e?X.VERSION131:132===e?X.VERSION132:4===e?X.VERSION4:5===e?X.VERSION5:X.VERSION3);p=0;p=(p=(p=(p=(p=(p|=null!=d?X.USERNAME_MASK:0)|(null!=f?X.PASSWORD_MASK:0))|(u&&u.retain?X.WILL_RETAIN_MASK:0))|(u&&u.qos?u.qos<<X.WILL_QOS_SHIFT:0))|(u?X.WILL_FLAG_MASK:0))|(t?X.CLEAN_SESSION_MASK:0),a.write(ge.from([p])),se(a,c),5===e&&j.write();ce(a,h),u&&(5===e&&g.write(),ue(a,u.topic),ce(a,u.payload));null!=d&&ce(a,d);null!=f&&ce(a,f);return!0;return}case"connack":{l=i;o=s;p=r;p=p?p.protocolVersion:4,l=l||{},c=5===p?l.reasonCode:l.returnCode,j=l.properties;let e=2;if("number"!=typeof c)return o.emit("error",new Error("Invalid return code")),!1;let t=null;if(5===p){if(!(t=he(o,j)))return!1;e+=t.length}o.write(X.CONNACK_HEADER),le(o,e),o.write(l.sessionPresent?X.SESSIONPRESENT_HEADER:te),o.write(ge.from([c])),null!=t&&t.write();return!0;return}case"publish":{h=i;g=s;u=r;re("publish: packet: %o",h);var u=u?u.protocolVersion:4,h=h||{},d=h.qos||0,a=h.retain?X.RETAIN_MASK:0,f=h.topic,m=h.payload||ee,y=h.messageId,b=h.properties;let e=0;if("string"==typeof f)e+=ge.byteLength(f)+2;else{if(!ge.isBuffer(f))return g.emit("error",new Error("Invalid topic")),!1;e+=f.length+2}ge.isBuffer(m)?e+=m.length:e+=ge.byteLength(m);{if(d&&"number"!=typeof y)return g.emit("error",new Error("Invalid messageId")),!1;d&&(e+=2)}let t=null;if(5===u){if(!(t=he(g,b)))return!1;e+=t.length}g.write(X.PUBLISH_HEADER[d][h.dup?1:0][a?1:0]),le(g,e),se(g,fe(f)),g.write(f),0<d&&se(g,y);null!=t&&t.write();return re("publish: payload: %o",m),g.write(m);return}case"puback":case"pubrec":case"pubrel":case"pubcomp":{b=i;y=s;m=r;var v=m?m.protocolVersion:4,b=b||{},_=b.cmd||"puback",D=b.messageId,w=b.dup&&"pubrel"===_?X.DUP_MASK:0;let e=0;var U=b.reasonCode,b=b.properties;let t=5===v?3:2;"pubrel"===_&&(e=1);if("number"!=typeof D)return y.emit("error",new Error("Invalid messageId")),!1;let n=null;if(5===v&&"object"==typeof b){if(!(n=de(y,b,m,t)))return!1;t+=n.length}y.write(X.ACKS[_][e][w][0]),le(y,t),se(y,D),5===v&&y.write(ge.from([U]));null!==n&&n.write();return!0;return}case"subscribe":{_=i;var S=s;w=r;re("subscribe: packet: ");var q=w?w.protocolVersion:4,w=_||{},_=w.dup?X.DUP_MASK:0,D=w.messageId,k=w.subscriptions,w=w.properties;let t=0;{if("number"!=typeof D)return S.emit("error",new Error("Invalid messageId")),!1;t+=2}let e=null;if(5===q){if(!(e=he(S,w)))return!1;t+=e.length}{if("object"!=typeof k||!k.length)return S.emit("error",new Error("Invalid subscriptions")),!1;for(let e=0;e<k.length;e+=1){var F=k[e].topic,$=k[e].qos;if("string"!=typeof F)return S.emit("error",new Error("Invalid subscriptions - invalid topic")),!1;if("number"!=typeof $)return S.emit("error",new Error("Invalid subscriptions - invalid qos")),!1;if(5===q){if("boolean"!=typeof(k[e].nl||!1))return S.emit("error",new Error("Invalid subscriptions - invalid No Local")),!1;if("boolean"!=typeof(k[e].rap||!1))return S.emit("error",new Error("Invalid subscriptions - invalid Retain as Published")),!1;$=k[e].rh||0;if("number"!=typeof $||2<$)return S.emit("error",new Error("Invalid subscriptions - invalid Retain Handling")),!1}t+=ge.byteLength(F)+2+1}}re("subscribe: writing to stream: %o",X.SUBSCRIBE_HEADER),S.write(X.SUBSCRIBE_HEADER[1][_?1:0][0]),le(S,t),se(S,D),null!==e&&e.write();let n=!0;for(const L of k){var V=L.topic,z=L.qos,H=+L.nl,W=+L.rap,Q=L.rh;let e;ue(S,V),e=X.SUBSCRIBE_OPTIONS_QOS[z],5===q&&(e=(e=(e|=H?X.SUBSCRIBE_OPTIONS_NL:0)|(W?X.SUBSCRIBE_OPTIONS_RAP:0))|(Q?X.SUBSCRIBE_OPTIONS_RH[Q]:0)),n=S.write(ge.from([e]))}return n;return}case"suback":{v=i;var n=s;U=r;var E=U?U.protocolVersion:4,v=v||{},x=v.messageId,K=v.granted,v=v.properties;let t=0;{if("number"!=typeof x)return n.emit("error",new Error("Invalid messageId")),!1;t+=2}{if("object"!=typeof K||!K.length)return n.emit("error",new Error("Invalid qos vector")),!1;for(let e=0;e<K.length;e+=1){if("number"!=typeof K[e])return n.emit("error",new Error("Invalid qos vector")),!1;t+=1}}let e=null;if(5===E){if(!(e=de(n,v,U,t)))return!1;t+=e.length}n.write(X.SUBACK_HEADER),le(n,t),se(n,x),null!==e&&e.write();return n.write(ge.from(K));return}case"unsubscribe":{E=i;var C=s;x=r;var x=x?x.protocolVersion:4,E=E||{},I=E.messageId,T=E.dup?X.DUP_MASK:0,A=E.unsubscriptions,E=E.properties;let t=0;{if("number"!=typeof I)return C.emit("error",new Error("Invalid messageId")),!1;t+=2}{if("object"!=typeof A||!A.length)return C.emit("error",new Error("Invalid unsubscriptions")),!1;for(let e=0;e<A.length;e+=1){if("string"!=typeof A[e])return C.emit("error",new Error("Invalid unsubscriptions")),!1;t+=ge.byteLength(A[e])+2}}let e=null;if(5===x){if(!(e=he(C,E)))return!1;t+=e.length}C.write(X.UNSUBSCRIBE_HEADER[1][T?1:0][0]),le(C,t),se(C,I),null!==e&&e.write();let n=!0;for(let e=0;e<A.length;e++)n=ue(C,A[e]);return n;return}case"unsuback":{T=i;var P=s;I=r;var B=I?I.protocolVersion:4,T=T||{},O=T.messageId,R=T.dup?X.DUP_MASK:0,J=T.granted,G=T.properties,T=T.cmd;let t=2;if("number"!=typeof O)return P.emit("error",new Error("Invalid messageId")),!1;if(5===B){if("object"!=typeof J||!J.length)return P.emit("error",new Error("Invalid qos vector")),!1;for(let e=0;e<J.length;e+=1){if("number"!=typeof J[e])return P.emit("error",new Error("Invalid qos vector")),!1;t+=1}}let e=null;if(5===B){if(!(e=de(P,G,I,t)))return!1;t+=e.length}P.write(X.ACKS[T][0][R][0]),le(P,t),se(P,O),null!==e&&e.write();5===B&&P.write(ge.from(J));return!0;return}case"pingreq":case"pingresp":return G=i,s.write(X.EMPTY[G.cmd]);case"disconnect":{R=i;O=s;B=r;var M=B?B.protocolVersion:4,R=R||{},N=R.reasonCode,R=R.properties;let e=5===M?1:0,t=null;if(5===M){if(!(t=de(O,R,B,e)))return!1;e+=t.length}O.write(ge.from([X.codes.disconnect<<4])),le(O,e),5===M&&O.write(ge.from([N]));null!==t&&t.write();return!0;return}case"auth":var M=i,N=s,t=r,e=t?t.protocolVersion:4,Y=(M=M||{}).reasonCode,M=M.properties,Z=5===e?1:0;return(5!==e&&N.emit("error",new Error("Invalid mqtt version for auth packet")),e=de(N,M,t,Z))?(Z+=e.length,N.write(ge.from([X.codes.auth<<4])),le(N,Z),N.write(ge.from([Y])),null!==e&&e.write(),!0):!1;default:return s.emit("error",new Error("Unknown command")),!1}}function ae(e){e.uncork()}Object.defineProperty(t,"cacheNumbers",{get(){return se===l},set(e){se=e?(n&&0!==Object.keys(n).length||(oe=!0),l):(oe=!1,u)}});const i={};function le(t,n){if(n>X.VARBYTEINT_MAX)t.emit("error",new Error("Invalid variable byte integer: "+n));else{let e=i[n];e||(e=a(n),n<16384&&(i[n]=e)),re("writeVarByteInt: writing to stream: %o",e),t.write(e)}}function ue(e,t){var n=ge.byteLength(t);return se(e,n),re("writeString: %s",t),e.write(t,"utf8")}function o(e,t,n){ue(e,t),ue(e,n)}function l(e,t){return re("writeNumberCached: number: %d",t),re("writeNumberCached: %o",n[t]),e.write(n[t])}function u(e,t){t=r(t);return re("writeNumberGenerated: %o",t),e.write(t)}function ce(e,t){"string"==typeof t?ue(e,t):t?(se(e,t.length),e.write(t)):se(e,0)}function he(n,e){if("object"!=typeof e||null!=e.length)return{length:1,write(){h(n,{},0)}};let r=0;function i(e,r){let t=0;switch(X.propertiesTypes[e]){case"byte":if("boolean"!=typeof r)return n.emit("error",new Error(`Invalid ${e}: `+r)),!1;t+=2;break;case"int8":if("number"!=typeof r||r<0||255<r)return n.emit("error",new Error(`Invalid ${e}: `+r)),!1;t+=2;break;case"binary":if(r&&null===r)return n.emit("error",new Error(`Invalid ${e}: `+r)),!1;t+=1+ge.byteLength(r)+2;break;case"int16":if("number"!=typeof r||r<0||65535<r)return n.emit("error",new Error(`Invalid ${e}: `+r)),!1;t+=3;break;case"int32":if("number"!=typeof r||r<0||4294967295<r)return n.emit("error",new Error(`Invalid ${e}: `+r)),!1;t+=5;break;case"var":if("number"!=typeof r||r<0||268435455<r)return n.emit("error",new Error(`Invalid ${e}: `+r)),!1;t+=1+ge.byteLength(a(r));break;case"string":if("string"!=typeof r)return n.emit("error",new Error(`Invalid ${e}: `+r)),!1;t+=3+ge.byteLength(r.toString());break;case"pair":if("object"!=typeof r)return n.emit("error",new Error(`Invalid ${e}: `+r)),!1;t+=Object.getOwnPropertyNames(r).reduce((e,n)=>{var t=r[n];return Array.isArray(t)?e+=t.reduce((e,t)=>e+=3+ge.byteLength(n.toString())+2+ge.byteLength(t.toString()),0):e+=3+ge.byteLength(n.toString())+2+ge.byteLength(r[n].toString()),e},0);break;default:return n.emit("error",new Error(`Invalid property ${e}: `+r)),!1}return t}if(e)for(const o in e){let t=0,n=0;var s=e[o];if(Array.isArray(s))for(let e=0;e<s.length;e++){if(!(n=i(o,s[e])))return!1;t+=n}else{if(!(n=i(o,s)))return!1;t=n}if(!t)return!1;r+=t}return{length:ge.byteLength(a(r))+r,write(){h(n,e,r)}}}function de(e,t,n,r){var i=["reasonString","userProperties"],s=n&&n.properties&&n.properties.maximumPacketSize?n.properties.maximumPacketSize:0;let o=he(e,t);if(s)for(;r+o.length>s;){var a=i.shift();if(!a||!t[a])return!1;delete t[a],o=he(e,t)}return o}function c(n,r,i){var e,t;switch(X.propertiesTypes[r]){case"byte":n.write(ge.from([X.properties[r]])),n.write(ge.from([+i]));break;case"int8":n.write(ge.from([X.properties[r]])),n.write(ge.from([i]));break;case"binary":n.write(ge.from([X.properties[r]])),ce(n,i);break;case"int16":n.write(ge.from([X.properties[r]])),se(n,i);break;case"int32":n.write(ge.from([X.properties[r]])),e=n,t=i,t=s(t),re("write4ByteNumber: %o",t),e.write(t);break;case"var":n.write(ge.from([X.properties[r]])),le(n,i);break;case"string":n.write(ge.from([X.properties[r]])),ue(n,i);break;case"pair":Object.getOwnPropertyNames(i).forEach(t=>{var e=i[t];Array.isArray(e)?e.forEach(e=>{n.write(ge.from([X.properties[r]])),o(n,t.toString(),e.toString())}):(n.write(ge.from([X.properties[r]])),o(n,t.toString(),e.toString()))});break;default:n.emit("error",new Error(`Invalid property ${r} value: `+i))}}function h(t,e,n){le(t,n);for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&null!==e[i]){var r=e[i];if(Array.isArray(r))for(let e=0;e<r.length;e++)c(t,i,r[e]);else c(t,i,r)}}function fe(e){return e?e instanceof ge?e.length:ge.byteLength(e):0}function pe(e){return"string"==typeof e||e instanceof ge}f.exports=t}.call(this)}.call(this,d("buffer").Buffer)},{"./constants":45,"./numbers":48,buffer:17,debug:18,"process-nextick-args":56}],52:[function(e,t,n){var i=36e5,s=864e5;function o(e,t,n,r){t=1.5*n<=t;return Math.round(e/n)+" "+r+(t?"s":"")}t.exports=function(e,t){t=t||{};var n=typeof e;if(!("string"==n&&0<e.length)){if("number"==n&&isFinite(e))return(t.long?function(e){var t=Math.abs(e);if(s<=t)return o(e,t,s,"day");if(i<=t)return o(e,t,i,"hour");if(6e4<=t)return o(e,t,6e4,"minute");if(1e3<=t)return o(e,t,1e3,"second");return e+" ms"}:function(e){var t=Math.abs(e);if(s<=t)return Math.round(e/s)+"d";if(i<=t)return Math.round(e/i)+"h";if(6e4<=t)return Math.round(e/6e4)+"m";if(1e3<=t)return Math.round(e/1e3)+"s";return e+"ms"})(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}n=e;if(!(100<(n=String(n)).length)){n=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(n);if(n){var r=parseFloat(n[1]);switch((n[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return r*s;case"hours":case"hour":case"hrs":case"hr":case"h":return r*i;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}},{}],53:[function(e,t,n){e=e("./lib/number-allocator.js");t.exports.NumberAllocator=e},{"./lib/number-allocator.js":54}],54:[function(e,t,n){"use strict";const r=e("js-sdsl").OrderedSet,a=e("debug")("number-allocator:trace"),l=e("debug")("number-allocator:error");function u(e,t){this.low=e,this.high=t}function i(e,t){if(!(this instanceof i))return new i(e,t);this.min=e,this.max=t,this.ss=new r([],(e,t)=>e.compare(t)),a("Create"),this.clear()}u.prototype.equals=function(e){return this.low===e.low&&this.high===e.high},u.prototype.compare=function(e){return this.low<e.low&&this.high<e.low?-1:e.low<this.low&&e.high<this.low?1:0},i.prototype.firstVacant=function(){return 0===this.ss.size()?null:this.ss.front().low},i.prototype.alloc=function(){var e,t,n,r;return 0===this.ss.size()?(a("alloc():empty"),null):((r=t=(e=this.ss.begin()).pointer.low)+1<=(n=e.pointer.high)?this.ss.updateKeyByIterator(e,new u(t+1,n)):this.ss.eraseElementByPos(0),a("alloc():"+r),r)},i.prototype.use=function(e){var t=new u(e,e),n=this.ss.lowerBound(t);if(n.equals(this.ss.end()))return a("use():failed"),!1;var r=n.pointer.low,i=n.pointer.high;if(n.pointer.equals(t))this.ss.eraseElementByIterator(n);else{if(e<r)return!1;r===e?this.ss.updateKeyByIterator(n,new u(r+1,i)):i===e?this.ss.updateKeyByIterator(n,new u(r,i-1)):(this.ss.updateKeyByIterator(n,new u(e+1,i)),this.ss.insert(new u(r,e-1)))}return a("use():"+e),!0},i.prototype.free=function(e){if(e<this.min||e>this.max)l("free():"+e+" is out of range");else{var t,n,r,i=new u(e,e),s=this.ss.upperBound(i);if(s.equals(this.ss.end())){if(s.equals(this.ss.begin()))return void this.ss.insert(i);s.pre();var o=s.pointer.high;s.pointer.high+1===e?this.ss.updateKeyByIterator(s,new u(o,e)):this.ss.insert(i)}else s.equals(this.ss.begin())?e+1===s.pointer.low?(o=s.pointer.high-1,t=s.pointer.high,this.ss.updateKeyByIterator(s,new u(o,t))):this.ss.insert(i):(o=s.pointer.low,t=s.pointer.high,s.pre(),n=s.pointer.low,s.pointer.high+1===e?e+1===o?(this.ss.eraseElementByIterator(s),r=s.pointer.high,this.ss.updateKeyByIterator(s,new u(n,r))):this.ss.updateKeyByIterator(s,new u(n,e)):e+1===o?(this.ss.eraseElementByIterator(s.next()),this.ss.insert(new u(e,t))):this.ss.insert(i));a("free():"+e)}},i.prototype.clear=function(){a("clear()"),this.ss.clear(),this.ss.insert(new u(this.min,this.max))},i.prototype.intervalCount=function(){return this.ss.size()},i.prototype.dump=function(){console.log("length:"+this.ss.size());for(const e of this.ss)console.log(e)},t.exports=i},{debug:18,"js-sdsl":42}],55:[function(e,t,n){e=e("wrappy");function r(e){function t(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))}return t.called=!1,t}function i(e){function t(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)}var n=e.name||"Function wrapped with `once`";return t.onceError=n+" shouldn't be called more than once",t.called=!1,t}t.exports=e(r),t.exports.strict=e(i),r.proto=r(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return r(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return i(this)},configurable:!0})})},{wrappy:86}],56:[function(e,t,n){!function(a){!function(){"use strict";void 0===a||!a.version||0===a.version.indexOf("v0.")||0===a.version.indexOf("v1.")&&0!==a.version.indexOf("v1.8.")?t.exports={nextTick:function(e,t,n,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,s,o=arguments.length;switch(o){case 0:case 1:return a.nextTick(e);case 2:return a.nextTick(function(){e.call(null,t)});case 3:return a.nextTick(function(){e.call(null,t,n)});case 4:return a.nextTick(function(){e.call(null,t,n,r)});default:for(i=new Array(o-1),s=0;s<i.length;)i[s++]=arguments[s];return a.nextTick(function(){e.apply(null,i)})}}}:t.exports=a}.call(this)}.call(this,e("_process"))},{_process:57}],57:[function(e,t,n){var r,i,t=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:s}catch(e){r=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return(r=setTimeout)(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}var l,u=[],c=!1,h=-1;function d(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length)&&f()}function f(){if(!c){for(var e=a(d),t=(c=!0,u.length);t;){for(l=u,u=[];++h<t;)l&&l[h].run();h=-1,t=u.length}l=null,c=!1,!function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return(i=clearTimeout)(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||c||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=g,t.addListener=g,t.once=g,t.off=g,t.removeListener=g,t.removeAllListeners=g,t.emit=g,t.prependListener=g,t.prependOnceListener=g,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],58:[function(e,T,A){!function(I){!function(){var e=this,t="object"==typeof A&&A&&!A.nodeType&&A,n="object"==typeof T&&T&&!T.nodeType&&T,r="object"==typeof I&&I;r.global!==r&&r.window!==r&&r.self!==r||(e=r);var i,s,m=2147483647,y=36,b=26,o=38,a=700,l=/^xn--/,u=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=y-1,v=Math.floor,_=String.fromCharCode;function w(e){throw new RangeError(h[e])}function f(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function p(e,t){var n=e.split("@"),r="",n=(1<n.length&&(r=n[0]+"@",e=n[1]),(e=e.replace(c,".")).split("."));return r+f(n,t).join(".")}function S(e){for(var t,n,r=[],i=0,s=e.length;i<s;)55296<=(t=e.charCodeAt(i++))&&t<=56319&&i<s?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function g(e){return f(e,function(e){var t="";return 65535<e&&(t+=_((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=_(e)}).join("")}function k(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function E(e,t,n){var r=0;for(e=n?v(e/a):e>>1,e+=v(e/t);d*b>>1<e;r+=y)e=v(e/d);return v(r+(d+1)*e/(e+o))}function x(e){var t,n,r,i,s,o,a,l=[],u=e.length,c=0,h=128,d=72,f=e.lastIndexOf("-");for(f<0&&(f=0),n=0;n<f;++n)128<=e.charCodeAt(n)&&w("not-basic"),l.push(e.charCodeAt(n));for(r=0<f?f+1:0;r<u;){for(i=c,s=1,o=y;u<=r&&w("invalid-input"),a=e.charCodeAt(r++),(y<=(a=a-48<10?a-22:a-65<26?a-65:a-97<26?a-97:y)||a>v((m-c)/s))&&w("overflow"),c+=a*s,!(a<(a=o<=d?1:d+b<=o?b:o-d));o+=y)s>v(m/(a=y-a))&&w("overflow"),s*=a;d=E(c-i,t=l.length+1,0==i),v(c/t)>m-h&&w("overflow"),h+=v(c/t),c%=t,l.splice(c++,0,h)}return g(l)}function C(e){for(var t,n,r,i,s,o,a,l,u,c,h=[],d=(e=S(e)).length,f=128,p=72,g=t=0;g<d;++g)(a=e[g])<128&&h.push(_(a));for(n=r=h.length,r&&h.push("-");n<d;){for(i=m,g=0;g<d;++g)f<=(a=e[g])&&a<i&&(i=a);for(i-f>v((m-t)/(l=n+1))&&w("overflow"),t+=(i-f)*l,f=i,g=0;g<d;++g)if((a=e[g])<f&&++t>m&&w("overflow"),a==f){for(s=t,o=y;!(s<(u=o<=p?1:p+b<=o?b:o-p));o+=y)h.push(_(k(u+(c=s-u)%(u=y-u),0))),s=v(c/u);h.push(_(k(s,0))),p=E(t,l,n==r),t=0,++n}++t,++f}return h.join("")}if(i={version:"1.4.1",ucs2:{decode:S,encode:g},decode:x,encode:C,toASCII:function(e){return p(e,function(e){return u.test(e)?"xn--"+C(e):e})},toUnicode:function(e){return p(e,function(e){return l.test(e)?x(e.slice(4).toLowerCase()):e})}},t&&n)if(T.exports==t)n.exports=i;else for(s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);else e.punycode=i}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],59:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){t=t||"&",n=n||"=";var i={};if("string"==typeof e&&0!==e.length){var s=/\+/g,t=(e=e.split(t),1e3),o=(r&&"number"==typeof r.maxKeys&&(t=r.maxKeys),e.length);0<t&&t<o&&(o=t);for(var a=0;a<o;++a){var l,u=e[a].replace(s,"%20"),c=u.indexOf(n),c=0<=c?(l=u.substr(0,c),u.substr(c+1)):(l=u,""),u=decodeURIComponent(l),c=decodeURIComponent(c);Object.prototype.hasOwnProperty.call(i,u)?h(i[u])?i[u].push(c):i[u]=[i[u],c]:i[u]=c}}return i};var h=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],60:[function(e,t,n){"use strict";function s(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}t.exports=function(n,r,i,e){return r=r||"&",i=i||"=","object"==typeof(n=null===n?void 0:n)?a(l(n),function(e){var t=encodeURIComponent(s(e))+i;return o(n[e])?a(n[e],function(e){return t+encodeURIComponent(s(e))}).join(r):t+encodeURIComponent(s(n[e]))}).join(r):e?encodeURIComponent(s(e))+i+encodeURIComponent(s(n)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var l=Object.keys||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}},{}],61:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode"),n.encode=n.stringify=e("./encode")},{"./decode":59,"./encode":60}],62:[function(e,t,n){"use strict";var r={};function i(e,i,t){var n=function(r){var e,t;function n(e,t,n){return r.call(this,(e=e,t=t,n=n,"string"==typeof i?i:i(e,t,n)))||this}return t=r,(e=n).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t,n}(t=t||Error);n.prototype.name=t.name,n.prototype.code=e,r[e]=n}function l(e,t){var n;return Array.isArray(e)?(n=e.length,e=e.map(function(e){return String(e)}),2<n?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])):"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),i("ERR_INVALID_ARG_TYPE",function(e,t,n){var r,i,s,o,a;return"string"==typeof t&&(o="not ",t.substr(!s||s<0?0:+s,o.length)===o)?(r="must not be",t=t.replace(/^not /,"")):r="must be",s=e,o=" argument",(void 0===a||a>s.length)&&(a=s.length),s=(s.substring(a-o.length,a)===o?"The ".concat(e," "):(a=(i="number"!=typeof i?0:i)+(s=".").length>(a=e).length||-1===a.indexOf(s,i)?"argument":"property",'The "'.concat(e,'" ').concat(a," "))).concat(r," ").concat(l(t,"type")),s+=". Received type ".concat(typeof n)},TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=r},{}],63:[function(c,h,e){!function(u){!function(){"use strict";var e=Object.keys||function(e){var t,n=[];for(t in e)n.push(t);return n},t=(h.exports=o,c("./_stream_readable")),n=c("./_stream_writable");c("inherits")(o,t);for(var r=e(n.prototype),i=0;i<r.length;i++){var s=r[i];o.prototype[s]||(o.prototype[s]=n.prototype[s])}function o(e){if(!(this instanceof o))return new o(e);t.call(this,e),n.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen)&&(this.allowHalfOpen=!1,this.once("end",a))}function a(){this._writableState.ended||u.nextTick(l,this)}function l(e){e.end()}Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}.call(this)}.call(this,c("_process"))},{"./_stream_readable":65,"./_stream_writable":67,_process:57,inherits:24}],64:[function(e,t,n){"use strict";t.exports=i;var r=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}e("inherits")(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":66,inherits:24}],65:[function(U,q,e){!function(j,D){!function(){"use strict";function p(e,t){return e.listeners(t).length}(q.exports=_).ReadableState=v,U("events").EventEmitter;var r,i=U("./internal/streams/stream"),c=U("buffer").Buffer,h=D.Uint8Array||function(){};var s,e,n,t=U("util"),g=t&&t.debuglog?t.debuglog("stream"):function(){},o=U("./internal/streams/buffer_list"),t=U("./internal/streams/destroy"),a=U("./internal/streams/state").getHighWaterMark,l=U("../errors").codes,d=l.ERR_INVALID_ARG_TYPE,f=l.ERR_STREAM_PUSH_AFTER_EOF,u=l.ERR_METHOD_NOT_IMPLEMENTED,m=l.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,y=(U("inherits")(_,i),t.errorOrDestroy),b=["error","close","destroy","pause","resume"];function v(e,t,n){r=r||U("./_stream_duplex"),e=e||{},"boolean"!=typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=a(this,e,"readableHighWaterMark",n),this.buffer=new o,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(s=s||U("string_decoder/").StringDecoder,this.decoder=new s(e.encoding),this.encoding=e.encoding)}function _(e){if(r=r||U("./_stream_duplex"),!(this instanceof _))return new _(e);var t=this instanceof r;this._readableState=new v(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy)&&(this._destroy=e.destroy),i.call(this)}function w(e,t,n,r,i){g("readableAddChunk",t);var s,o,a,l,u=e._readableState;if(null===t)u.reading=!1,o=e,a=u,g("onEofChunk"),a.ended||(a.decoder&&(l=a.decoder.end())&&l.length&&(a.buffer.push(l),a.length+=a.objectMode?1:l.length),a.ended=!0,a.sync?x(o):(a.needReadable=!1,a.emittedReadable||(a.emittedReadable=!0,C(o))));else if(s=i?s:function(e,t){var n;!function(e){return c.isBuffer(e)||e instanceof h}(t)&&"string"!=typeof t&&void 0!==t&&!e.objectMode&&(n=new d("chunk",["string","Buffer","Uint8Array"],t));return n}(u,t))y(e,s);else if(u.objectMode||t&&0<t.length)if("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===c.prototype||(l=t,t=c.from(l)),r)u.endEmitted?y(e,new m):S(e,u,t,!0);else if(u.ended)y(e,new f);else{if(u.destroyed)return!1;u.reading=!1,!u.decoder||n||(t=u.decoder.write(t),u.objectMode)||0!==t.length?S(e,u,t,!1):I(e,u)}else r||(u.reading=!1,I(e,u));return!u.ended&&(u.length<u.highWaterMark||0===u.length)}function S(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&x(e)),I(e,t)}Object.defineProperty(_.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),_.prototype.destroy=t.destroy,_.prototype._undestroy=t.undestroy,_.prototype._destroy=function(e,t){t(e)},_.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=c.from(e,t),t=""),n=!0),w(this,e,t,!1,n)},_.prototype.unshift=function(e){return w(this,e,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(e){for(var t=new(s=s||U("string_decoder/").StringDecoder)(e),n=(this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding,this._readableState.buffer.head),r="";null!==n;)r+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var k=1073741824;function E(e,t){var n;return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?(t.flowing&&t.length?t.buffer.head.data:t).length:(e>t.highWaterMark&&(t.highWaterMark=(k<=(n=e)?n=k:(n--,n=(n=(n=(n=(n|=n>>>1)|n>>>2)|n>>>4)|n>>>8)|n>>>16,n++),n)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function x(e){var t=e._readableState;g("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(g("emitReadable",t.flowing),t.emittedReadable=!0,j.nextTick(C,e))}function C(e){var t=e._readableState;g("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,O(e)}function I(e,t){t.readingMore||(t.readingMore=!0,j.nextTick(T,e,t))}function T(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(g("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function A(e){var t=e._readableState;t.readableListening=0<e.listenerCount("readable"),t.resumeScheduled&&!t.paused?t.flowing=!0:0<e.listenerCount("data")&&e.resume()}function P(e){g("readable nexttick read 0"),e.read(0)}function B(e,t){g("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),O(e),t.flowing&&!t.reading&&e.read(0)}function O(e){var t=e._readableState;for(g("flow",t.flowing);t.flowing&&null!==e.read(););}function R(e,t){var n;return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n)}function M(e){var t=e._readableState;g("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,j.nextTick(L,t,e))}function L(e,t){g("endReadableNT",e.endEmitted,e.length),e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy&&(!(e=t._writableState)||e.autoDestroy&&e.finished)&&t.destroy())}function N(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}_.prototype.read=function(e){g("read",e),e=parseInt(e,10);var t,n=this._readableState,r=e;return 0!==e&&(n.emittedReadable=!1),0===e&&n.needReadable&&((0!==n.highWaterMark?n.length>=n.highWaterMark:0<n.length)||n.ended)?(g("read: emitReadable",n.length,n.ended),(0===n.length&&n.ended?M:x)(this),null):0===(e=E(e,n))&&n.ended?(0===n.length&&M(this),null):(t=n.needReadable,g("need readable",t),(0===n.length||n.length-e<n.highWaterMark)&&g("length less than watermark",t=!0),n.ended||n.reading?g("reading or ended",t=!1):t&&(g("do read"),n.reading=!0,n.sync=!0,0===n.length&&(n.needReadable=!0),this._read(n.highWaterMark),n.sync=!1,n.reading||(e=E(r,n))),null===(t=0<e?R(e,n):null)?(n.needReadable=n.length<=n.highWaterMark,e=0):(n.length-=e,n.awaitDrain=0),0===n.length&&(n.ended||(n.needReadable=!0),r!==e)&&n.ended&&M(this),null!==t&&this.emit("data",t),t)},_.prototype._read=function(e){y(this,new u("_read()"))},_.prototype.pipe=function(n,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=n;break;case 1:i.pipes=[i.pipes,n];break;default:i.pipes.push(n)}i.pipesCount+=1,g("pipe count=%d opts=%j",i.pipesCount,e);e=(!e||!1!==e.end)&&n!==j.stdout&&n!==j.stderr?o:f;function s(e,t){g("onunpipe"),e===r&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,g("cleanup"),n.removeListener("close",h),n.removeListener("finish",d),n.removeListener("drain",a),n.removeListener("error",c),n.removeListener("unpipe",s),r.removeListener("end",o),r.removeListener("end",f),r.removeListener("data",u),l=!0,!i.awaitDrain||n._writableState&&!n._writableState.needDrain||a())}function o(){g("onend"),n.end()}i.endEmitted?j.nextTick(e):r.once("end",e),n.on("unpipe",s);t=r;var t,a=function(){var e=t._readableState;g("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&p(t,"data")&&(e.flowing=!0,O(t))},l=(n.on("drain",a),!1);function u(e){g("ondata");e=n.write(e);g("dest.write",e),!1===e&&((1===i.pipesCount&&i.pipes===n||1<i.pipesCount&&-1!==N(i.pipes,n))&&!l&&(g("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function c(e){g("onerror",e),f(),n.removeListener("error",c),0===p(n,"error")&&y(n,e)}function h(){n.removeListener("finish",d),f()}function d(){g("onfinish"),n.removeListener("close",h),f()}function f(){g("unpipe"),r.unpipe(n)}return r.on("data",u),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(n,"error",c),n.once("close",h),n.once("finish",d),n.emit("pipe",r),i.flowing||(g("pipe resume"),r.resume()),n},_.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0!==t.pipesCount)if(1===t.pipesCount)e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n));else if(e){var r=N(t.pipes,e);-1!==r&&(t.pipes.splice(r,1),--t.pipesCount,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n))}else{var i=t.pipes,s=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<s;o++)i[o].emit("unpipe",this,{hasUnpiped:!1})}return this},_.prototype.addListener=_.prototype.on=function(e,t){var t=i.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=0<this.listenerCount("readable"),!1!==n.flowing&&this.resume()):"readable"!==e||n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,g("on readable",n.length,n.reading),n.length?x(this):n.reading||j.nextTick(P,this)),t},_.prototype.removeListener=function(e,t){t=i.prototype.removeListener.call(this,e,t);return"readable"===e&&j.nextTick(A,this),t},_.prototype.removeAllListeners=function(e){var t=i.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||j.nextTick(A,this),t},_.prototype.resume=function(){var e,t,n=this._readableState;return n.flowing||(g("resume"),n.flowing=!n.readableListening,e=this,(t=n).resumeScheduled)||(t.resumeScheduled=!0,j.nextTick(B,e,t)),n.paused=!1,this},_.prototype.pause=function(){return g("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(g("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},_.prototype.wrap=function(t){var e,n=this,r=this._readableState,i=!1;for(e in t.on("end",function(){var e;g("wrapped end"),r.decoder&&!r.ended&&(e=r.decoder.end())&&e.length&&n.push(e),n.push(null)}),t.on("data",function(e){g("wrapped data"),r.decoder&&(e=r.decoder.write(e)),r.objectMode&&null==e||(r.objectMode||e&&e.length)&&!n.push(e)&&(i=!0,t.pause())}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));for(var s=0;s<b.length;s++)t.on(b[s],this.emit.bind(this,b[s]));return this._read=function(e){g("wrapped _read",e),i&&(i=!1,t.resume())},this},"function"==typeof Symbol&&(_.prototype[Symbol.asyncIterator]=function(){return(e=void 0===e?U("./internal/streams/async_iterator"):e)(this)}),Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(_.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(_.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),_._fromList=R,Object.defineProperty(_.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(_.from=function(e,t){return(n=void 0===n?U("./internal/streams/from"):n)(_,e,t)})}.call(this)}.call(this,U("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":62,"./_stream_duplex":63,"./internal/streams/async_iterator":68,"./internal/streams/buffer_list":69,"./internal/streams/destroy":70,"./internal/streams/from":72,"./internal/streams/state":74,"./internal/streams/stream":75,_process:57,buffer:17,events:22,inherits:24,"string_decoder/":82,util:16}],66:[function(e,t,n){"use strict";t.exports=l;var t=e("../errors").codes,r=t.ERR_METHOD_NOT_IMPLEMENTED,i=t.ERR_MULTIPLE_CALLBACK,s=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=t.ERR_TRANSFORM_WITH_LENGTH_0,a=e("./_stream_duplex");function l(e){if(!(this instanceof l))return new l(e);a.call(this,e),this._transformState={afterTransform:function(e,t){var n=this._transformState,r=(n.transforming=!1,n.writecb);if(null===r)return this.emit("error",new i);n.writechunk=null,(n.writecb=null)!=t&&this.push(t),r(e),(n=this._readableState).reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush)&&(this._flush=e.flush),this.on("prefinish",u)}function u(){var n=this;"function"!=typeof this._flush||this._readableState.destroyed?c(this,null,null):this._flush(function(e,t){c(n,e,t)})}function c(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new o;if(e._transformState.transforming)throw new s;e.push(null)}e("inherits")(l,a),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,a.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,n){n(new r("_transform()"))},l.prototype._write=function(e,t,n){var r=this._transformState;r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming&&(n=this._readableState,r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){a.prototype._destroy.call(this,e,function(e){t(e)})}},{"../errors":62,"./_stream_duplex":63,inherits:24}],67:[function(P,B,e){!function(T,A){!function(){"use strict";function h(s){var o=this;this.next=null,this.entry=null,this.finish=function(){var e=o,t=s,n=void 0,r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}}(B.exports=w).WritableState=_;var n,e={deprecate:P("util-deprecate")},r=P("./internal/streams/stream"),u=P("buffer").Buffer,c=A.Uint8Array||function(){};var i,t=P("./internal/streams/destroy"),s=P("./internal/streams/state").getHighWaterMark,o=P("../errors").codes,d=o.ERR_INVALID_ARG_TYPE,a=o.ERR_METHOD_NOT_IMPLEMENTED,f=o.ERR_MULTIPLE_CALLBACK,l=o.ERR_STREAM_CANNOT_PIPE,p=o.ERR_STREAM_DESTROYED,g=o.ERR_STREAM_NULL_VALUES,m=o.ERR_STREAM_WRITE_AFTER_END,y=o.ERR_UNKNOWN_ENCODING,b=t.errorOrDestroy;function v(){}function _(e,c,t){n=n||P("./_stream_duplex"),e=e||{},"boolean"!=typeof t&&(t=c instanceof n),this.objectMode=!!e.objectMode,t&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=s(this,e,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;t=(this.destroyed=!1)===e.decodeStrings;this.decodeStrings=!t,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){var t=c,n=t._writableState,r=n.sync,i=n.writecb;if("function"!=typeof i)throw new f;var s,o,a,l,u=n;u.writing=!1,u.writecb=null,u.length-=u.writelen,u.writelen=0,e?(u=t,o=r,a=e,l=i,--(s=n).pendingcb,o?(T.nextTick(l,a),T.nextTick(I,u,s),u._writableState.errorEmitted=!0,b(u,a)):(l(a),u._writableState.errorEmitted=!0,b(u,a),I(u,s))):((e=x(n)||t.destroyed)||n.corked||n.bufferProcessing||!n.bufferedRequest||E(t,n),r?T.nextTick(k,t,n,e,i):k(t,n,e,i))},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new h(this)}P("inherits")(w,r),_.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};try{Object.defineProperty(_.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}function w(e){var t=this instanceof(n=n||P("./_stream_duplex"));if(!t&&!i.call(w,this))return new w(e);this._writableState=new _(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final)&&(this._final=e.final),r.call(this)}function S(e,t,n,r,i,s,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new p("write")):n?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function k(e,t,n,r){var i;n||(n=e,0===(i=t).length&&i.needDrain&&(i.needDrain=!1,n.emit("drain"))),t.pendingcb--,r(),I(e,t)}function E(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){for(var r=t.bufferedRequestCount,i=new Array(r),r=t.corkedRequestsFree,s=(r.entry=n,0),o=!0;n;)(i[s]=n).isBuf||(o=!1),n=n.next,s+=1;i.allBuffers=o,S(e,t,!0,t.length,i,"",r.finish),t.pendingcb++,t.lastBufferedRequest=null,r.next?(t.corkedRequestsFree=r.next,r.next=null):t.corkedRequestsFree=new h(t),t.bufferedRequestCount=0}else{for(;n;){var a=n.chunk,l=n.encoding,u=n.callback;if(S(e,t,!1,t.objectMode?1:a.length,a,l,u),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function x(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function C(t,n){t._final(function(e){n.pendingcb--,e&&b(t,e),n.prefinished=!0,t.emit("prefinish"),I(t,n)})}function I(e,t){var n,r,i=x(t);return i&&(n=e,(r=t).prefinished||r.finalCalled||("function"!=typeof n._final||r.destroyed?(r.prefinished=!0,n.emit("prefinish")):(r.pendingcb++,r.finalCalled=!0,T.nextTick(C,n,r))),0===t.pendingcb)&&(t.finished=!0,e.emit("finish"),t.autoDestroy)&&(!(n=e._readableState)||n.autoDestroy&&n.endEmitted)&&e.destroy(),i}"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(i=Function.prototype[Symbol.hasInstance],Object.defineProperty(w,Symbol.hasInstance,{value:function(e){return!!i.call(this,e)||this===w&&e&&e._writableState instanceof _}})):i=function(e){return e instanceof this},w.prototype.pipe=function(){b(this,new l)},w.prototype.write=function(e,t,n){var r,i,s,o=this._writableState,a=!1,l=!o.objectMode&&(l=e,u.isBuffer(l)||l instanceof c);return l&&!u.isBuffer(e)&&(r=e,e=u.from(r)),"function"==typeof t&&(n=t,t=null),t=l?"buffer":t||o.defaultEncoding,"function"!=typeof n&&(n=v),o.ending?(r=this,i=n,s=new m,b(r,s),T.nextTick(i,s)):(l||function(e,t,n,r){var i;if(null===n?i=new g:"string"==typeof n||t.objectMode||(i=new d("chunk",["string","Buffer"],n)),!i)return 1;b(e,i),T.nextTick(r,i)}(this,o,e,n))&&(o.pendingcb++,a=function(e,t,n,r,i,s){n||(o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=u.from(t,n));return t}(t,r,i),r!==o&&(n=!0,i="buffer",r=o));var o=t.objectMode?1:r.length,a=(t.length+=o,t.length<t.highWaterMark);a||(t.needDrain=!0);{var l;t.writing||t.corked?(l=t.lastBufferedRequest,t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:s,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1):S(e,t,!1,o,r,i,s)}return a}(this,o,l,e,t,n)),a},w.prototype.cork=function(){this._writableState.corked++},w.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||E(this,e))},w.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase()))return this._writableState.defaultEncoding=e,this;throw new y(e)},Object.defineProperty(w.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),w.prototype._write=function(e,t,n){n(new a("_write()"))},w.prototype._writev=null,w.prototype.end=function(e,t,n){var r=this._writableState;if("function"==typeof e?(n=e,t=e=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),!r.ending){e=this,t=r,r=n;t.ending=!0,I(e,t),r&&(t.finished?T.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}return this},Object.defineProperty(w.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),w.prototype.destroy=t.destroy,w.prototype._undestroy=t.undestroy,w.prototype._destroy=function(e,t){t(e)}}.call(this)}.call(this,P("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":62,"./_stream_duplex":63,"./internal/streams/destroy":70,"./internal/streams/state":74,"./internal/streams/stream":75,_process:57,buffer:17,inherits:24,"util-deprecate":85}],68:[function(r,m,e){!function(g){!function(){"use strict";var e;function n(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var i=r("./end-of-stream"),s=Symbol("lastResolve"),o=Symbol("lastReject"),a=Symbol("error"),l=Symbol("ended"),u=Symbol("lastPromise"),c=Symbol("handlePromise"),h=Symbol("stream");function d(e,t){return{value:e,done:t}}function f(e){var t,n=e[s];null!==n&&null!==(t=e[h].read())&&(e[u]=null,e[s]=null,e[o]=null,n(d(t,!1)))}var t=Object.getPrototypeOf(function(){}),p=Object.setPrototypeOf((n(e={get stream(){return this[h]},next:function(){var n=this,e=this[a];if(null!==e)return Promise.reject(e);if(this[l])return Promise.resolve(d(void 0,!0));if(this[h].destroyed)return new Promise(function(e,t){g.nextTick(function(){n[a]?t(n[a]):e(d(void 0,!0))})});var t,r,i,e=this[u];if(e)t=new Promise((r=e,i=this,function(e,t){r.then(function(){i[l]?e(d(void 0,!0)):i[c](e,t)},t)}));else{e=this[h].read();if(null!==e)return Promise.resolve(d(e,!1));t=new Promise(this[c])}return this[u]=t}},Symbol.asyncIterator,function(){return this}),n(e,"return",function(){var e=this;return new Promise(function(t,n){e[h].destroy(null,function(e){e?n(e):t(d(void 0,!0))})})}),e),t);m.exports=function(e){var t,r=Object.create(p,(n(t={},h,{value:e,writable:!0}),n(t,s,{value:null,writable:!0}),n(t,o,{value:null,writable:!0}),n(t,a,{value:null,writable:!0}),n(t,l,{value:e._readableState.endEmitted,writable:!0}),n(t,c,{value:function(e,t){var n=r[h].read();n?(r[u]=null,r[s]=null,r[o]=null,e(d(n,!1))):(r[s]=e,r[o]=t)},writable:!0}),t));return r[u]=null,i(e,function(e){var t;e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code?(null!==(t=r[o])&&(r[u]=null,r[s]=null,r[o]=null,t(e)),r[a]=e):(null!==(t=r[s])&&(r[u]=null,r[s]=null,t(d(void 0,!(r[o]=null)))),r[l]=!0)}),e.on("readable",function(e){g.nextTick(f,e)}.bind(null,r)),r}}.call(this)}.call(this,r("_process"))},{"./end-of-stream":71,_process:57}],69:[function(e,t,n){"use strict";function s(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function i(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(Object(i),!0).forEach(function(e){var t,n;t=r,n=i[e=e],e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=e("buffer").Buffer,l=e("util").inspect,u=l&&l.custom||"inspect";t.exports=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.head=null,this.tail=null,this.length=0}var t,n,r;return t=e,(n=[{key:"push",value:function(e){e={data:e,next:null};0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(e){e={data:e,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){var e;if(0!==this.length)return e=this.head.data,1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return a.alloc(0);for(var t,n,r=a.allocUnsafe(e>>>0),i=this.head,s=0;i;)t=i.data,n=s,a.prototype.copy.call(t,r,n),s+=i.data.length,i=i.next;return r}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?r+=i:r+=i.slice(0,e),0===(e-=s)){s===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t).data=i.slice(s);break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=a.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0===(e-=s)){s===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n).data=i.slice(s);break}++r}return this.length-=r,t}},{key:u,value:function(e,t){return l(this,i({},t,{depth:0,customInspect:!1}))}}])&&o(t.prototype,n),r&&o(t,r),e}()},{buffer:17,util:16}],70:[function(e,t,n){!function(l){!function(){"use strict";function s(e,t){a(e,t),o(e)}function o(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function a(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var n=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,l.nextTick(a,this,e)):l.nextTick(a,this,e)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?n._writableState?n._writableState.errorEmitted?l.nextTick(o,n):(n._writableState.errorEmitted=!0,l.nextTick(s,n,e)):l.nextTick(s,n,e):t?(l.nextTick(o,n),t(e)):l.nextTick(o,n)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}.call(this)}.call(this,e("_process"))},{_process:57}],71:[function(e,t,n){"use strict";var y=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function b(){}t.exports=function e(t,n,r){var i,s,o,a,l,u,c,h,d,f,p,g,m;return"function"==typeof n?e(t,null,n):(i=r||b,s=!1,r=function(){if(!s){s=!0;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(this,t)}},o=(n=n||{}).readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,l=function(){t.writable||c()},u=t._writableState&&t._writableState.finished,c=function(){u=!(a=!1),o||r.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){h=!(o=!1),a||r.call(t)},f=function(e){r.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new y),r.call(t,e)):a&&!u?(t._writableState&&t._writableState.ended||(e=new y),r.call(t,e)):void 0},g=function(){t.req.on("finish",c)},(m=t).setHeader&&"function"==typeof m.abort?(t.on("complete",c),t.on("abort",p),t.req?g():t.on("request",g)):a&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",d),t.on("finish",c),!1!==n.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",g),t.req&&t.req.removeListener("finish",c),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",c),t.removeListener("end",d),t.removeListener("error",f),t.removeListener("close",p)})}},{"../../../errors":62}],72:[function(e,t,n){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],73:[function(l,e,t){"use strict";var u;var n=l("../../../errors").codes,a=n.ERR_MISSING_ARGS,c=n.ERR_STREAM_DESTROYED;function h(e){if(e)throw e}function d(n,e,t,r){i=r,s=!1;var i,s,o=!(r=function(){s||(s=!0,i.apply(void 0,arguments))}),a=(n.on("close",function(){o=!0}),(u=void 0===u?l("./end-of-stream"):u)(n,{readable:e,writable:t},function(e){if(e)return r(e);o=!0,r()}),!1);return function(e){var t;if(!o&&!a)return a=!0,(t=n).setHeader&&"function"==typeof t.abort?n.abort():"function"==typeof n.destroy?n.destroy():void r(e||new c("pipe"))}}function f(e){e()}function p(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n,i,s=!(n=r).length||"function"!=typeof n[n.length-1]?h:n.pop();if((r=Array.isArray(r[0])?r[0]:r).length<2)throw new a("streams");var o=r.map(function(e,t){var n=t<r.length-1;return d(e,n,0<t,function(e){i=i||e,e&&o.forEach(f),n||(o.forEach(f),s(i))})});return r.reduce(p)}},{"../../../errors":62,"./end-of-stream":71}],74:[function(e,t,n){"use strict";var o=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,n,r){s=r,i=n;var i,s=null!=(t=t).highWaterMark?t.highWaterMark:s?t[i]:null;if(null==s)return e.objectMode?16:16384;if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new o(r?n:"highWaterMark",s);return Math.floor(s)}}},{"../../../errors":62}],75:[function(e,t,n){t.exports=e("events").EventEmitter},{events:22}],76:[function(e,t,n){(((n=t.exports=e("./lib/_stream_readable.js")).Stream=n).Readable=n).Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),n.finished=e("./lib/internal/streams/end-of-stream.js"),n.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":63,"./lib/_stream_passthrough.js":64,"./lib/_stream_readable.js":65,"./lib/_stream_transform.js":66,"./lib/_stream_writable.js":67,"./lib/internal/streams/end-of-stream.js":71,"./lib/internal/streams/pipeline.js":73}],77:[function(e,t,n){"use strict";function r(e,t,n){var r=this;this._callback=e,this._args=n,this._interval=setInterval(e,t,this._args),this.reschedule=function(e){e=e||r._interval,r._interval&&clearInterval(r._interval),r._interval=setInterval(r._callback,e,r._args)},this.clear=function(){r._interval&&(clearInterval(r._interval),r._interval=void 0)},this.destroy=function(){r._interval&&clearInterval(r._interval),r._callback=void 0,r._interval=void 0,r._args=void 0}}t.exports=function(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("interval needed");if(0<arguments.length)for(var e=new Array(arguments.length-2),t=0;t<e.length;t++)e[t]=arguments[t+2];return new r(arguments[0],arguments[1],e)}},{}],78:[function(e,t,n){"use strict";t.exports=e("./index.js")()},{"./index.js":79}],79:[function(e,n,t){!function(t){!function(){"use strict";function c(e){return e instanceof t?t.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}n.exports=function(e){var l,u;if((e=e||{}).circles)return l=[],u=[],e.proto?function e(t){if("object"!=typeof t||null===t)return t;if(t instanceof Date)return new Date(t);if(Array.isArray(t))return o(t,e);if(t instanceof Map)return new Map(o(Array.from(t),e));if(t instanceof Set)return new Set(o(Array.from(t),e));var n={};l.push(t);u.push(n);for(var r in t){var i,s=t[r];"object"!=typeof s||null===s?n[r]=s:s instanceof Date?n[r]=new Date(s):s instanceof Map?n[r]=new Map(o(Array.from(s),e)):s instanceof Set?n[r]=new Set(o(Array.from(s),e)):ArrayBuffer.isView(s)?n[r]=c(s):(i=l.indexOf(s),n[r]=-1!==i?u[i]:e(s))}l.pop();u.pop();return n}:function e(t){if("object"!=typeof t||null===t)return t;if(t instanceof Date)return new Date(t);if(Array.isArray(t))return o(t,e);if(t instanceof Map)return new Map(o(Array.from(t),e));if(t instanceof Set)return new Set(o(Array.from(t),e));var n={};l.push(t);u.push(n);for(var r in t){var i,s;!1!==Object.hasOwnProperty.call(t,r)&&("object"!=typeof(i=t[r])||null===i?n[r]=i:i instanceof Date?n[r]=new Date(i):i instanceof Map?n[r]=new Map(o(Array.from(i),e)):i instanceof Set?n[r]=new Set(o(Array.from(i),e)):ArrayBuffer.isView(i)?n[r]=c(i):(s=l.indexOf(i),n[r]=-1!==s?u[s]:e(i)))}l.pop();u.pop();return n};return e.proto?function e(t){if("object"!=typeof t||null===t)return t;if(t instanceof Date)return new Date(t);if(Array.isArray(t))return s(t,e);if(t instanceof Map)return new Map(s(Array.from(t),e));if(t instanceof Set)return new Set(s(Array.from(t),e));var n={};for(var r in t){var i=t[r];"object"!=typeof i||null===i?n[r]=i:i instanceof Date?n[r]=new Date(i):i instanceof Map?n[r]=new Map(s(Array.from(i),e)):i instanceof Set?n[r]=new Set(s(Array.from(i),e)):ArrayBuffer.isView(i)?n[r]=c(i):n[r]=e(i)}return n}:function e(t){if("object"!=typeof t||null===t)return t;if(t instanceof Date)return new Date(t);if(Array.isArray(t))return s(t,e);if(t instanceof Map)return new Map(s(Array.from(t),e));if(t instanceof Set)return new Set(s(Array.from(t),e));var n={};for(var r in t){var i;!1!==Object.hasOwnProperty.call(t,r)&&("object"!=typeof(i=t[r])||null===i?n[r]=i:i instanceof Date?n[r]=new Date(i):i instanceof Map?n[r]=new Map(s(Array.from(i),e)):i instanceof Set?n[r]=new Set(s(Array.from(i),e)):ArrayBuffer.isView(i)?n[r]=c(i):n[r]=e(i))}return n};function o(e,t){for(var n=Object.keys(e),r=new Array(n.length),i=0;i<n.length;i++){var s,o=n[i],a=e[o];"object"!=typeof a||null===a?r[o]=a:a instanceof Date?r[o]=new Date(a):ArrayBuffer.isView(a)?r[o]=c(a):(s=l.indexOf(a),r[o]=-1!==s?u[s]:t(a))}return r}function s(e,t){for(var n=Object.keys(e),r=new Array(n.length),i=0;i<n.length;i++){var s=n[i],o=e[s];"object"!=typeof o||null===o?r[s]=o:o instanceof Date?r[s]=new Date(o):ArrayBuffer.isView(o)?r[s]=c(o):r[s]=t(o)}return r}}}.call(this)}.call(this,e("buffer").Buffer)},{buffer:17}],80:[function(e,t,n){var r=e("buffer"),i=r.Buffer;function s(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(s(r,n),n.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");e=i(e);return void 0!==t?"string"==typeof n?e.fill(t,n):e.fill(t):e.fill(0),e},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},{buffer:17}],81:[function(e,t,n){t.exports=function(e){var t=e._readableState;return t?t.objectMode||"number"==typeof e._duplexState?e.read():e.read(function(e){if(e.buffer.length)return(e.buffer.head?e.buffer.head.data:e.buffer[0]).length;return e.length}(t)):null}},{}],82:[function(e,t,n){"use strict";var r=e("safe-buffer").Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"==typeof t||r.isEncoding!==i&&i(e))return t||e;throw new Error("Unknown encoding: "+e)}function o(e){var t;switch(this.encoding=s(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=l,t=4;break;case"base64":this.text=h,this.end=d,t=3;break;default:return this.write=f,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function l(e){var t,n=this.lastTotal-this.lastNeed,r=(t=this,128!=(192&(r=e)[0])?(t.lastNeed=0,"�"):1<t.lastNeed&&1<r.length?128!=(192&r[1])?(t.lastNeed=1,"�"):2<t.lastNeed&&2<r.length&&128!=(192&r[2])?(t.lastNeed=2,"�"):void 0:void 0);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,n,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,n,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);t=e.toString("utf16le",t);if(t){var n=t.charCodeAt(t.length-1);if(55296<=n&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}function c(e){var t,e=e&&e.length?this.write(e):"";return this.lastNeed?(t=this.lastTotal-this.lastNeed,e+this.lastChar.toString("utf16le",0,t)):e}function h(e,t){var n=(e.length-t)%3;return 0==n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1==n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}(n.StringDecoder=o).prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+"�":e},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(!(r<n)){var i=a(t[r]);if(0<=i)return 0<i&&(e.lastNeed=i-1),i;if(!(--r<n||-2===i)){if(0<=(i=a(t[r])))return 0<i&&(e.lastNeed=i-2),i;if(!(--r<n||-2===i)&&0<=(i=a(t[r])))return 0<i&&(2===i?i=0:e.lastNeed=i-3),i}}return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;n=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":80}],83:[function(e,t,n){"use strict";var k=e("punycode"),E=e("./util");function w(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}n.parse=i,n.resolve=function(e,t){return i(e,!1,!0).resolve(t)},n.resolveObject=function(e,t){return e?i(e,!1,!0).resolveObject(t):t},n.format=function(e){E.isString(e)&&(e=i(e));return e instanceof w?e.format():w.prototype.format.call(e)},n.Url=w;var x=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,C=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,n=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),I=["'"].concat(n),T=["%","/","?",";","#"].concat(I),A=["/","?","#"],P=/^[+a-z0-9A-Z_-]{0,63}$/,B=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,O={javascript:!0,"javascript:":!0},R={javascript:!0,"javascript:":!0},M={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},N=e("querystring");function i(e,t,n){var r;return e&&E.isObject(e)&&e instanceof w?e:((r=new w).parse(e,t,n),r)}w.prototype.parse=function(e,t,n){if(!E.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),r=-1!==r&&r<e.indexOf("#")?"?":"#",i=e.split(r);i[0]=i[0].replace(/\\/g,"/");var s=(s=e=i.join(r)).trim();if(!n&&1===e.split("#").length){i=C.exec(s);if(i)return this.path=s,this.href=s,this.pathname=i[1],i[2]?(this.search=i[2],this.query=t?N.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var o,r=x.exec(s);if(r&&(o=(r=r[0]).toLowerCase(),this.protocol=o,s=s.substr(r.length)),!(n||r||s.match(/^\/\/[^@\/]+@[^@\/]+/))||!(_="//"===s.substr(0,2))||r&&R[r]||(s=s.substr(2),this.slashes=!0),!R[r]&&(_||r&&!M[r])){for(var a=-1,l=0;l<A.length;l++)-1!==(u=s.indexOf(A[l]))&&(-1===a||u<a)&&(a=u);-1!==(e=-1===a?s.lastIndexOf("@"):s.lastIndexOf("@",a))&&(i=s.slice(0,e),s=s.slice(e+1),this.auth=decodeURIComponent(i));for(var u,a=-1,l=0;l<T.length;l++)-1!==(u=s.indexOf(T[l]))&&(-1===a||u<a)&&(a=u);-1===a&&(a=s.length),this.host=s.slice(0,a),s=s.slice(a),this.parseHost(),this.hostname=this.hostname||"";n="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!n)for(var c=this.hostname.split(/\./),l=0,h=c.length;l<h;l++){var d=c[l];if(d&&!d.match(P)){for(var f="",p=0,g=d.length;p<g;p++)127<d.charCodeAt(p)?f+="x":f+=d[p];if(!f.match(P)){var m=c.slice(0,l),y=c.slice(l+1),b=d.match(B);b&&(m.push(b[1]),y.unshift(b[2])),y.length&&(s="/"+y.join(".")+s),this.hostname=m.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),n||(this.hostname=k.toASCII(this.hostname));var v=this.port?":"+this.port:"",_=this.hostname||"";this.host=_+v,this.href+=this.host,n&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0])&&(s="/"+s)}if(!O[o])for(l=0,h=I.length;l<h;l++){var w,S=I[l];-1!==s.indexOf(S)&&((w=encodeURIComponent(S))===S&&(w=escape(S)),s=s.split(S).join(w))}r=s.indexOf("#"),-1!==r&&(this.hash=s.substr(r),s=s.slice(0,r)),e=s.indexOf("?");return-1!==e?(this.search=s.substr(e),this.query=s.substr(e+1),t&&(this.query=N.parse(this.query)),s=s.slice(0,e)):t&&(this.search="",this.query={}),s&&(this.pathname=s),M[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(v=this.pathname||"",i=this.search||"",this.path=v+i),this.href=this.format(),this},w.prototype.format=function(){var e=this.auth||"",t=(e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@"),this.protocol||""),n=this.pathname||"",r=this.hash||"",i=!1,s="",e=(this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port)&&(i+=":"+this.port),this.query&&E.isObject(this.query)&&Object.keys(this.query).length&&(s=N.stringify(this.query)),this.search||s&&"?"+s||"");return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||M[t])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i=i||"",r&&"#"!==r.charAt(0)&&(r="#"+r),e&&"?"!==e.charAt(0)&&(e="?"+e),t+i+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(e=e.replace("#","%23"))+r},w.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},w.prototype.resolveObject=function(e){E.isString(e)&&((d=new w).parse(e,!1,!0),e=d);for(var t=new w,n=Object.keys(this),r=0;r<n.length;r++){var i=n[r];t[i]=this[i]}if(t.hash=e.hash,""!==e.href)if(e.slashes&&!e.protocol){for(var s=Object.keys(e),o=0;o<s.length;o++){var a=s[o];"protocol"!==a&&(t[a]=e[a])}M[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/")}else if(e.protocol&&e.protocol!==t.protocol)if(M[e.protocol]){if(t.protocol=e.protocol,e.host||R[e.protocol])t.pathname=e.pathname;else{for(var l=(e.pathname||"").split("/");l.length&&!(e.host=l.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==l[0]&&l.unshift(""),l.length<2&&l.unshift(""),t.pathname=l.join("/")}t.search=e.search,t.query=e.query,t.host=e.host||"",t.auth=e.auth,t.hostname=e.hostname||e.host,t.port=e.port,(t.pathname||t.search)&&(d=t.pathname||"",f=t.search||"",t.path=d+f),t.slashes=t.slashes||e.slashes}else for(var u=Object.keys(e),c=0;c<u.length;c++){var h=u[c];t[h]=e[h]}else{var d=t.pathname&&"/"===t.pathname.charAt(0),f=e.host||e.pathname&&"/"===e.pathname.charAt(0),d=f||d||t.host&&e.pathname,p=d,g=t.pathname&&t.pathname.split("/")||[],l=e.pathname&&e.pathname.split("/")||[],m=t.protocol&&!M[t.protocol];if(m&&(t.hostname="",t.port=null,t.host&&(""===g[0]?g[0]=t.host:g.unshift(t.host)),t.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===l[0]?l[0]=e.host:l.unshift(e.host)),e.host=null),d=d&&(""===l[0]||""===g[0])),f)t.host=(e.host||""===e.host?e:t).host,t.hostname=(e.hostname||""===e.hostname?e:t).hostname,t.search=e.search,t.query=e.query,g=l;else if(l.length)(g=g||[]).pop(),g=g.concat(l),t.search=e.search,t.query=e.query;else if(!E.isNullOrUndefined(e.search))return m&&(t.hostname=t.host=g.shift(),_=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=_.shift(),t.host=t.hostname=_.shift()),t.search=e.search,t.query=e.query,E.isNull(t.pathname)&&E.isNull(t.search)||(t.path=(t.pathname||"")+(t.search||"")),t.href=t.format(),t;if(g.length){for(var y=g.slice(-1)[0],f=(t.host||e.host||1<g.length)&&("."===y||".."===y)||""===y,b=0,v=g.length;0<=v;v--)"."===(y=g[v])?g.splice(v,1):".."===y?(g.splice(v,1),b++):b&&(g.splice(v,1),b--);if(!d&&!p)for(;b--;)g.unshift("..");!d||""===g[0]||g[0]&&"/"===g[0].charAt(0)||g.unshift(""),f&&"/"!==g.join("/").substr(-1)&&g.push("");var _,p=""===g[0]||g[0]&&"/"===g[0].charAt(0);m&&(t.hostname=t.host=!p&&g.length?g.shift():"",_=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=_.shift(),t.host=t.hostname=_.shift()),(d=d||t.host&&g.length)&&!p&&g.unshift(""),g.length?t.pathname=g.join("/"):(t.pathname=null,t.path=null),E.isNull(t.pathname)&&E.isNull(t.search)||(t.path=(t.pathname||"")+(t.search||"")),t.auth=e.auth||t.auth,t.slashes=t.slashes||e.slashes}else t.pathname=null,t.search?t.path="/"+t.search:t.path=null}return t.href=t.format(),t},w.prototype.parseHost=function(){var e=this.host,t=r.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":84,punycode:58,querystring:61}],84:[function(e,t,n){"use strict";t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],85:[function(e,n,t){!function(t){!function(){function r(e){try{if(!t.localStorage)return}catch(e){return}e=t.localStorage[e];return null!=e&&"true"===String(e).toLowerCase()}n.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],86:[function(e,t,n){t.exports=function e(i,t){if(i&&t)return e(i)(t);if("function"!=typeof i)throw new TypeError("need wrapper function");Object.keys(i).forEach(function(e){n[e]=i[e]});return n;function n(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];var n=i.apply(this,e),r=e[e.length-1];return"function"==typeof n&&n!==r&&Object.keys(r).forEach(function(e){n[e]=r[e]}),n}}},{}],87:[function(e,t,n){"use strict";t.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},{}],88:[function(e,t,n){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var n,r=arguments[t];for(n in r)i.call(r,n)&&(e[n]=r[n])}return e};var i=Object.prototype.hasOwnProperty},{}],89:[function(e,t,n){"use strict";t.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},{}],90:[function(e,t,n){"use strict";function s(e){var t=this;if((t=t instanceof s?t:new s).tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(e){t.push(e)});else if(0<arguments.length)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}function o(e,t,n,r){if(!(this instanceof o))return new o(e,t,n,r);this.list=r,this.value=e,t?(t.next=this).prev=t:this.prev=null,n?(n.prev=this).next=n:this.next=null}(t.exports=s).Node=o,(s.create=s).prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},s.prototype.unshiftNode=function(e){var t;e!==this.head&&(e.list&&e.list.removeNode(e),t=this.head,e.list=this,(e.next=t)&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++)},s.prototype.pushNode=function(e){var t;e!==this.tail&&(e.list&&e.list.removeNode(e),t=this.tail,e.list=this,(e.prev=t)&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++)},s.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++){r=n=void 0;var n=this,r=arguments[e];n.tail=new o(r,n.tail,null,n),n.head||(n.head=n.tail),n.length++}return this.length},s.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++){r=n=void 0;var n=this,r=arguments[e];n.head=new o(r,null,n.head,n),n.tail||(n.tail=n.head),n.length++}return this.length},s.prototype.pop=function(){var e;if(this.tail)return e=this.tail.value,this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e},s.prototype.shift=function(){var e;if(this.head)return e=this.head.value,this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e},s.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},s.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},s.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},s.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},s.prototype.map=function(e,t){t=t||this;for(var n=new s,r=this.head;null!==r;)n.push(e.call(t,r.value,this)),r=r.next;return n},s.prototype.mapReverse=function(e,t){t=t||this;for(var n=new s,r=this.tail;null!==r;)n.push(e.call(t,r.value,this)),r=r.prev;return n},s.prototype.reduce=function(e,t){var n,r=this.head;if(1<arguments.length)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=e(n,r.value,i),r=r.next;return n},s.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(1<arguments.length)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=e(n,r.value,i),r=r.prev;return n},s.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},s.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},s.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new s;if(!(t<e||t<0)){e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;null!==i&&r<e;r++)i=i.next;for(;null!==i&&r<t;r++,i=i.next)n.push(i.value)}return n},s.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new s;if(!(t<e||t<0)){e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;null!==i&&t<r;r--)i=i.prev;for(;null!==i&&e<r;r--,i=i.prev)n.push(i.value)}return n},s.prototype.splice=function(e,t,...n){(e=e>this.length?this.length-1:e)<0&&(e=this.length+e);for(var r=0,i=this.head;null!==i&&r<e;r++)i=i.next;for(var s=[],r=0;i&&r<t;r++)s.push(i.value),i=this.removeNode(i);(i=null===i?this.tail:i)!==this.head&&i!==this.tail&&(i=i.prev);for(r=0;r<n.length;r++)i=function(e,t,n){n=t===e.head?new o(n,null,t,e):new o(n,t,t.next,e);null===n.next&&(e.tail=n);null===n.prev&&(e.head=n);return e.length++,n}(this,i,n[r]);return s},s.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{e("./iterator.js")(s)}catch(e){}},{"./iterator.js":89}]},{},[12])(12)}),"undefined"==typeof cyblion&&(cyblion={}),freeboard.loadDatasourcePlugin({type_name:"cyblion_datasource",display_name:"Cyblion",external_scripts:[""],settings:[{name:"deviceid",display_name:"Device ID",type:"text",description:"",required:!0},{name:"devicetoken",display_name:"Device Token",type:"text",description:"",required:!0}],newInstance:function(e,t,n,r){t(new myDatasourcePlugin(e,n,r))}}),myDatasourcePlugin=function(e,r,t){let i=this;this.store={msg:{},cmsg:{},cstore:{}},this.cyblionmqtt=new CyblionMQTT({deviceid:e.deviceid,devicetoken:e.devicetoken}),cyblion[e.name]={publish:i.cyblionmqtt.publish.bind(i.cyblionmqtt)},r(i.store),this.onSettingsChanged=function(e){},this.updateNow=function(){},this.onDispose=function(){i.cyblionmqtt.disconnect(),delete i.cyblionmqtt},this.cyblionmqtt.on("msg",(e,t)=>{console.log(`@msg : ${e} ==> `+t);var n={};n[e.replace("@msg/","")]=t,i.store={...i.store,msg:n},r(i.store)}),this.cyblionmqtt.on("cmsg",(e,t)=>{console.log(`@cmsg : ${e} ==> `+t);var n={};n[e.replace("@msg/","")]=cyblion_decrypt(t),i.store={...i.store,cmsg:n},r(i.store)}),this.cyblionmqtt.on("cstore",(e,t)=>{console.log(`@cstore : ${e} ==> `+t);var n={};n[e.replace("@cstore/data/updated/","")]=cyblion_decrypt(t),i.store={...i.store,cstore:n},r(i.store)}),this.cyblionmqtt.on("connected",()=>{console.log("connected"),this.cyblionmqtt.subscribe("@private/#"),this.cyblionmqtt.subscribe("@cprivate/#"),this.cyblionmqtt.subscribe("@msg/#"),this.cyblionmqtt.subscribe("@cmsg/#"),this.cyblionmqtt.subscribe("@cstore/data/updated/#")}),this.cyblionmqtt.on("disconnected",()=>{console.log("disconnected")}),this.cyblionmqtt.connect()};const NETPIE_MQTT_HOST="ws://mqtt.netpie.io:80/mqtt",NETPIE_MQTTS_HOST="wss://mqtt.netpie.io:443/mqtt",NETPIE_CYBLION_MQTT_HOST="ws://fhe.netpie.io:8083/mqtt",NETPIE_CYBLION_MQTTS_HOST="wss://fhe.netpie.io:8084/mqtt";class CyblionMQTT{constructor(e){let u=this;this.deviceid=e.deviceid,this.devicetoken=e.devicetoken,this.option=e,this.option.secure?(this.netpie_broker_uri=NETPIE_MQTTS_HOST,this.cyblion_broker_uri=NETPIE_CYBLION_MQTTS_HOST):(this.netpie_broker_uri=NETPIE_MQTT_HOST,this.cyblion_broker_uri=NETPIE_CYBLION_MQTT_HOST),this.eventhandler={},this.eventhandler_once={},this.emitter={on(e,t){u.eventhandler[e]||(u.eventhandler[e]=[]);for(var n of u.eventhandler[e])if(n===t)return;u.eventhandler[e].push(t)},once(e,t){u.eventhandler_once[e]||(u.eventhandler_once[e]=[]);for(var n of u.eventhandler_once[e])if(n===t)return;u.eventhandler_once[e].push(t)},emit(e,t,n,r,i){if(u.eventhandler[e])for(var s of u.eventhandler[e])"function"==typeof s&&s(t,n,r,i);if(u.eventhandler_once[e])for(var o of u.eventhandler_once[e]){"function"==typeof o&&o(t,n,r,i);var a,l=u.eventhandler_once[e];for(a in l)if(l[a]===o)return void l.splice(a,1)}},removeListener(e,t){let n;for(var r in n=u.eventhandler[e])if(n[r]===t)return void n.splice(r,1);for(var i in n=u.eventhandler_once[e])if(n[i]===t)return void n.splice(i,1)}},this.on=function(...e){u.emitter.on(...e)},this.once=function(...e){u.emitter.once(...e)},this.removeListener=function(...e){u.emitter.removeListener(...e)}}_connect_netpie(){let r=this;this.netpie_client&&this.netpie_client.connected||(this.netpie_client=mqtt.connect(r.netpie_broker_uri,{keepalive:30,clientId:r.deviceid,username:r.devicetoken,password:"",clean:!0,reconnectPeriod:1e3,connectTimeout:3e4,rejectUnauthorized:!1}),this.netpie_client.on("connect",()=>{this._connect_cyblion()}),this.netpie_client.on("close",()=>{this._disconnect_cyblion()}),this.netpie_client.on("disconnect",()=>{this._disconnect_cyblion()}),this.netpie_client.on("message",(e,n)=>{if(e.startsWith("@msg/")){try{n=n.toString()}catch(e){n=null}r.emitter.emit("msg",e,n)}else if(e.startsWith("@shadow/data/updated")){let t;try{t=JSON.parse(n.toString())}catch(e){t={}}r.emitter.emit("shadow_updated",t)}}))}_disconnect_netpie(){this.netpie_client&&this.netpie_client.connected&&this.netpie_client.end()}_connect_cyblion(){let r=this;this.cyblion_client&&this.cyblion_client.connected||(this.cyblion_client=mqtt.connect(r.cyblion_broker_uri,{keepalive:30,clientId:r.deviceid,username:r.devicetoken,password:"",clean:!0,reconnectPeriod:1e3,connectTimeout:3e4,rejectUnauthorized:!1}),this.cyblion_client.on("connect",()=>{r.emitter.emit("connected"),r.cyblion_client.subscribe("@cstore/data/updated/#")}),this.cyblion_client.on("message",(e,n)=>{if(e.startsWith("@cmsg")){try{n=n.toString()}catch(e){n=null}r.emitter.emit("cmsg",e,n)}else if(e.startsWith("@cstore")){e=e.split("/").slice(3).join("/");let t;try{t=n.toString()}catch(e){t=null}r.emitter.emit("cstore",e,t)}}))}_disconnect_cyblion(){this.cyblion_client&&this.cyblion_client.connected&&this.cyblion_client.end()}connect(){this._connect_netpie()}disconnect(){this.netpie_client.end(!0),this.cyblion_client.end(!0)}publish(e,t){let n;e.startsWith("@msg/")||e.startsWith("@shadow/")?(n="object"==typeof t?JSON.stringify(t):String(t),this.netpie_client.publish(e,n)):(e.startsWith("@cmsg/")||e.startsWith("@cstore/"))&&(n="object"==typeof t?JSON.stringify(t):String(t),this.cyblion_client.publish(e,n))}subscribe(e){e.startsWith("@msg/")||e.startsWith("@shadow/")?this.netpie_client.subscribe(e):(e.startsWith("@cmsg/")||e.startsWith("@cstore/"))&&this.cyblion_client.subscribe(e)}writeShadow(t,n){if("string"==typeof t){let e;e="object"==typeof n?JSON.stringify(n):String(n);var r={data:{}},n=(r.data[t]=n,JSON.stringify(r));this.netpie_client.publish("@shadow/data/update",n)}else"object"==typeof t&&(r=JSON.stringify({data:t}),this.netpie_client.publish("@shadow/data/update",r))}writeCStore(e,t){this.cyblion_client.publish("@cstore/data/update/"+e,t)}publishMsg(e,t){this.netpie_client.publish("@msg/"+e,t)}publishPrivateMsg(e,t){this.netpie_client.publish("@private/"+e,t)}}